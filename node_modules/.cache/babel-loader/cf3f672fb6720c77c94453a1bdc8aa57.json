{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { PluginCommands } from '../../mol-plugin/commands';\nimport { State } from '../../mol-state';\nimport { PurePluginUIComponent } from '../base';\nimport { IconButton } from '../controls/common';\nimport { UpdateTransformControl } from '../state/update-transform';\nimport { VisibilityOffOutlinedSvg, VisibilityOutlinedSvg, MoreHorizSvg } from '../controls/icons';\n\nvar GenericEntryListControls =\n/** @class */\nfunction (_super) {\n  __extends(GenericEntryListControls, _super);\n\n  function GenericEntryListControls() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(GenericEntryListControls.prototype, \"current\", {\n    get: function () {\n      return this.plugin.managers.structure.hierarchy.behaviors.selection;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  GenericEntryListControls.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.current, function () {\n      return _this.forceUpdate();\n    });\n  };\n\n  Object.defineProperty(GenericEntryListControls.prototype, \"unitcell\", {\n    get: function () {\n      var _a;\n\n      var selection = this.plugin.managers.structure.hierarchy.selection;\n      if (selection.structures.length === 0) return null;\n      var refs = [];\n\n      for (var _i = 0, _b = selection.structures; _i < _b.length; _i++) {\n        var s = _b[_i];\n        var model = s.model;\n        if ((model === null || model === void 0 ? void 0 : model.unitcell) && ((_a = model.unitcell) === null || _a === void 0 ? void 0 : _a.cell.obj)) refs.push(model.unitcell);\n      }\n\n      if (refs.length === 0) return null;\n      return _jsx(GenericEntry, {\n        refs: refs,\n        labelMultiple: 'Unit Cells'\n      }, void 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(GenericEntryListControls.prototype, \"customControls\", {\n    get: function () {\n      var _this = this;\n\n      var controls = [];\n      this.plugin.genericRepresentationControls.forEach(function (provider, key) {\n        var _a = provider(_this.plugin.managers.structure.hierarchy.selection),\n            refs = _a[0],\n            labelMultiple = _a[1];\n\n        if (refs.length > 0) {\n          controls.push(_jsx(\"div\", {\n            children: _jsx(GenericEntry, {\n              refs: refs,\n              labelMultiple: labelMultiple\n            }, void 0)\n          }, key));\n        }\n      });\n      return controls.length > 0 ? controls : null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  GenericEntryListControls.prototype.render = function () {\n    return _jsx(_Fragment, {\n      children: _jsxs(\"div\", __assign({\n        style: {\n          marginTop: '6px'\n        }\n      }, {\n        children: [this.unitcell, this.customControls]\n      }), void 0)\n    }, void 0);\n  };\n\n  return GenericEntryListControls;\n}(PurePluginUIComponent);\n\nexport { GenericEntryListControls };\n\nvar GenericEntry =\n/** @class */\nfunction (_super) {\n  __extends(GenericEntry, _super);\n\n  function GenericEntry() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      showOptions: false\n    };\n\n    _this.toggleVisibility = function (e) {\n      e.preventDefault();\n\n      _this.plugin.managers.structure.hierarchy.toggleVisibility(_this.props.refs);\n\n      e.currentTarget.blur();\n    };\n\n    _this.highlight = function (e) {\n      e.preventDefault();\n      if (!_this.pivot.cell.parent) return;\n      PluginCommands.Interactivity.Object.Highlight(_this.plugin, {\n        state: _this.pivot.cell.parent,\n        ref: _this.props.refs.map(function (c) {\n          return c.cell.transform.ref;\n        })\n      });\n    };\n\n    _this.clearHighlight = function (e) {\n      e.preventDefault();\n      PluginCommands.Interactivity.ClearHighlights(_this.plugin);\n    };\n\n    _this.focus = function (e) {\n      var _a;\n\n      e.preventDefault();\n      var allHidden = true;\n\n      for (var _i = 0, _b = _this.props.refs; _i < _b.length; _i++) {\n        var uc = _b[_i];\n\n        if (!uc.cell.state.isHidden) {\n          allHidden = false;\n          break;\n        }\n      }\n\n      if (allHidden) {\n        _this.plugin.managers.structure.hierarchy.toggleVisibility(_this.props.refs, 'show');\n      }\n\n      var loci = [];\n\n      for (var _c = 0, _d = _this.props.refs; _c < _d.length; _c++) {\n        var uc = _d[_c];\n\n        if (uc.cell.state.isHidden) {\n          continue;\n        }\n\n        var l = (_a = uc.cell.obj) === null || _a === void 0 ? void 0 : _a.data.repr.getLoci();\n        if (l) loci.push(l);\n      }\n\n      _this.plugin.managers.camera.focusLoci(loci);\n    };\n\n    _this.toggleOptions = function () {\n      return _this.setState({\n        showOptions: !_this.state.showOptions\n      });\n    };\n\n    return _this;\n  }\n\n  GenericEntry.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.state.events.cell.stateUpdated, function (e) {\n      var _a;\n\n      if (State.ObjectEvent.isCell(e, (_a = _this.pivot) === null || _a === void 0 ? void 0 : _a.cell)) _this.forceUpdate();\n    });\n  };\n\n  Object.defineProperty(GenericEntry.prototype, \"pivot\", {\n    get: function () {\n      return this.props.refs[0];\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  GenericEntry.prototype.render = function () {\n    var _a = this.props,\n        refs = _a.refs,\n        labelMultiple = _a.labelMultiple;\n    if (refs.length === 0) return null;\n    var pivot = refs[0];\n    var label, description;\n\n    if (refs.length === 1) {\n      var obj = pivot.cell.obj;\n      if (!obj) return null;\n      label = obj === null || obj === void 0 ? void 0 : obj.label;\n      description = obj === null || obj === void 0 ? void 0 : obj.description;\n    } else {\n      label = refs.length + \" \" + (labelMultiple || 'Objects');\n    }\n\n    return _jsxs(_Fragment, {\n      children: [_jsxs(\"div\", __assign({\n        className: 'msp-flex-row'\n      }, {\n        children: [_jsxs(\"button\", __assign({\n          className: 'msp-form-control msp-control-button-label',\n          title: label + \". Click to focus.\",\n          onClick: this.focus,\n          onMouseEnter: this.highlight,\n          onMouseLeave: this.clearHighlight,\n          style: {\n            textAlign: 'left'\n          }\n        }, {\n          children: [label, \" \", _jsx(\"small\", {\n            children: description\n          }, void 0)]\n        }), void 0), _jsx(IconButton, {\n          svg: pivot.cell.state.isHidden ? VisibilityOffOutlinedSvg : VisibilityOutlinedSvg,\n          toggleState: false,\n          className: 'msp-form-control',\n          onClick: this.toggleVisibility,\n          title: \"\" + (pivot.cell.state.isHidden ? 'Show' : 'Hide'),\n          small: true,\n          flex: true\n        }, void 0), refs.length === 1 && _jsx(IconButton, {\n          svg: MoreHorizSvg,\n          className: 'msp-form-control',\n          onClick: this.toggleOptions,\n          title: 'Options',\n          toggleState: this.state.showOptions,\n          flex: true\n        }, void 0)]\n      }), void 0), refs.length === 1 && this.state.showOptions && pivot.cell.parent && _jsx(_Fragment, {\n        children: _jsx(\"div\", __assign({\n          className: 'msp-control-offset'\n        }, {\n          children: _jsx(UpdateTransformControl, {\n            state: pivot.cell.parent,\n            transform: pivot.cell.transform,\n            customHeader: 'none',\n            autoHideApply: true\n          }, void 0)\n        }), void 0)\n      }, void 0)]\n    }, void 0);\n  };\n\n  return GenericEntry;\n}(PurePluginUIComponent);\n\nexport { GenericEntry };","map":{"version":3,"sources":["../../../src/mol-plugin-ui/structure/generic.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __extends } from \"tslib\";\r\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport { PluginCommands } from '../../mol-plugin/commands';\r\nimport { State } from '../../mol-state';\r\nimport { PurePluginUIComponent } from '../base';\r\nimport { IconButton } from '../controls/common';\r\nimport { UpdateTransformControl } from '../state/update-transform';\r\nimport { VisibilityOffOutlinedSvg, VisibilityOutlinedSvg, MoreHorizSvg } from '../controls/icons';\r\nvar GenericEntryListControls = /** @class */ (function (_super) {\r\n    __extends(GenericEntryListControls, _super);\r\n    function GenericEntryListControls() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Object.defineProperty(GenericEntryListControls.prototype, \"current\", {\r\n        get: function () {\r\n            return this.plugin.managers.structure.hierarchy.behaviors.selection;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GenericEntryListControls.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.current, function () { return _this.forceUpdate(); });\r\n    };\r\n    Object.defineProperty(GenericEntryListControls.prototype, \"unitcell\", {\r\n        get: function () {\r\n            var _a;\r\n            var selection = this.plugin.managers.structure.hierarchy.selection;\r\n            if (selection.structures.length === 0)\r\n                return null;\r\n            var refs = [];\r\n            for (var _i = 0, _b = selection.structures; _i < _b.length; _i++) {\r\n                var s = _b[_i];\r\n                var model = s.model;\r\n                if ((model === null || model === void 0 ? void 0 : model.unitcell) && ((_a = model.unitcell) === null || _a === void 0 ? void 0 : _a.cell.obj))\r\n                    refs.push(model.unitcell);\r\n            }\r\n            if (refs.length === 0)\r\n                return null;\r\n            return _jsx(GenericEntry, { refs: refs, labelMultiple: 'Unit Cells' }, void 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GenericEntryListControls.prototype, \"customControls\", {\r\n        get: function () {\r\n            var _this = this;\r\n            var controls = [];\r\n            this.plugin.genericRepresentationControls.forEach(function (provider, key) {\r\n                var _a = provider(_this.plugin.managers.structure.hierarchy.selection), refs = _a[0], labelMultiple = _a[1];\r\n                if (refs.length > 0) {\r\n                    controls.push(_jsx(\"div\", { children: _jsx(GenericEntry, { refs: refs, labelMultiple: labelMultiple }, void 0) }, key));\r\n                }\r\n            });\r\n            return controls.length > 0 ? controls : null;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GenericEntryListControls.prototype.render = function () {\r\n        return _jsx(_Fragment, { children: _jsxs(\"div\", __assign({ style: { marginTop: '6px' } }, { children: [this.unitcell, this.customControls] }), void 0) }, void 0);\r\n    };\r\n    return GenericEntryListControls;\r\n}(PurePluginUIComponent));\r\nexport { GenericEntryListControls };\r\nvar GenericEntry = /** @class */ (function (_super) {\r\n    __extends(GenericEntry, _super);\r\n    function GenericEntry() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { showOptions: false };\r\n        _this.toggleVisibility = function (e) {\r\n            e.preventDefault();\r\n            _this.plugin.managers.structure.hierarchy.toggleVisibility(_this.props.refs);\r\n            e.currentTarget.blur();\r\n        };\r\n        _this.highlight = function (e) {\r\n            e.preventDefault();\r\n            if (!_this.pivot.cell.parent)\r\n                return;\r\n            PluginCommands.Interactivity.Object.Highlight(_this.plugin, {\r\n                state: _this.pivot.cell.parent,\r\n                ref: _this.props.refs.map(function (c) { return c.cell.transform.ref; })\r\n            });\r\n        };\r\n        _this.clearHighlight = function (e) {\r\n            e.preventDefault();\r\n            PluginCommands.Interactivity.ClearHighlights(_this.plugin);\r\n        };\r\n        _this.focus = function (e) {\r\n            var _a;\r\n            e.preventDefault();\r\n            var allHidden = true;\r\n            for (var _i = 0, _b = _this.props.refs; _i < _b.length; _i++) {\r\n                var uc = _b[_i];\r\n                if (!uc.cell.state.isHidden) {\r\n                    allHidden = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (allHidden) {\r\n                _this.plugin.managers.structure.hierarchy.toggleVisibility(_this.props.refs, 'show');\r\n            }\r\n            var loci = [];\r\n            for (var _c = 0, _d = _this.props.refs; _c < _d.length; _c++) {\r\n                var uc = _d[_c];\r\n                if (uc.cell.state.isHidden) {\r\n                    continue;\r\n                }\r\n                var l = (_a = uc.cell.obj) === null || _a === void 0 ? void 0 : _a.data.repr.getLoci();\r\n                if (l)\r\n                    loci.push(l);\r\n            }\r\n            _this.plugin.managers.camera.focusLoci(loci);\r\n        };\r\n        _this.toggleOptions = function () { return _this.setState({ showOptions: !_this.state.showOptions }); };\r\n        return _this;\r\n    }\r\n    GenericEntry.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.state.events.cell.stateUpdated, function (e) {\r\n            var _a;\r\n            if (State.ObjectEvent.isCell(e, (_a = _this.pivot) === null || _a === void 0 ? void 0 : _a.cell))\r\n                _this.forceUpdate();\r\n        });\r\n    };\r\n    Object.defineProperty(GenericEntry.prototype, \"pivot\", {\r\n        get: function () { return this.props.refs[0]; },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    GenericEntry.prototype.render = function () {\r\n        var _a = this.props, refs = _a.refs, labelMultiple = _a.labelMultiple;\r\n        if (refs.length === 0)\r\n            return null;\r\n        var pivot = refs[0];\r\n        var label, description;\r\n        if (refs.length === 1) {\r\n            var obj = pivot.cell.obj;\r\n            if (!obj)\r\n                return null;\r\n            label = obj === null || obj === void 0 ? void 0 : obj.label;\r\n            description = obj === null || obj === void 0 ? void 0 : obj.description;\r\n        }\r\n        else {\r\n            label = refs.length + \" \" + (labelMultiple || 'Objects');\r\n        }\r\n        return _jsxs(_Fragment, { children: [_jsxs(\"div\", __assign({ className: 'msp-flex-row' }, { children: [_jsxs(\"button\", __assign({ className: 'msp-form-control msp-control-button-label', title: label + \". Click to focus.\", onClick: this.focus, onMouseEnter: this.highlight, onMouseLeave: this.clearHighlight, style: { textAlign: 'left' } }, { children: [label, \" \", _jsx(\"small\", { children: description }, void 0)] }), void 0), _jsx(IconButton, { svg: pivot.cell.state.isHidden ? VisibilityOffOutlinedSvg : VisibilityOutlinedSvg, toggleState: false, className: 'msp-form-control', onClick: this.toggleVisibility, title: \"\" + (pivot.cell.state.isHidden ? 'Show' : 'Hide'), small: true, flex: true }, void 0), refs.length === 1 && _jsx(IconButton, { svg: MoreHorizSvg, className: 'msp-form-control', onClick: this.toggleOptions, title: 'Options', toggleState: this.state.showOptions, flex: true }, void 0)] }), void 0), (refs.length === 1 && this.state.showOptions && pivot.cell.parent) && _jsx(_Fragment, { children: _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: _jsx(UpdateTransformControl, { state: pivot.cell.parent, transform: pivot.cell.transform, customHeader: 'none', autoHideApply: true }, void 0) }), void 0) }, void 0)] }, void 0);\r\n    };\r\n    return GenericEntry;\r\n}(PurePluginUIComponent));\r\nexport { GenericEntry };\r\n//# sourceMappingURL=generic.js.map"]},"metadata":{},"sourceType":"module"}