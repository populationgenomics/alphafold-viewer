{"ast":null,"code":"import { __assign, __awaiter, __extends, __generator } from \"tslib\";\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\n/**\r\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\n\nimport { produce } from 'immer';\nimport { Canvas3DParams } from '../../mol-canvas3d/canvas3d';\nimport { PluginCommands } from '../../mol-plugin/commands';\nimport { StateTransform } from '../../mol-state';\nimport { Color } from '../../mol-util/color';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { ParamMapping } from '../../mol-util/param-mapping';\nimport { PluginUIComponent } from '../base';\nimport { ParameterMappingControl } from '../controls/parameters';\nimport { ViewportHelpContent } from './help';\n\nvar SimpleSettingsControl =\n/** @class */\nfunction (_super) {\n  __extends(SimpleSettingsControl, _super);\n\n  function SimpleSettingsControl() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SimpleSettingsControl.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.events.canvas3d.settingsUpdated, function () {\n      return _this.forceUpdate();\n    });\n    this.subscribe(this.plugin.canvas3d.camera.stateChanged, function (state) {\n      if (state.radiusMax !== undefined || state.radius !== undefined) {\n        _this.forceUpdate();\n      }\n    });\n  };\n\n  SimpleSettingsControl.prototype.render = function () {\n    if (!this.plugin.canvas3d) return null;\n    return _jsxs(_Fragment, {\n      children: [_jsx(ParameterMappingControl, {\n        mapping: SimpleSettingsMapping\n      }, void 0), _jsx(ViewportHelpContent, {}, void 0)]\n    }, void 0);\n  };\n\n  return SimpleSettingsControl;\n}(PluginUIComponent);\n\nexport { SimpleSettingsControl };\nvar LayoutOptions = {\n  'sequence': 'Sequence',\n  'log': 'Log',\n  'left': 'Left Panel'\n};\nvar SimpleSettingsParams = {\n  spin: PD.Group({\n    spin: Canvas3DParams.trackball.params.spin,\n    speed: Canvas3DParams.trackball.params.spinSpeed\n  }, {\n    pivot: 'spin'\n  }),\n  camera: Canvas3DParams.camera,\n  background: PD.Group({\n    color: PD.Color(Color(0xFCFBF9), {\n      label: 'Background',\n      description: 'Custom background color'\n    }),\n    transparent: PD.Boolean(false)\n  }, {\n    pivot: 'color'\n  }),\n  lighting: PD.Group({\n    renderStyle: Canvas3DParams.renderer.params.style,\n    occlusion: Canvas3DParams.postprocessing.params.occlusion,\n    outline: Canvas3DParams.postprocessing.params.outline,\n    fog: Canvas3DParams.cameraFog\n  }, {\n    pivot: 'renderStyle'\n  }),\n  clipping: PD.Group(__assign(__assign({}, Canvas3DParams.cameraClipping.params), Canvas3DParams.renderer.params.clip.params), {\n    pivot: 'radius'\n  }),\n  layout: PD.MultiSelect([], PD.objectToOptions(LayoutOptions))\n};\nvar SimpleSettingsMapping = ParamMapping({\n  params: function (ctx) {\n    var _a;\n\n    var params = PD.clone(SimpleSettingsParams);\n    var controls = (_a = ctx.spec.components) === null || _a === void 0 ? void 0 : _a.controls;\n\n    if (controls) {\n      var options = [];\n      if (controls.top !== 'none') options.push(['sequence', LayoutOptions.sequence]);\n      if (controls.bottom !== 'none') options.push(['log', LayoutOptions.log]);\n      if (controls.left !== 'none') options.push(['left', LayoutOptions.left]);\n      params.layout.options = options;\n    }\n\n    return params;\n  },\n  target: function (ctx) {\n    var _a, _b;\n\n    var c = (_a = ctx.spec.components) === null || _a === void 0 ? void 0 : _a.controls;\n    var r = ctx.layout.state.regionState;\n    var layout = [];\n    if (r.top !== 'hidden' && (!c || c.top !== 'none')) layout.push('sequence');\n    if (r.bottom !== 'hidden' && (!c || c.bottom !== 'none')) layout.push('log');\n    if (r.left !== 'hidden' && (!c || c.left !== 'none')) layout.push('left');\n    return {\n      canvas: (_b = ctx.canvas3d) === null || _b === void 0 ? void 0 : _b.props,\n      layout: layout\n    };\n  }\n})({\n  values: function (props, ctx) {\n    var canvas = props.canvas;\n    var renderer = canvas.renderer;\n    return {\n      layout: props.layout,\n      spin: {\n        spin: !!canvas.trackball.spin,\n        speed: canvas.trackball.spinSpeed\n      },\n      camera: canvas.camera,\n      background: {\n        color: renderer.backgroundColor,\n        transparent: canvas.transparentBackground\n      },\n      lighting: {\n        renderStyle: renderer.style,\n        occlusion: canvas.postprocessing.occlusion,\n        outline: canvas.postprocessing.outline,\n        fog: canvas.cameraFog\n      },\n      clipping: __assign(__assign({}, canvas.cameraClipping), canvas.renderer.clip)\n    };\n  },\n  update: function (s, props) {\n    var canvas = props.canvas;\n    canvas.trackball.spin = s.spin.spin;\n    canvas.trackball.spinSpeed = s.spin.speed;\n    canvas.camera = s.camera;\n    canvas.transparentBackground = s.background.transparent;\n    canvas.renderer.backgroundColor = s.background.color;\n    canvas.renderer.style = s.lighting.renderStyle;\n    canvas.postprocessing.occlusion = s.lighting.occlusion;\n    canvas.postprocessing.outline = s.lighting.outline;\n    canvas.cameraFog = s.lighting.fog;\n    canvas.cameraClipping = {\n      radius: s.clipping.radius,\n      far: s.clipping.far\n    };\n    canvas.renderer.clip = {\n      variant: s.clipping.variant,\n      objects: s.clipping.objects\n    };\n    props.layout = s.layout;\n  },\n  apply: function (props, ctx) {\n    return __awaiter(this, void 0, void 0, function () {\n      var hideLeft, state;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , PluginCommands.Canvas3D.SetSettings(ctx, {\n              settings: props.canvas\n            })];\n\n          case 1:\n            _a.sent();\n\n            hideLeft = props.layout.indexOf('left') < 0;\n            state = produce(ctx.layout.state, function (s) {\n              s.regionState.top = props.layout.indexOf('sequence') >= 0 ? 'full' : 'hidden';\n              s.regionState.bottom = props.layout.indexOf('log') >= 0 ? 'full' : 'hidden';\n              s.regionState.left = hideLeft ? 'hidden' : ctx.behaviors.layout.leftPanelTabName.value === 'none' ? 'collapsed' : 'full';\n            });\n            return [4\n            /*yield*/\n            , PluginCommands.Layout.Update(ctx, {\n              state: state\n            })];\n\n          case 2:\n            _a.sent();\n\n            if (hideLeft) {\n              PluginCommands.State.SetCurrentObject(ctx, {\n                state: ctx.state.data,\n                ref: StateTransform.RootRef\n              });\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  }\n});","map":{"version":3,"sources":["../../../src/mol-plugin-ui/viewport/simple-settings.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __awaiter, __extends, __generator } from \"tslib\";\r\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\r\n/**\r\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\r\nimport { produce } from 'immer';\r\nimport { Canvas3DParams } from '../../mol-canvas3d/canvas3d';\r\nimport { PluginCommands } from '../../mol-plugin/commands';\r\nimport { StateTransform } from '../../mol-state';\r\nimport { Color } from '../../mol-util/color';\r\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\r\nimport { ParamMapping } from '../../mol-util/param-mapping';\r\nimport { PluginUIComponent } from '../base';\r\nimport { ParameterMappingControl } from '../controls/parameters';\r\nimport { ViewportHelpContent } from './help';\r\nvar SimpleSettingsControl = /** @class */ (function (_super) {\r\n    __extends(SimpleSettingsControl, _super);\r\n    function SimpleSettingsControl() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SimpleSettingsControl.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.events.canvas3d.settingsUpdated, function () { return _this.forceUpdate(); });\r\n        this.subscribe(this.plugin.canvas3d.camera.stateChanged, function (state) {\r\n            if (state.radiusMax !== undefined || state.radius !== undefined) {\r\n                _this.forceUpdate();\r\n            }\r\n        });\r\n    };\r\n    SimpleSettingsControl.prototype.render = function () {\r\n        if (!this.plugin.canvas3d)\r\n            return null;\r\n        return _jsxs(_Fragment, { children: [_jsx(ParameterMappingControl, { mapping: SimpleSettingsMapping }, void 0), _jsx(ViewportHelpContent, {}, void 0)] }, void 0);\r\n    };\r\n    return SimpleSettingsControl;\r\n}(PluginUIComponent));\r\nexport { SimpleSettingsControl };\r\nvar LayoutOptions = {\r\n    'sequence': 'Sequence',\r\n    'log': 'Log',\r\n    'left': 'Left Panel'\r\n};\r\nvar SimpleSettingsParams = {\r\n    spin: PD.Group({\r\n        spin: Canvas3DParams.trackball.params.spin,\r\n        speed: Canvas3DParams.trackball.params.spinSpeed\r\n    }, { pivot: 'spin' }),\r\n    camera: Canvas3DParams.camera,\r\n    background: PD.Group({\r\n        color: PD.Color(Color(0xFCFBF9), { label: 'Background', description: 'Custom background color' }),\r\n        transparent: PD.Boolean(false)\r\n    }, { pivot: 'color' }),\r\n    lighting: PD.Group({\r\n        renderStyle: Canvas3DParams.renderer.params.style,\r\n        occlusion: Canvas3DParams.postprocessing.params.occlusion,\r\n        outline: Canvas3DParams.postprocessing.params.outline,\r\n        fog: Canvas3DParams.cameraFog,\r\n    }, { pivot: 'renderStyle' }),\r\n    clipping: PD.Group(__assign(__assign({}, Canvas3DParams.cameraClipping.params), Canvas3DParams.renderer.params.clip.params), { pivot: 'radius' }),\r\n    layout: PD.MultiSelect([], PD.objectToOptions(LayoutOptions)),\r\n};\r\nvar SimpleSettingsMapping = ParamMapping({\r\n    params: function (ctx) {\r\n        var _a;\r\n        var params = PD.clone(SimpleSettingsParams);\r\n        var controls = (_a = ctx.spec.components) === null || _a === void 0 ? void 0 : _a.controls;\r\n        if (controls) {\r\n            var options = [];\r\n            if (controls.top !== 'none')\r\n                options.push(['sequence', LayoutOptions.sequence]);\r\n            if (controls.bottom !== 'none')\r\n                options.push(['log', LayoutOptions.log]);\r\n            if (controls.left !== 'none')\r\n                options.push(['left', LayoutOptions.left]);\r\n            params.layout.options = options;\r\n        }\r\n        return params;\r\n    },\r\n    target: function (ctx) {\r\n        var _a, _b;\r\n        var c = (_a = ctx.spec.components) === null || _a === void 0 ? void 0 : _a.controls;\r\n        var r = ctx.layout.state.regionState;\r\n        var layout = [];\r\n        if (r.top !== 'hidden' && (!c || c.top !== 'none'))\r\n            layout.push('sequence');\r\n        if (r.bottom !== 'hidden' && (!c || c.bottom !== 'none'))\r\n            layout.push('log');\r\n        if (r.left !== 'hidden' && (!c || c.left !== 'none'))\r\n            layout.push('left');\r\n        return { canvas: (_b = ctx.canvas3d) === null || _b === void 0 ? void 0 : _b.props, layout: layout };\r\n    }\r\n})({\r\n    values: function (props, ctx) {\r\n        var canvas = props.canvas;\r\n        var renderer = canvas.renderer;\r\n        return {\r\n            layout: props.layout,\r\n            spin: { spin: !!canvas.trackball.spin, speed: canvas.trackball.spinSpeed },\r\n            camera: canvas.camera,\r\n            background: {\r\n                color: renderer.backgroundColor,\r\n                transparent: canvas.transparentBackground\r\n            },\r\n            lighting: {\r\n                renderStyle: renderer.style,\r\n                occlusion: canvas.postprocessing.occlusion,\r\n                outline: canvas.postprocessing.outline,\r\n                fog: canvas.cameraFog\r\n            },\r\n            clipping: __assign(__assign({}, canvas.cameraClipping), canvas.renderer.clip)\r\n        };\r\n    },\r\n    update: function (s, props) {\r\n        var canvas = props.canvas;\r\n        canvas.trackball.spin = s.spin.spin;\r\n        canvas.trackball.spinSpeed = s.spin.speed;\r\n        canvas.camera = s.camera;\r\n        canvas.transparentBackground = s.background.transparent;\r\n        canvas.renderer.backgroundColor = s.background.color;\r\n        canvas.renderer.style = s.lighting.renderStyle;\r\n        canvas.postprocessing.occlusion = s.lighting.occlusion;\r\n        canvas.postprocessing.outline = s.lighting.outline;\r\n        canvas.cameraFog = s.lighting.fog;\r\n        canvas.cameraClipping = {\r\n            radius: s.clipping.radius,\r\n            far: s.clipping.far,\r\n        };\r\n        canvas.renderer.clip = {\r\n            variant: s.clipping.variant,\r\n            objects: s.clipping.objects,\r\n        };\r\n        props.layout = s.layout;\r\n    },\r\n    apply: function (props, ctx) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var hideLeft, state;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, PluginCommands.Canvas3D.SetSettings(ctx, { settings: props.canvas })];\r\n                    case 1:\r\n                        _a.sent();\r\n                        hideLeft = props.layout.indexOf('left') < 0;\r\n                        state = produce(ctx.layout.state, function (s) {\r\n                            s.regionState.top = props.layout.indexOf('sequence') >= 0 ? 'full' : 'hidden';\r\n                            s.regionState.bottom = props.layout.indexOf('log') >= 0 ? 'full' : 'hidden';\r\n                            s.regionState.left = hideLeft ? 'hidden' : ctx.behaviors.layout.leftPanelTabName.value === 'none' ? 'collapsed' : 'full';\r\n                        });\r\n                        return [4 /*yield*/, PluginCommands.Layout.Update(ctx, { state: state })];\r\n                    case 2:\r\n                        _a.sent();\r\n                        if (hideLeft) {\r\n                            PluginCommands.State.SetCurrentObject(ctx, { state: ctx.state.data, ref: StateTransform.RootRef });\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    }\r\n});\r\n//# sourceMappingURL=simple-settings.js.map"]},"metadata":{},"sourceType":"module"}