{"ast":null,"code":"/**\r\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\nimport { BuiltInTrajectoryFormats } from './trajectory';\nimport { BuiltInVolumeFormats } from './volume';\nimport { BuiltInShapeFormats } from './shape';\nimport { BuiltInStructureFormats } from './structure';\n\nvar DataFormatRegistry =\n/** @class */\nfunction () {\n  function DataFormatRegistry() {\n    this._list = [];\n    this._map = new Map();\n    this._extensions = undefined;\n    this._binaryExtensions = undefined;\n    this._options = undefined;\n\n    for (var _i = 0, BuiltInVolumeFormats_1 = BuiltInVolumeFormats; _i < BuiltInVolumeFormats_1.length; _i++) {\n      var _a = BuiltInVolumeFormats_1[_i],\n          id = _a[0],\n          p = _a[1];\n      this.add(id, p);\n    }\n\n    for (var _b = 0, BuiltInStructureFormats_1 = BuiltInStructureFormats; _b < BuiltInStructureFormats_1.length; _b++) {\n      var _c = BuiltInStructureFormats_1[_b],\n          id = _c[0],\n          p = _c[1];\n      this.add(id, p);\n    }\n\n    for (var _d = 0, BuiltInShapeFormats_1 = BuiltInShapeFormats; _d < BuiltInShapeFormats_1.length; _d++) {\n      var _e = BuiltInShapeFormats_1[_d],\n          id = _e[0],\n          p = _e[1];\n      this.add(id, p);\n    }\n\n    for (var _f = 0, BuiltInTrajectoryFormats_1 = BuiltInTrajectoryFormats; _f < BuiltInTrajectoryFormats_1.length; _f++) {\n      var _g = BuiltInTrajectoryFormats_1[_f],\n          id = _g[0],\n          p = _g[1];\n      this.add(id, p);\n    }\n  }\n\n  Object.defineProperty(DataFormatRegistry.prototype, \"types\", {\n    get: function () {\n      return this._list.map(function (e) {\n        return [e.name, e.provider.label];\n      });\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataFormatRegistry.prototype, \"extensions\", {\n    get: function () {\n      if (this._extensions) return this._extensions;\n      var extensions = new Set();\n\n      this._list.forEach(function (_a) {\n        var _b, _c;\n\n        var provider = _a.provider;\n        (_b = provider.stringExtensions) === null || _b === void 0 ? void 0 : _b.forEach(function (ext) {\n          return extensions.add(ext);\n        });\n        (_c = provider.binaryExtensions) === null || _c === void 0 ? void 0 : _c.forEach(function (ext) {\n          return extensions.add(ext);\n        });\n      });\n\n      this._extensions = extensions;\n      return extensions;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataFormatRegistry.prototype, \"binaryExtensions\", {\n    get: function () {\n      if (this._binaryExtensions) return this._binaryExtensions;\n      var binaryExtensions = new Set();\n\n      this._list.forEach(function (_a) {\n        var _b;\n\n        var provider = _a.provider;\n        return (_b = provider.binaryExtensions) === null || _b === void 0 ? void 0 : _b.forEach(function (ext) {\n          return binaryExtensions.add(ext);\n        });\n      });\n\n      this._binaryExtensions = binaryExtensions;\n      return binaryExtensions;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(DataFormatRegistry.prototype, \"options\", {\n    get: function () {\n      if (this._options) return this._options;\n      var options = [];\n\n      this._list.forEach(function (_a) {\n        var name = _a.name,\n            provider = _a.provider;\n        return options.push([name, provider.label, provider.category || '']);\n      });\n\n      this._options = options;\n      return options;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  ;\n\n  DataFormatRegistry.prototype._clear = function () {\n    this._extensions = undefined;\n    this._binaryExtensions = undefined;\n    this._options = undefined;\n  };\n\n  DataFormatRegistry.prototype.add = function (name, provider) {\n    this._clear();\n\n    this._list.push({\n      name: name,\n      provider: provider\n    });\n\n    this._map.set(name, provider);\n  };\n\n  DataFormatRegistry.prototype.remove = function (name) {\n    this._clear();\n\n    this._list.splice(this._list.findIndex(function (e) {\n      return e.name === name;\n    }), 1);\n\n    this._map.delete(name);\n  };\n\n  DataFormatRegistry.prototype.auto = function (info, dataStateObject) {\n    for (var i = 0, il = this.list.length; i < il; ++i) {\n      var provider = this._list[i].provider;\n      var hasExt = false;\n      if (provider.binaryExtensions && provider.binaryExtensions.indexOf(info.ext) >= 0) hasExt = true;else if (provider.stringExtensions && provider.stringExtensions.indexOf(info.ext) >= 0) hasExt = true;\n      if (hasExt && (!provider.isApplicable || provider.isApplicable(info, dataStateObject.data))) return provider;\n    }\n\n    return;\n  };\n\n  DataFormatRegistry.prototype.get = function (name) {\n    if (this._map.has(name)) {\n      return this._map.get(name);\n    } else {\n      throw new Error(\"unknown data format name '\" + name + \"'\");\n    }\n  };\n\n  Object.defineProperty(DataFormatRegistry.prototype, \"list\", {\n    get: function () {\n      return this._list;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return DataFormatRegistry;\n}();\n\nexport { DataFormatRegistry };","map":{"version":3,"sources":["../../../src/mol-plugin-state/formats/registry.ts"],"names":[],"mappings":"AAAA;;;;;AAKG;AAKH,SAAS,wBAAT,QAAyC,cAAzC;AACA,SAAS,oBAAT,QAAqC,UAArC;AACA,SAAS,mBAAT,QAAoC,SAApC;AACA,SAAS,uBAAT,QAAwC,aAAxC;;AAEA,IAAA,kBAAA;AAAA;AAAA,YAAA;AAsCI,WAAA,kBAAA,GAAA;AArCQ,SAAA,KAAA,GAA0D,EAA1D;AACA,SAAA,IAAA,GAAO,IAAI,GAAJ,EAAP;AACA,SAAA,WAAA,GAAuC,SAAvC;AACA,SAAA,iBAAA,GAA6C,SAA7C;AACA,SAAA,QAAA,GAAmD,SAAnD;;AAkCJ,SAAsB,IAAA,EAAA,GAAA,CAAA,EAAA,sBAAA,GAAA,oBAAtB,EAAsB,EAAA,GAAA,sBAAA,CAAA,MAAtB,EAAsB,EAAA,EAAtB,EAA0C;AAA/B,UAAA,EAAA,GAAA,sBAAA,CAAA,EAAA,CAAA;AAAA,UAAC,EAAE,GAAA,EAAA,CAAA,CAAA,CAAH;AAAA,UAAK,CAAC,GAAA,EAAA,CAAA,CAAA,CAAN;AAAiC,WAAK,GAAL,CAAS,EAAT,EAAa,CAAb;AAAgB;;AAC5D,SAAsB,IAAA,EAAA,GAAA,CAAA,EAAA,yBAAA,GAAA,uBAAtB,EAAsB,EAAA,GAAA,yBAAA,CAAA,MAAtB,EAAsB,EAAA,EAAtB,EAA6C;AAAlC,UAAA,EAAA,GAAA,yBAAA,CAAA,EAAA,CAAA;AAAA,UAAC,EAAE,GAAA,EAAA,CAAA,CAAA,CAAH;AAAA,UAAK,CAAC,GAAA,EAAA,CAAA,CAAA,CAAN;AAAoC,WAAK,GAAL,CAAS,EAAT,EAAa,CAAb;AAAgB;;AAC/D,SAAsB,IAAA,EAAA,GAAA,CAAA,EAAA,qBAAA,GAAA,mBAAtB,EAAsB,EAAA,GAAA,qBAAA,CAAA,MAAtB,EAAsB,EAAA,EAAtB,EAAyC;AAA9B,UAAA,EAAA,GAAA,qBAAA,CAAA,EAAA,CAAA;AAAA,UAAC,EAAE,GAAA,EAAA,CAAA,CAAA,CAAH;AAAA,UAAK,CAAC,GAAA,EAAA,CAAA,CAAA,CAAN;AAAgC,WAAK,GAAL,CAAS,EAAT,EAAa,CAAb;AAAgB;;AAC3D,SAAsB,IAAA,EAAA,GAAA,CAAA,EAAA,0BAAA,GAAA,wBAAtB,EAAsB,EAAA,GAAA,0BAAA,CAAA,MAAtB,EAAsB,EAAA,EAAtB,EAA8C;AAAnC,UAAA,EAAA,GAAA,0BAAA,CAAA,EAAA,CAAA;AAAA,UAAC,EAAE,GAAA,EAAA,CAAA,CAAA,CAAH;AAAA,UAAK,CAAC,GAAA,EAAA,CAAA,CAAA,CAAN;AAAqC,WAAK,GAAL,CAAS,EAAT,EAAa,CAAb;AAAgB;AACnE;;AApCD,EAAA,MAAA,CAAA,cAAA,CAAI,kBAAA,CAAA,SAAJ,EAAI,OAAJ,EAAS;SAAT,YAAA;AACI,aAAO,KAAK,KAAL,CAAW,GAAX,CAAe,UAAA,CAAA,EAAC;AAAI,eAAA,CAAC,CAAC,CAAC,IAAH,EAAS,CAAC,CAAC,QAAF,CAAT,KAAA,CAAA;AAA8C,OAAlE,CAAP;AACH,KAFQ;qBAAA;;AAAA,GAAT;AAIA,EAAA,MAAA,CAAA,cAAA,CAAI,kBAAA,CAAA,SAAJ,EAAI,YAAJ,EAAc;SAAd,YAAA;AACI,UAAI,KAAK,WAAT,EAAsB,OAAO,KAAK,WAAZ;AACtB,UAAM,UAAU,GAAG,IAAI,GAAJ,EAAnB;;AACA,WAAK,KAAL,CAAW,OAAX,CAAmB,UAAC,EAAD,EAAa;;;YAAV,QAAQ,GAAA,EAAA,CAAA,Q;AAC1B,SAAA,EAAA,GAAA,QAAQ,CAAC,gBAAT,MAAyB,IAAzB,IAAyB,EAAA,KAAA,KAAA,CAAzB,GAAyB,KAAA,CAAzB,GAAyB,EAAA,CAAE,OAAF,CAAU,UAAA,GAAA,EAAG;AAAI,iBAAA,UAAU,CAAC,GAAX,CAAA,GAAA,CAAA;AAAmB,SAApC,CAAzB;AACA,SAAA,EAAA,GAAA,QAAQ,CAAC,gBAAT,MAAyB,IAAzB,IAAyB,EAAA,KAAA,KAAA,CAAzB,GAAyB,KAAA,CAAzB,GAAyB,EAAA,CAAE,OAAF,CAAU,UAAA,GAAA,EAAG;AAAI,iBAAA,UAAU,CAAC,GAAX,CAAA,GAAA,CAAA;AAAmB,SAApC,CAAzB;AACH,OAHD;;AAIA,WAAK,WAAL,GAAmB,UAAnB;AACA,aAAO,UAAP;AACH,KATa;qBAAA;;AAAA,GAAd;AAWA,EAAA,MAAA,CAAA,cAAA,CAAI,kBAAA,CAAA,SAAJ,EAAI,kBAAJ,EAAoB;SAApB,YAAA;AACI,UAAI,KAAK,iBAAT,EAA4B,OAAO,KAAK,iBAAZ;AAC5B,UAAM,gBAAgB,GAAG,IAAI,GAAJ,EAAzB;;AACA,WAAK,KAAL,CAAW,OAAX,CAAmB,UAAC,EAAD,EAAa;;;YAAV,QAAQ,GAAA,EAAA,CAAA,Q;AAAO,eAAA,CAAA,EAAA,GAAA,QAAQ,CAAC,gBAAT,MAAyB,IAAzB,IAAyB,EAAA,KAAA,KAAA,CAAzB,GAAyB,KAAA,CAAzB,GAAyB,EAAA,CAAE,OAAF,CAAU,UAAA,GAAA,EAAG;AAAI,iBAAA,gBAAgB,CAAC,GAAjB,CAAA,GAAA,CAAA;AAAyB,SAA1C,CAAzB;AAAoE,OAAzG;;AACA,WAAK,iBAAL,GAAyB,gBAAzB;AACA,aAAO,gBAAP;AACH,KANmB;qBAAA;;AAAA,GAApB;AAQA,EAAA,MAAA,CAAA,cAAA,CAAI,kBAAA,CAAA,SAAJ,EAAI,SAAJ,EAAW;SAAX,YAAA;AACI,UAAI,KAAK,QAAT,EAAmB,OAAO,KAAK,QAAZ;AACnB,UAAM,OAAO,GAA+B,EAA5C;;AACA,WAAK,KAAL,CAAW,OAAX,CAAmB,UAAC,EAAD,EAAmB;YAAhB,IAAI,GAAA,EAAA,CAAA,I;YAAE,QAAQ,GAAA,EAAA,CAAA,Q;AAAO,eAAA,OAAO,CAAC,IAAR,CAAa,CAAC,IAAD,EAAO,QAAQ,CAAC,KAAhB,EAAuB,QAAQ,CAAC,QAAT,IAAqB,EAA5C,CAAb,CAAA;AAA6D,OAAxG;;AACA,WAAK,QAAL,GAAgB,OAAhB;AACA,aAAO,OAAP;AACH,KANU;qBAAA;;AAAA,GAAX;AAaC;;AAEO,EAAA,kBAAA,CAAA,SAAA,CAAA,MAAA,GAAR,YAAA;AACI,SAAK,WAAL,GAAmB,SAAnB;AACA,SAAK,iBAAL,GAAyB,SAAzB;AACA,SAAK,QAAL,GAAgB,SAAhB;AACH,GAJO;;AAMR,EAAA,kBAAA,CAAA,SAAA,CAAA,GAAA,GAAA,UAAI,IAAJ,EAAkB,QAAlB,EAA8C;AAC1C,SAAK,MAAL;;AACA,SAAK,KAAL,CAAW,IAAX,CAAgB;AAAE,MAAA,IAAI,EAAA,IAAN;AAAQ,MAAA,QAAQ,EAAA;AAAhB,KAAhB;;AACA,SAAK,IAAL,CAAU,GAAV,CAAc,IAAd,EAAoB,QAApB;AACH,GAJD;;AAMA,EAAA,kBAAA,CAAA,SAAA,CAAA,MAAA,GAAA,UAAO,IAAP,EAAmB;AACf,SAAK,MAAL;;AACA,SAAK,KAAL,CAAW,MAAX,CAAkB,KAAK,KAAL,CAAW,SAAX,CAAqB,UAAA,CAAA,EAAC;AAAI,aAAA,CAAC,CAAC,IAAF,KAAA,IAAA;AAAe,KAAzC,CAAlB,EAA8D,CAA9D;;AACA,SAAK,IAAL,CAAU,MAAV,CAAiB,IAAjB;AACH,GAJD;;AAMA,EAAA,kBAAA,CAAA,SAAA,CAAA,IAAA,GAAA,UAAK,IAAL,EAAqB,eAArB,EAAmG;AAC/F,SAAK,IAAI,CAAC,GAAG,CAAR,EAAW,EAAE,GAAG,KAAK,IAAL,CAAU,MAA/B,EAAuC,CAAC,GAAG,EAA3C,EAA+C,EAAE,CAAjD,EAAoD;AACxC,UAAA,QAAQ,GAAK,KAAK,KAAL,CAAW,CAAX,EAAL,QAAR;AAER,UAAI,MAAM,GAAG,KAAb;AACA,UAAI,QAAQ,CAAC,gBAAT,IAA6B,QAAQ,CAAC,gBAAT,CAA0B,OAA1B,CAAkC,IAAI,CAAC,GAAvC,KAA+C,CAAhF,EAAmF,MAAM,GAAG,IAAT,CAAnF,KACK,IAAI,QAAQ,CAAC,gBAAT,IAA6B,QAAQ,CAAC,gBAAT,CAA0B,OAA1B,CAAkC,IAAI,CAAC,GAAvC,KAA+C,CAAhF,EAAmF,MAAM,GAAG,IAAT;AACxF,UAAI,MAAM,KAAK,CAAC,QAAQ,CAAC,YAAV,IAA0B,QAAQ,CAAC,YAAT,CAAsB,IAAtB,EAA4B,eAAe,CAAC,IAA5C,CAA/B,CAAV,EAA6F,OAAO,QAAP;AAChG;;AACD;AACH,GAVD;;AAYA,EAAA,kBAAA,CAAA,SAAA,CAAA,GAAA,GAAA,UAAI,IAAJ,EAAgB;AACZ,QAAI,KAAK,IAAL,CAAU,GAAV,CAAc,IAAd,CAAJ,EAAyB;AACrB,aAAO,KAAK,IAAL,CAAU,GAAV,CAAc,IAAd,CAAP;AACH,KAFD,MAEO;AACH,YAAM,IAAI,KAAJ,CAAU,+BAA6B,IAA7B,GAAiC,GAA3C,CAAN;AACH;AACJ,GAND;;AAQA,EAAA,MAAA,CAAA,cAAA,CAAI,kBAAA,CAAA,SAAJ,EAAI,MAAJ,EAAQ;SAAR,YAAA;AACI,aAAO,KAAK,KAAZ;AACH,KAFO;qBAAA;;AAAA,GAAR;AAGJ,SAAA,kBAAA;AAAC,CAtFD,EAAA","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\r\nimport { BuiltInTrajectoryFormats } from './trajectory';\r\nimport { BuiltInVolumeFormats } from './volume';\r\nimport { BuiltInShapeFormats } from './shape';\r\nimport { BuiltInStructureFormats } from './structure';\r\nvar DataFormatRegistry = /** @class */ (function () {\r\n    function DataFormatRegistry() {\r\n        this._list = [];\r\n        this._map = new Map();\r\n        this._extensions = undefined;\r\n        this._binaryExtensions = undefined;\r\n        this._options = undefined;\r\n        for (var _i = 0, BuiltInVolumeFormats_1 = BuiltInVolumeFormats; _i < BuiltInVolumeFormats_1.length; _i++) {\r\n            var _a = BuiltInVolumeFormats_1[_i], id = _a[0], p = _a[1];\r\n            this.add(id, p);\r\n        }\r\n        for (var _b = 0, BuiltInStructureFormats_1 = BuiltInStructureFormats; _b < BuiltInStructureFormats_1.length; _b++) {\r\n            var _c = BuiltInStructureFormats_1[_b], id = _c[0], p = _c[1];\r\n            this.add(id, p);\r\n        }\r\n        for (var _d = 0, BuiltInShapeFormats_1 = BuiltInShapeFormats; _d < BuiltInShapeFormats_1.length; _d++) {\r\n            var _e = BuiltInShapeFormats_1[_d], id = _e[0], p = _e[1];\r\n            this.add(id, p);\r\n        }\r\n        for (var _f = 0, BuiltInTrajectoryFormats_1 = BuiltInTrajectoryFormats; _f < BuiltInTrajectoryFormats_1.length; _f++) {\r\n            var _g = BuiltInTrajectoryFormats_1[_f], id = _g[0], p = _g[1];\r\n            this.add(id, p);\r\n        }\r\n    }\r\n    Object.defineProperty(DataFormatRegistry.prototype, \"types\", {\r\n        get: function () {\r\n            return this._list.map(function (e) { return [e.name, e.provider.label]; });\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DataFormatRegistry.prototype, \"extensions\", {\r\n        get: function () {\r\n            if (this._extensions)\r\n                return this._extensions;\r\n            var extensions = new Set();\r\n            this._list.forEach(function (_a) {\r\n                var _b, _c;\r\n                var provider = _a.provider;\r\n                (_b = provider.stringExtensions) === null || _b === void 0 ? void 0 : _b.forEach(function (ext) { return extensions.add(ext); });\r\n                (_c = provider.binaryExtensions) === null || _c === void 0 ? void 0 : _c.forEach(function (ext) { return extensions.add(ext); });\r\n            });\r\n            this._extensions = extensions;\r\n            return extensions;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DataFormatRegistry.prototype, \"binaryExtensions\", {\r\n        get: function () {\r\n            if (this._binaryExtensions)\r\n                return this._binaryExtensions;\r\n            var binaryExtensions = new Set();\r\n            this._list.forEach(function (_a) {\r\n                var _b;\r\n                var provider = _a.provider;\r\n                return (_b = provider.binaryExtensions) === null || _b === void 0 ? void 0 : _b.forEach(function (ext) { return binaryExtensions.add(ext); });\r\n            });\r\n            this._binaryExtensions = binaryExtensions;\r\n            return binaryExtensions;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(DataFormatRegistry.prototype, \"options\", {\r\n        get: function () {\r\n            if (this._options)\r\n                return this._options;\r\n            var options = [];\r\n            this._list.forEach(function (_a) {\r\n                var name = _a.name, provider = _a.provider;\r\n                return options.push([name, provider.label, provider.category || '']);\r\n            });\r\n            this._options = options;\r\n            return options;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ;\r\n    DataFormatRegistry.prototype._clear = function () {\r\n        this._extensions = undefined;\r\n        this._binaryExtensions = undefined;\r\n        this._options = undefined;\r\n    };\r\n    DataFormatRegistry.prototype.add = function (name, provider) {\r\n        this._clear();\r\n        this._list.push({ name: name, provider: provider });\r\n        this._map.set(name, provider);\r\n    };\r\n    DataFormatRegistry.prototype.remove = function (name) {\r\n        this._clear();\r\n        this._list.splice(this._list.findIndex(function (e) { return e.name === name; }), 1);\r\n        this._map.delete(name);\r\n    };\r\n    DataFormatRegistry.prototype.auto = function (info, dataStateObject) {\r\n        for (var i = 0, il = this.list.length; i < il; ++i) {\r\n            var provider = this._list[i].provider;\r\n            var hasExt = false;\r\n            if (provider.binaryExtensions && provider.binaryExtensions.indexOf(info.ext) >= 0)\r\n                hasExt = true;\r\n            else if (provider.stringExtensions && provider.stringExtensions.indexOf(info.ext) >= 0)\r\n                hasExt = true;\r\n            if (hasExt && (!provider.isApplicable || provider.isApplicable(info, dataStateObject.data)))\r\n                return provider;\r\n        }\r\n        return;\r\n    };\r\n    DataFormatRegistry.prototype.get = function (name) {\r\n        if (this._map.has(name)) {\r\n            return this._map.get(name);\r\n        }\r\n        else {\r\n            throw new Error(\"unknown data format name '\" + name + \"'\");\r\n        }\r\n    };\r\n    Object.defineProperty(DataFormatRegistry.prototype, \"list\", {\r\n        get: function () {\r\n            return this._list;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return DataFormatRegistry;\r\n}());\r\nexport { DataFormatRegistry };\r\n//# sourceMappingURL=registry.js.map"]},"metadata":{},"sourceType":"module"}