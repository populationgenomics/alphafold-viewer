{"ast":null,"code":"import { __assign, __extends, __spreadArray } from \"tslib\";\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\n/**\r\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\n\nimport * as React from 'react';\nimport { getElementQueries, getNonStandardResidueQueries, getPolymerAndBranchedEntityQueries, StructureSelectionQueries } from '../../mol-plugin-state/helpers/structure-selection-query';\nimport { InteractivityManager } from '../../mol-plugin-state/manager/interactivity';\nimport { StructureComponentManager } from '../../mol-plugin-state/manager/structure/component';\nimport { compileIdListSelection } from '../../mol-script/util/id-list';\nimport { memoizeLatest } from '../../mol-util/memoize';\nimport { ParamDefinition } from '../../mol-util/param-definition';\nimport { capitalize, stripTags } from '../../mol-util/string';\nimport { PluginUIComponent, PurePluginUIComponent } from '../base';\nimport { ActionMenu } from '../controls/action-menu';\nimport { Button, ControlGroup, IconButton, ToggleButton } from '../controls/common';\nimport { BrushSvg, CancelOutlinedSvg, CloseSvg, CubeOutlineSvg, HelpOutlineSvg, Icon, IntersectSvg, RemoveSvg, RestoreSvg, SelectionModeSvg, SetSvg, SubtractSvg, UnionSvg } from '../controls/icons';\nimport { ParameterControls, PureSelectControl } from '../controls/parameters';\nimport { HelpGroup, HelpText, ViewportHelpContent } from '../viewport/help';\nimport { AddComponentControls } from './components';\n\nvar ToggleSelectionModeButton =\n/** @class */\nfunction (_super) {\n  __extends(ToggleSelectionModeButton, _super);\n\n  function ToggleSelectionModeButton() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._toggleSelMode = function () {\n      _this.plugin.selectionMode = !_this.plugin.selectionMode;\n    };\n\n    return _this;\n  }\n\n  ToggleSelectionModeButton.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.events.canvas3d.settingsUpdated, function () {\n      return _this.forceUpdate();\n    });\n    this.subscribe(this.plugin.layout.events.updated, function () {\n      return _this.forceUpdate();\n    });\n    this.subscribe(this.plugin.behaviors.interaction.selectionMode, function () {\n      return _this.forceUpdate();\n    });\n  };\n\n  ToggleSelectionModeButton.prototype.render = function () {\n    var style = this.props.inline ? {\n      background: 'transparent',\n      width: 'auto',\n      height: 'auto',\n      lineHeight: 'unset'\n    } : {\n      background: 'transparent'\n    };\n    return _jsx(IconButton, {\n      svg: SelectionModeSvg,\n      onClick: this._toggleSelMode,\n      title: 'Toggle Selection Mode',\n      style: style,\n      toggleState: this.plugin.selectionMode\n    }, void 0);\n  };\n\n  return ToggleSelectionModeButton;\n}(PurePluginUIComponent);\n\nexport { ToggleSelectionModeButton };\nvar StructureSelectionParams = {\n  granularity: InteractivityManager.Params.granularity\n};\nvar ActionHeader = new Map([['add', 'Add/Union Selection'], ['remove', 'Remove/Subtract Selection'], ['intersect', 'Intersect Selection'], ['set', 'Set Selection']]);\n\nvar StructureSelectionActionsControls =\n/** @class */\nfunction (_super) {\n  __extends(StructureSelectionActionsControls, _super);\n\n  function StructureSelectionActionsControls() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      action: void 0,\n      helper: void 0,\n      isEmpty: true,\n      isBusy: false,\n      canUndo: false\n    };\n\n    _this.set = function (modifier, selectionQuery) {\n      _this.plugin.managers.structure.selection.fromSelectionQuery(modifier, selectionQuery, false);\n    };\n\n    _this.selectQuery = function (item, e) {\n      if (!item || !_this.state.action) {\n        _this.setState({\n          action: void 0\n        });\n\n        return;\n      }\n\n      var q = _this.state.action;\n\n      if (e === null || e === void 0 ? void 0 : e.shiftKey) {\n        _this.set(q, item.value);\n      } else {\n        _this.setState({\n          action: void 0\n        }, function () {\n          _this.set(q, item.value);\n        });\n      }\n    };\n\n    _this.selectHelper = function (item, e) {\n      console.log(item);\n\n      if (!item || !_this.state.action) {\n        _this.setState({\n          action: void 0,\n          helper: void 0\n        });\n\n        return;\n      }\n\n      _this.setState({\n        helper: item.value.kind\n      });\n    };\n\n    _this.queriesItems = [];\n    _this.queriesVersion = -1;\n    _this.helpersItems = void 0;\n    _this.toggleAdd = _this.showAction('add');\n    _this.toggleRemove = _this.showAction('remove');\n    _this.toggleIntersect = _this.showAction('intersect');\n    _this.toggleSet = _this.showAction('set');\n    _this.toggleTheme = _this.showAction('theme');\n    _this.toggleAddComponent = _this.showAction('add-component');\n    _this.toggleHelp = _this.showAction('help');\n\n    _this.setGranuality = function (_a) {\n      var value = _a.value;\n\n      _this.plugin.managers.interactivity.setProps({\n        granularity: value\n      });\n    };\n\n    _this.turnOff = function () {\n      return _this.plugin.selectionMode = false;\n    };\n\n    _this.undo = function () {\n      var task = _this.plugin.state.data.undo();\n\n      if (task) _this.plugin.runTask(task);\n    };\n\n    _this.subtract = function () {\n      var sel = _this.plugin.managers.structure.hierarchy.getStructuresWithSelection();\n\n      var components = [];\n\n      for (var _i = 0, sel_1 = sel; _i < sel_1.length; _i++) {\n        var s = sel_1[_i];\n        components.push.apply(components, s.components);\n      }\n\n      if (components.length === 0) return;\n\n      _this.plugin.managers.structure.component.modifyByCurrentSelection(components, 'subtract');\n    };\n\n    return _this;\n  }\n\n  StructureSelectionActionsControls.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function (c) {\n      var isEmpty = c.hierarchy.structures.length === 0;\n\n      if (_this.state.isEmpty !== isEmpty) {\n        _this.setState({\n          isEmpty: isEmpty\n        });\n      } // trigger elementQueries and nonStandardResidueQueries recalculation\n\n\n      _this.queriesVersion = -1;\n\n      _this.forceUpdate();\n    });\n    this.subscribe(this.plugin.behaviors.state.isBusy, function (v) {\n      _this.setState({\n        isBusy: v,\n        action: void 0\n      });\n    });\n    this.subscribe(this.plugin.managers.interactivity.events.propsUpdated, function () {\n      _this.forceUpdate();\n    });\n    this.subscribe(this.plugin.state.data.events.historyUpdated, function (_a) {\n      var state = _a.state;\n\n      _this.setState({\n        canUndo: state.canUndo\n      });\n    });\n  };\n\n  Object.defineProperty(StructureSelectionActionsControls.prototype, \"isDisabled\", {\n    get: function () {\n      return this.state.isBusy || this.state.isEmpty;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StructureSelectionActionsControls.prototype, \"structures\", {\n    get: function () {\n      var _a;\n\n      var structures = [];\n\n      for (var _i = 0, _b = this.plugin.managers.structure.hierarchy.selection.structures; _i < _b.length; _i++) {\n        var s = _b[_i];\n        var structure = (_a = s.cell.obj) === null || _a === void 0 ? void 0 : _a.data;\n        if (structure) structures.push(structure);\n      }\n\n      return structures;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StructureSelectionActionsControls.prototype, \"queries\", {\n    get: function () {\n      var registry = this.plugin.query.structure.registry;\n\n      if (registry.version !== this.queriesVersion) {\n        var structures = this.structures;\n\n        var queries = __spreadArray(__spreadArray(__spreadArray(__spreadArray([], registry.list, true), getPolymerAndBranchedEntityQueries(structures), true), getNonStandardResidueQueries(structures), true), getElementQueries(structures), true).sort(function (a, b) {\n          return b.priority - a.priority;\n        });\n\n        this.queriesItems = ActionMenu.createItems(queries, {\n          filter: function (q) {\n            return q !== StructureSelectionQueries.current && !q.isHidden;\n          },\n          label: function (q) {\n            return q.label;\n          },\n          category: function (q) {\n            return q.category;\n          },\n          description: function (q) {\n            return q.description;\n          }\n        });\n        this.queriesVersion = registry.version;\n      }\n\n      return this.queriesItems;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StructureSelectionActionsControls.prototype, \"helpers\", {\n    get: function () {\n      if (this.helpersItems) return this.helpersItems; // TODO: this is an initial implementation of the helper UI\n      //       the plan is to add support to input queries in different languages\n      //       after this has been implemented in mol-script\n\n      var helpers = [{\n        kind: 'residue-list',\n        category: 'Helpers',\n        label: 'Atom/Residue Identifier List',\n        description: 'Create a selection from a list of atom/residue ranges.'\n      }];\n      this.helpersItems = ActionMenu.createItems(helpers, {\n        label: function (q) {\n          return q.label;\n        },\n        category: function (q) {\n          return q.category;\n        },\n        description: function (q) {\n          return q.description;\n        }\n      });\n      return this.helpersItems;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StructureSelectionActionsControls.prototype.showAction = function (q) {\n    var _this = this;\n\n    return function () {\n      return _this.setState({\n        action: _this.state.action === q ? void 0 : q,\n        helper: void 0\n      });\n    };\n  };\n\n  StructureSelectionActionsControls.prototype.render = function () {\n    var _this = this;\n\n    var granularity = this.plugin.managers.interactivity.props.granularity;\n    var undoTitle = this.state.canUndo ? \"Undo \" + this.plugin.state.data.latestUndoLabel : 'Some mistakes of the past can be undone.';\n    var children = void 0;\n\n    if (this.state.action && !this.state.helper) {\n      children = _jsxs(_Fragment, {\n        children: [this.state.action && this.state.action !== 'theme' && this.state.action !== 'add-component' && this.state.action !== 'help' && _jsxs(\"div\", __assign({\n          className: 'msp-selection-viewport-controls-actions'\n        }, {\n          children: [_jsx(ActionMenu, {\n            header: ActionHeader.get(this.state.action),\n            title: 'Click to close.',\n            items: this.queries,\n            onSelect: this.selectQuery,\n            noOffset: true\n          }, void 0), _jsx(ActionMenu, {\n            items: this.helpers,\n            onSelect: this.selectHelper,\n            noOffset: true\n          }, void 0)]\n        }), void 0), this.state.action === 'theme' && _jsx(\"div\", __assign({\n          className: 'msp-selection-viewport-controls-actions'\n        }, {\n          children: _jsx(ControlGroup, __assign({\n            header: 'Theme',\n            title: 'Click to close.',\n            initialExpanded: true,\n            hideExpander: true,\n            hideOffset: true,\n            onHeaderClick: this.toggleTheme,\n            topRightIcon: CloseSvg\n          }, {\n            children: _jsx(ApplyThemeControls, {\n              onApply: this.toggleTheme\n            }, void 0)\n          }), void 0)\n        }), void 0), this.state.action === 'add-component' && _jsx(\"div\", __assign({\n          className: 'msp-selection-viewport-controls-actions'\n        }, {\n          children: _jsx(ControlGroup, __assign({\n            header: 'Add Component',\n            title: 'Click to close.',\n            initialExpanded: true,\n            hideExpander: true,\n            hideOffset: true,\n            onHeaderClick: this.toggleAddComponent,\n            topRightIcon: CloseSvg\n          }, {\n            children: _jsx(AddComponentControls, {\n              onApply: this.toggleAddComponent,\n              forSelection: true\n            }, void 0)\n          }), void 0)\n        }), void 0), this.state.action === 'help' && _jsx(\"div\", __assign({\n          className: 'msp-selection-viewport-controls-actions'\n        }, {\n          children: _jsxs(ControlGroup, __assign({\n            header: 'Help',\n            title: 'Click to close.',\n            initialExpanded: true,\n            hideExpander: true,\n            hideOffset: true,\n            onHeaderClick: this.toggleHelp,\n            topRightIcon: CloseSvg,\n            maxHeight: '300px'\n          }, {\n            children: [_jsx(HelpGroup, __assign({\n              header: 'Selection Operations'\n            }, {\n              children: _jsxs(HelpText, {\n                children: [\"Use \", _jsx(Icon, {\n                  svg: UnionSvg,\n                  inline: true\n                }, void 0), \" \", _jsx(Icon, {\n                  svg: SubtractSvg,\n                  inline: true\n                }, void 0), \" \", _jsx(Icon, {\n                  svg: IntersectSvg,\n                  inline: true\n                }, void 0), \" \", _jsx(Icon, {\n                  svg: SetSvg,\n                  inline: true\n                }, void 0), \" to modify the selection.\"]\n              }, void 0)\n            }), void 0), _jsx(HelpGroup, __assign({\n              header: 'Representation Operations'\n            }, {\n              children: _jsxs(HelpText, {\n                children: [\"Use \", _jsx(Icon, {\n                  svg: BrushSvg,\n                  inline: true\n                }, void 0), \" \", _jsx(Icon, {\n                  svg: CubeOutlineSvg,\n                  inline: true\n                }, void 0), \" \", _jsx(Icon, {\n                  svg: RemoveSvg,\n                  inline: true\n                }, void 0), \" \", _jsx(Icon, {\n                  svg: RestoreSvg,\n                  inline: true\n                }, void 0), \" to color, create components, remove from components, or undo actions.\"]\n              }, void 0)\n            }), void 0), _jsx(ViewportHelpContent, {\n              selectOnly: true\n            }, void 0)]\n          }), void 0)\n        }), void 0)]\n      }, void 0);\n    } else if (ActionHeader.has(this.state.action) && this.state.helper === 'residue-list') {\n      var close_1 = function () {\n        return _this.setState({\n          action: void 0,\n          helper: void 0\n        });\n      };\n\n      children = _jsx(\"div\", __assign({\n        className: 'msp-selection-viewport-controls-actions'\n      }, {\n        children: _jsx(ControlGroup, __assign({\n          header: 'Atom/Residue Identifier List',\n          title: 'Click to close.',\n          initialExpanded: true,\n          hideExpander: true,\n          hideOffset: true,\n          onHeaderClick: close_1,\n          topRightIcon: CloseSvg\n        }, {\n          children: _jsx(ResidueListSelectionHelper, {\n            modifier: this.state.action,\n            plugin: this.plugin,\n            close: close_1\n          }, void 0)\n        }), void 0)\n      }), void 0);\n    }\n\n    return _jsxs(_Fragment, {\n      children: [_jsxs(\"div\", __assign({\n        className: 'msp-flex-row',\n        style: {\n          background: 'none'\n        }\n      }, {\n        children: [_jsx(PureSelectControl, {\n          title: \"Picking Level for selecting and highlighting\",\n          param: StructureSelectionParams.granularity,\n          name: 'granularity',\n          value: granularity,\n          onChange: this.setGranuality,\n          isDisabled: this.isDisabled\n        }, void 0), _jsx(ToggleButton, {\n          icon: UnionSvg,\n          title: ActionHeader.get('add') + \". Hold shift key to keep menu open.\",\n          toggle: this.toggleAdd,\n          isSelected: this.state.action === 'add',\n          disabled: this.isDisabled\n        }, void 0), _jsx(ToggleButton, {\n          icon: SubtractSvg,\n          title: ActionHeader.get('remove') + \". Hold shift key to keep menu open.\",\n          toggle: this.toggleRemove,\n          isSelected: this.state.action === 'remove',\n          disabled: this.isDisabled\n        }, void 0), _jsx(ToggleButton, {\n          icon: IntersectSvg,\n          title: ActionHeader.get('intersect') + \". Hold shift key to keep menu open.\",\n          toggle: this.toggleIntersect,\n          isSelected: this.state.action === 'intersect',\n          disabled: this.isDisabled\n        }, void 0), _jsx(ToggleButton, {\n          icon: SetSvg,\n          title: ActionHeader.get('set') + \". Hold shift key to keep menu open.\",\n          toggle: this.toggleSet,\n          isSelected: this.state.action === 'set',\n          disabled: this.isDisabled\n        }, void 0), _jsx(ToggleButton, {\n          icon: BrushSvg,\n          title: 'Apply Theme to Selection',\n          toggle: this.toggleTheme,\n          isSelected: this.state.action === 'theme',\n          disabled: this.isDisabled,\n          style: {\n            marginLeft: '10px'\n          }\n        }, void 0), _jsx(ToggleButton, {\n          icon: CubeOutlineSvg,\n          title: 'Create Component of Selection with Representation',\n          toggle: this.toggleAddComponent,\n          isSelected: this.state.action === 'add-component',\n          disabled: this.isDisabled\n        }, void 0), _jsx(IconButton, {\n          svg: RemoveSvg,\n          title: 'Remove/subtract Selection from all Components',\n          onClick: this.subtract,\n          disabled: this.isDisabled\n        }, void 0), _jsx(IconButton, {\n          svg: RestoreSvg,\n          onClick: this.undo,\n          disabled: !this.state.canUndo || this.isDisabled,\n          title: undoTitle\n        }, void 0), _jsx(ToggleButton, {\n          icon: HelpOutlineSvg,\n          title: 'Show/hide help',\n          toggle: this.toggleHelp,\n          style: {\n            marginLeft: '10px'\n          },\n          isSelected: this.state.action === 'help'\n        }, void 0), _jsx(IconButton, {\n          svg: CancelOutlinedSvg,\n          title: 'Turn selection mode off',\n          onClick: this.turnOff\n        }, void 0)]\n      }), void 0), children]\n    }, void 0);\n  };\n\n  return StructureSelectionActionsControls;\n}(PluginUIComponent);\n\nexport { StructureSelectionActionsControls };\n\nvar StructureSelectionStatsControls =\n/** @class */\nfunction (_super) {\n  __extends(StructureSelectionStatsControls, _super);\n\n  function StructureSelectionStatsControls() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isEmpty: true,\n      isBusy: false\n    };\n\n    _this.clear = function () {\n      return _this.plugin.managers.interactivity.lociSelects.deselectAll();\n    };\n\n    _this.focus = function () {\n      if (_this.plugin.managers.structure.selection.stats.elementCount === 0) return;\n\n      var sphere = _this.plugin.managers.structure.selection.getBoundary().sphere;\n\n      _this.plugin.managers.camera.focusSphere(sphere);\n    };\n\n    _this.highlight = function (e) {\n      _this.plugin.managers.interactivity.lociHighlights.clearHighlights();\n\n      _this.plugin.managers.structure.selection.entries.forEach(function (e) {\n        _this.plugin.managers.interactivity.lociHighlights.highlight({\n          loci: e.selection\n        }, false);\n      });\n    };\n\n    _this.clearHighlight = function () {\n      _this.plugin.managers.interactivity.lociHighlights.clearHighlights();\n    };\n\n    return _this;\n  }\n\n  StructureSelectionStatsControls.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.managers.structure.selection.events.changed, function () {\n      _this.forceUpdate();\n    });\n    this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function (c) {\n      var isEmpty = c.structures.length === 0;\n\n      if (_this.state.isEmpty !== isEmpty) {\n        _this.setState({\n          isEmpty: isEmpty\n        });\n      }\n    });\n    this.subscribe(this.plugin.behaviors.state.isBusy, function (v) {\n      _this.setState({\n        isBusy: v\n      });\n    });\n  };\n\n  Object.defineProperty(StructureSelectionStatsControls.prototype, \"isDisabled\", {\n    get: function () {\n      return this.state.isBusy || this.state.isEmpty;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StructureSelectionStatsControls.prototype, \"stats\", {\n    get: function () {\n      var stats = this.plugin.managers.structure.selection.stats;\n\n      if (stats.structureCount === 0 || stats.elementCount === 0) {\n        return 'Nothing Selected';\n      } else {\n        return stripTags(stats.label) + \" Selected\";\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StructureSelectionStatsControls.prototype.render = function () {\n    var stats = this.plugin.managers.structure.selection.stats;\n    var empty = stats.structureCount === 0 || stats.elementCount === 0;\n    if (empty && this.props.hideOnEmpty) return null;\n    return _jsx(_Fragment, {\n      children: _jsxs(\"div\", __assign({\n        className: 'msp-flex-row'\n      }, {\n        children: [_jsx(Button, __assign({\n          noOverflow: true,\n          onClick: this.focus,\n          title: 'Click to Focus Selection',\n          disabled: empty,\n          onMouseEnter: this.highlight,\n          onMouseLeave: this.clearHighlight,\n          style: {\n            textAlignLast: !empty ? 'left' : void 0\n          }\n        }, {\n          children: this.stats\n        }), void 0), !empty && _jsx(IconButton, {\n          svg: CancelOutlinedSvg,\n          onClick: this.clear,\n          title: 'Clear',\n          className: 'msp-form-control',\n          flex: true\n        }, void 0)]\n      }), void 0)\n    }, void 0);\n  };\n\n  return StructureSelectionStatsControls;\n}(PluginUIComponent);\n\nexport { StructureSelectionStatsControls };\n\nvar ApplyThemeControls =\n/** @class */\nfunction (_super) {\n  __extends(ApplyThemeControls, _super);\n\n  function ApplyThemeControls() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._params = memoizeLatest(function (pivot) {\n      return StructureComponentManager.getThemeParams(_this.plugin, pivot);\n    });\n    _this.state = {\n      values: ParamDefinition.getDefaultValues(_this.params)\n    };\n\n    _this.apply = function () {\n      var _a, _b;\n\n      _this.plugin.managers.structure.component.applyTheme(_this.state.values, _this.plugin.managers.structure.hierarchy.current.structures);\n\n      (_b = (_a = _this.props).onApply) === null || _b === void 0 ? void 0 : _b.call(_a);\n    };\n\n    _this.paramsChanged = function (values) {\n      return _this.setState({\n        values: values\n      });\n    };\n\n    return _this;\n  }\n\n  Object.defineProperty(ApplyThemeControls.prototype, \"params\", {\n    get: function () {\n      return this._params(this.plugin.managers.structure.component.pivotStructure);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  ApplyThemeControls.prototype.render = function () {\n    return _jsxs(_Fragment, {\n      children: [_jsx(ParameterControls, {\n        params: this.params,\n        values: this.state.values,\n        onChangeValues: this.paramsChanged\n      }, void 0), _jsx(Button, __assign({\n        icon: BrushSvg,\n        className: 'msp-btn-commit msp-btn-commit-on',\n        onClick: this.apply,\n        style: {\n          marginTop: '1px'\n        }\n      }, {\n        children: \"Apply Theme\"\n      }), void 0)]\n    }, void 0);\n  };\n\n  return ApplyThemeControls;\n}(PurePluginUIComponent);\n\nvar ResidueListIdTypeParams = {\n  idType: ParamDefinition.Select('auth', ParamDefinition.arrayToOptions(['auth', 'label', 'atom-id'])),\n  identifiers: ParamDefinition.Text('', {\n    description: 'A comma separated list of atom identifiers (e.g. 10, 15-25) or residue ranges in given chain (e.g. A 10-15, B 25, C 30:i)'\n  })\n};\nvar DefaultResidueListIdTypeParams = ParamDefinition.getDefaultValues(ResidueListIdTypeParams);\n\nfunction ResidueListSelectionHelper(_a) {\n  var modifier = _a.modifier,\n      plugin = _a.plugin,\n      close = _a.close;\n\n  var _b = React.useState(DefaultResidueListIdTypeParams),\n      state = _b[0],\n      setState = _b[1];\n\n  var apply = function () {\n    if (state.identifiers.trim().length === 0) return;\n\n    try {\n      close();\n      var query = compileIdListSelection(state.identifiers, state.idType);\n      plugin.managers.structure.selection.fromCompiledQuery(modifier, query, false);\n    } catch (e) {\n      plugin.log.error(\"Failed to create selection: \" + e);\n    }\n  };\n\n  return _jsxs(_Fragment, {\n    children: [_jsx(ParameterControls, {\n      params: ResidueListIdTypeParams,\n      values: state,\n      onChangeValues: setState,\n      onEnter: apply\n    }, void 0), _jsxs(Button, __assign({\n      className: 'msp-btn-commit msp-btn-commit-on',\n      disabled: state.identifiers.trim().length === 0,\n      onClick: apply,\n      style: {\n        marginTop: '1px'\n      }\n    }, {\n      children: [capitalize(modifier), \" Selection\"]\n    }), void 0)]\n  }, void 0);\n}","map":{"version":3,"sources":["../../../src/mol-plugin-ui/structure/selection.tsx"],"names":[],"mappings":";;AAAA;;;;;AAKG;;AAEH,OAAO,KAAK,KAAZ,MAAuB,OAAvB;AAEA,SAAS,iBAAT,EAA4B,4BAA5B,EAA0D,kCAA1D,EAA8F,yBAA9F,QAAwJ,0DAAxJ;AACA,SAAS,oBAAT,QAAqC,8CAArC;AACA,SAAS,yBAAT,QAA0C,oDAA1C;AAIA,SAAS,sBAAT,QAAuC,+BAAvC;AACA,SAAS,aAAT,QAA8B,wBAA9B;AACA,SAAS,eAAT,QAAgC,iCAAhC;AACA,SAAS,UAAT,EAAqB,SAArB,QAAsC,uBAAtC;AACA,SAAS,iBAAT,EAA4B,qBAA5B,QAAyD,SAAzD;AACA,SAAS,UAAT,QAA2B,yBAA3B;AACA,SAAS,MAAT,EAAiB,YAAjB,EAA+B,UAA/B,EAA2C,YAA3C,QAA+D,oBAA/D;AACA,SAAS,QAAT,EAAmB,iBAAnB,EAAsC,QAAtC,EAAgD,cAAhD,EAAgE,cAAhE,EAAgF,IAAhF,EAAsF,YAAtF,EAAoG,SAApG,EAA+G,UAA/G,EAA2H,gBAA3H,EAA6I,MAA7I,EAAqJ,WAArJ,EAAkK,QAAlK,QAAkL,mBAAlL;AACA,SAAS,iBAAT,EAA2C,iBAA3C,QAAoE,wBAApE;AACA,SAAS,SAAT,EAAoB,QAApB,EAA8B,mBAA9B,QAAyD,kBAAzD;AACA,SAAS,oBAAT,QAAqC,cAArC;;AAGA,IAAA,yBAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAA+C,EAAA,SAAA,CAAA,yBAAA,EAAA,MAAA,CAAA;;AAA/C,WAAA,yBAAA,GAAA;AAAA,QAAA,KAAA,GAAA,MAAA,KAAA,IAAA,IAAA,MAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA;;AAOI,IAAA,KAAA,CAAA,cAAA,GAAiB,YAAA;AACb,MAAA,KAAI,CAAC,MAAL,CAAY,aAAZ,GAA4B,CAAC,KAAI,CAAC,MAAL,CAAY,aAAzC;AACH,KAFD;;;AAUH;;AAhBG,EAAA,yBAAA,CAAA,SAAA,CAAA,iBAAA,GAAA,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACI,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,MAAZ,CAAmB,QAAnB,CAA4B,eAA3C,EAA4D,YAAA;AAAM,aAAA,KAAI,CAAJ,WAAA,EAAA;AAAkB,KAApF;AACA,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,MAAZ,CAAmB,MAAnB,CAA0B,OAAzC,EAAkD,YAAA;AAAM,aAAA,KAAI,CAAJ,WAAA,EAAA;AAAkB,KAA1E;AACA,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,SAAZ,CAAsB,WAAtB,CAAkC,aAAjD,EAAgE,YAAA;AAAM,aAAA,KAAI,CAAJ,WAAA,EAAA;AAAkB,KAAxF;AACH,GAJD;;AAUA,EAAA,yBAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACI,QAAM,KAAK,GAAG,KAAK,KAAL,CAAW,MAAX,GACR;AAAE,MAAA,UAAU,EAAE,aAAd;AAA6B,MAAA,KAAK,EAAE,MAApC;AAA4C,MAAA,MAAM,EAAE,MAApD;AAA4D,MAAA,UAAU,EAAE;AAAxE,KADQ,GAER;AAAE,MAAA,UAAU,EAAE;AAAd,KAFN;AAGA,WAAO,IAAA,CAAC,UAAD,EAAW;AAAC,MAAA,GAAG,EAAE,gBAAN;AAAwB,MAAA,OAAO,EAAE,KAAK,cAAtC;AAAsD,MAAA,KAAK,EAAE,uBAA7D;AAAsF,MAAA,KAAK,EAAE,KAA7F;AAAoG,MAAA,WAAW,EAAE,KAAK,MAAL,CAAY;AAA7H,KAAX,EAAqJ,KAAA,CAArJ,CAAP;AACH,GALD;;AAMJ,SAAA,yBAAA;AAAC,CAjBD,CAA+C,qBAA/C,CAAA;;;AAmBA,IAAM,wBAAwB,GAAG;AAC7B,EAAA,WAAW,EAAE,oBAAoB,CAAC,MAArB,CAA4B;AADZ,CAAjC;AAeA,IAAM,YAAY,GAAG,IAAI,GAAJ,CAA4C,CAC7D,CAAC,KAAD,EAAQ,qBAAR,CAD6D,EAE7D,CAAC,QAAD,EAAW,2BAAX,CAF6D,EAG7D,CAAC,WAAD,EAAc,qBAAd,CAH6D,EAI7D,CAAC,KAAD,EAAQ,eAAR,CAJ6D,CAA5C,CAArB;;AAOA,IAAA,iCAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAuD,EAAA,SAAA,CAAA,iCAAA,EAAA,MAAA,CAAA;;AAAvD,WAAA,iCAAA,GAAA;AAAA,QAAA,KAAA,GAAA,MAAA,KAAA,IAAA,IAAA,MAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA;;AACI,IAAA,KAAA,CAAA,KAAA,GAAQ;AACJ,MAAA,MAAM,EAAE,KAAK,CADT;AAEJ,MAAA,MAAM,EAAE,KAAK,CAFT;AAIJ,MAAA,OAAO,EAAE,IAJL;AAKJ,MAAA,MAAM,EAAE,KALJ;AAMJ,MAAA,OAAO,EAAE;AANL,KAAR;;AAqCA,IAAA,KAAA,CAAA,GAAA,GAAM,UAAC,QAAD,EAAuC,cAAvC,EAA8E;AAChF,MAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,kBAAzC,CAA4D,QAA5D,EAAsE,cAAtE,EAAsF,KAAtF;AACH,KAFD;;AAIA,IAAA,KAAA,CAAA,WAAA,GAAmC,UAAC,IAAD,EAAO,CAAP,EAAQ;AACvC,UAAI,CAAC,IAAD,IAAS,CAAC,KAAI,CAAC,KAAL,CAAW,MAAzB,EAAiC;AAC7B,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,MAAM,EAAE,KAAK;AAAf,SAAd;;AACA;AACH;;AACD,UAAM,CAAC,GAAG,KAAI,CAAC,KAAL,CAAW,MAArB;;AACA,UAAI,CAAC,KAAA,IAAD,IAAA,CAAC,KAAA,KAAA,CAAD,GAAC,KAAA,CAAD,GAAA,CAAC,CAAE,QAAP,EAAiB;AACb,QAAA,KAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAI,CAAC,KAAjB;AACH,OAFD,MAEO;AACH,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,MAAM,EAAE,KAAK;AAAf,SAAd,EAAkC,YAAA;AAC9B,UAAA,KAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAI,CAAC,KAAjB;AACH,SAFD;AAGH;AACJ,KAbD;;AAeA,IAAA,KAAA,CAAA,YAAA,GAAoC,UAAC,IAAD,EAAO,CAAP,EAAQ;AACxC,MAAA,OAAO,CAAC,GAAR,CAAY,IAAZ;;AACA,UAAI,CAAC,IAAD,IAAS,CAAC,KAAI,CAAC,KAAL,CAAW,MAAzB,EAAiC;AAC7B,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,MAAM,EAAE,KAAK,CAAf;AAAkB,UAAA,MAAM,EAAE,KAAK;AAA/B,SAAd;;AACA;AACH;;AACD,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,MAAM,EAAG,IAAI,CAAC,KAAL,CAA6C;AAAxD,OAAd;AACH,KAPD;;AAkBQ,IAAA,KAAA,CAAA,YAAA,GAAmC,EAAnC;AACA,IAAA,KAAA,CAAA,cAAA,GAAiB,CAAC,CAAlB;AAsBA,IAAA,KAAA,CAAA,YAAA,GAAoC,KAAK,CAAzC;AAqBR,IAAA,KAAA,CAAA,SAAA,GAAY,KAAI,CAAC,UAAL,CAAgB,KAAhB,CAAZ;AACA,IAAA,KAAA,CAAA,YAAA,GAAe,KAAI,CAAC,UAAL,CAAgB,QAAhB,CAAf;AACA,IAAA,KAAA,CAAA,eAAA,GAAkB,KAAI,CAAC,UAAL,CAAgB,WAAhB,CAAlB;AACA,IAAA,KAAA,CAAA,SAAA,GAAY,KAAI,CAAC,UAAL,CAAgB,KAAhB,CAAZ;AACA,IAAA,KAAA,CAAA,WAAA,GAAc,KAAI,CAAC,UAAL,CAAgB,OAAhB,CAAd;AACA,IAAA,KAAA,CAAA,kBAAA,GAAqB,KAAI,CAAC,UAAL,CAAgB,eAAhB,CAArB;AACA,IAAA,KAAA,CAAA,UAAA,GAAa,KAAI,CAAC,UAAL,CAAgB,MAAhB,CAAb;;AAEA,IAAA,KAAA,CAAA,aAAA,GAA+B,UAAC,EAAD,EAAU;UAAP,KAAK,GAAA,EAAA,CAAA,K;;AACnC,MAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,aAArB,CAAmC,QAAnC,CAA4C;AAAE,QAAA,WAAW,EAAE;AAAf,OAA5C;AACH,KAFD;;AAIA,IAAA,KAAA,CAAA,OAAA,GAAU,YAAA;AAAM,aAAA,KAAI,CAAC,MAAL,CAAY,aAAZ,GAAA,KAAA;AAAiC,KAAjD;;AAEA,IAAA,KAAA,CAAA,IAAA,GAAO,YAAA;AACH,UAAM,IAAI,GAAG,KAAI,CAAC,MAAL,CAAY,KAAZ,CAAkB,IAAlB,CAAuB,IAAvB,EAAb;;AACA,UAAI,IAAJ,EAAU,KAAI,CAAC,MAAL,CAAY,OAAZ,CAAoB,IAApB;AACb,KAHD;;AAKA,IAAA,KAAA,CAAA,QAAA,GAAW,YAAA;AACP,UAAM,GAAG,GAAG,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,0BAAzC,EAAZ;;AACA,UAAM,UAAU,GAA4B,EAA5C;;AACA,WAAgB,IAAA,EAAA,GAAA,CAAA,EAAA,KAAA,GAAA,GAAhB,EAAgB,EAAA,GAAA,KAAA,CAAA,MAAhB,EAAgB,EAAA,EAAhB,EAAmB;AAAd,YAAM,CAAC,GAAA,KAAA,CAAA,EAAA,CAAP;AAAgB,QAAA,UAAU,CAAC,IAAX,CAAe,KAAf,CAAA,UAAA,EAAmB,CAAC,CAAC,UAArB;AAAiC;;AACtD,UAAI,UAAU,CAAC,MAAX,KAAsB,CAA1B,EAA6B;;AAC7B,MAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,wBAAzC,CAAkE,UAAlE,EAA8E,UAA9E;AACH,KAND;;;AAwEH;;AAxMG,EAAA,iCAAA,CAAA,SAAA,CAAA,iBAAA,GAAA,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACI,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,SAAzC,CAAmD,SAAlE,EAA6E,UAAA,CAAA,EAAC;AAC1E,UAAM,OAAO,GAAG,CAAC,CAAC,SAAF,CAAY,UAAZ,CAAuB,MAAvB,KAAkC,CAAlD;;AACA,UAAI,KAAI,CAAC,KAAL,CAAW,OAAX,KAAuB,OAA3B,EAAoC;AAChC,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,OAAO,EAAA;AAAT,SAAd;AACH,OAJyE,CAK1E;;;AACA,MAAA,KAAI,CAAC,cAAL,GAAsB,CAAC,CAAvB;;AACA,MAAA,KAAI,CAAC,WAAL;AACH,KARD;AAUA,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,SAAZ,CAAsB,KAAtB,CAA4B,MAA3C,EAAmD,UAAA,CAAA,EAAC;AAChD,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,MAAM,EAAE,CAAV;AAAa,QAAA,MAAM,EAAE,KAAK;AAA1B,OAAd;AACH,KAFD;AAIA,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,QAAZ,CAAqB,aAArB,CAAmC,MAAnC,CAA0C,YAAzD,EAAuE,YAAA;AACnE,MAAA,KAAI,CAAC,WAAL;AACH,KAFD;AAIA,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,KAAZ,CAAkB,IAAlB,CAAuB,MAAvB,CAA8B,cAA7C,EAA6D,UAAC,EAAD,EAAU;UAAP,KAAK,GAAA,EAAA,CAAA,K;;AACjE,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,OAAO,EAAE,KAAK,CAAC;AAAjB,OAAd;AACH,KAFD;AAGH,GAtBD;;AAwBA,EAAA,MAAA,CAAA,cAAA,CAAI,iCAAA,CAAA,SAAJ,EAAI,YAAJ,EAAc;SAAd,YAAA;AACI,aAAO,KAAK,KAAL,CAAW,MAAX,IAAqB,KAAK,KAAL,CAAW,OAAvC;AACH,KAFa;qBAAA;;AAAA,GAAd;AAgCA,EAAA,MAAA,CAAA,cAAA,CAAI,iCAAA,CAAA,SAAJ,EAAI,YAAJ,EAAc;SAAd,YAAA;;;AACI,UAAM,UAAU,GAAgB,EAAhC;;AACA,WAAgB,IAAA,EAAA,GAAA,CAAA,EAAA,EAAA,GAAA,KAAK,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,SAAzC,CAAmD,UAAnE,EAAgB,EAAA,GAAA,EAAA,CAAA,MAAhB,EAAgB,EAAA,EAAhB,EAA+E;AAA1E,YAAM,CAAC,GAAA,EAAA,CAAA,EAAA,CAAP;AACD,YAAM,SAAS,GAAG,CAAA,EAAA,GAAA,CAAC,CAAC,IAAF,CAAO,GAAP,MAAU,IAAV,IAAU,EAAA,KAAA,KAAA,CAAV,GAAU,KAAA,CAAV,GAAU,EAAA,CAAE,IAA9B;AACA,YAAI,SAAJ,EAAe,UAAU,CAAC,IAAX,CAAgB,SAAhB;AAClB;;AACD,aAAO,UAAP;AACH,KAPa;qBAAA;;AAAA,GAAd;AAWA,EAAA,MAAA,CAAA,cAAA,CAAI,iCAAA,CAAA,SAAJ,EAAI,SAAJ,EAAW;SAAX,YAAA;AACY,UAAA,QAAQ,GAAK,KAAK,MAAL,CAAY,KAAZ,CAAkB,SAAlB,CAAL,QAAR;;AACR,UAAI,QAAQ,CAAC,OAAT,KAAqB,KAAK,cAA9B,EAA8C;AAC1C,YAAM,UAAU,GAAG,KAAK,UAAxB;;AACA,YAAM,OAAO,GAAG,aAAA,CAAA,aAAA,CAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EACT,QAAQ,CAAC,IADA,EACI,IADJ,CAAA,EAET,kCAAkC,CAAC,UAAD,CAFzB,EAEqC,IAFrC,CAAA,EAGT,4BAA4B,CAAC,UAAD,CAHnB,EAG+B,IAH/B,CAAA,EAIT,iBAAiB,CAAC,UAAD,CAJR,EAIoB,IAJpB,CAAA,CAKd,IALc,CAKT,UAAC,CAAD,EAAI,CAAJ,EAAK;AAAK,iBAAA,CAAC,CAAC,QAAF,GAAa,CAAC,CAAd,QAAA;AAAuB,SALxB,CAAhB;;AAMA,aAAK,YAAL,GAAoB,UAAU,CAAC,WAAX,CAAuB,OAAvB,EAAgC;AAChD,UAAA,MAAM,EAAE,UAAA,CAAA,EAAC;AAAI,mBAAA,CAAC,KAAK,yBAAyB,CAAC,OAAhC,IAA2C,CAAC,CAAC,CAA7C,QAAA;AAAsD,WADnB;AAEhD,UAAA,KAAK,EAAE,UAAA,CAAA,EAAC;AAAI,mBAAA,CAAC,CAAD,KAAA;AAAO,WAF6B;AAGhD,UAAA,QAAQ,EAAE,UAAA,CAAA,EAAC;AAAI,mBAAA,CAAC,CAAD,QAAA;AAAU,WAHuB;AAIhD,UAAA,WAAW,EAAE,UAAA,CAAA,EAAC;AAAI,mBAAA,CAAC,CAAD,WAAA;AAAa;AAJiB,SAAhC,CAApB;AAMA,aAAK,cAAL,GAAsB,QAAQ,CAAC,OAA/B;AACH;;AACD,aAAO,KAAK,YAAZ;AACH,KAnBU;qBAAA;;AAAA,GAAX;AAsBA,EAAA,MAAA,CAAA,cAAA,CAAI,iCAAA,CAAA,SAAJ,EAAI,SAAJ,EAAW;SAAX,YAAA;AACI,UAAI,KAAK,YAAT,EAAuB,OAAO,KAAK,YAAZ,CAD3B,CAEI;AACA;AACA;;AACA,UAAM,OAAO,GAAG,CACZ;AAAE,QAAA,IAAI,EAAE,cAAR;AAA+C,QAAA,QAAQ,EAAE,SAAzD;AAAoE,QAAA,KAAK,EAAE,8BAA3E;AAA2G,QAAA,WAAW,EAAE;AAAxH,OADY,CAAhB;AAGA,WAAK,YAAL,GAAoB,UAAU,CAAC,WAAX,CAAuB,OAAvB,EAAgC;AAChD,QAAA,KAAK,EAAE,UAAA,CAAA,EAAC;AAAI,iBAAA,CAAC,CAAD,KAAA;AAAO,SAD6B;AAEhD,QAAA,QAAQ,EAAE,UAAA,CAAA,EAAC;AAAI,iBAAA,CAAC,CAAD,QAAA;AAAU,SAFuB;AAGhD,QAAA,WAAW,EAAE,UAAA,CAAA,EAAC;AAAI,iBAAA,CAAC,CAAD,WAAA;AAAa;AAHiB,OAAhC,CAApB;AAKA,aAAO,KAAK,YAAZ;AACH,KAdU;qBAAA;;AAAA,GAAX;;AAgBQ,EAAA,iCAAA,CAAA,SAAA,CAAA,UAAA,GAAR,UAAmB,CAAnB,EAAsE;AAAtE,QAAA,KAAA,GAAA,IAAA;;AACI,WAAO,YAAA;AAAM,aAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,MAAM,EAAE,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,CAAtB,GAA0B,KAAK,CAA/B,GAAmC,CAA7C;AAAgD,QAAA,MAAM,EAAE,KAAtE;AAAc,OAAd,CAAA;AAA+E,KAA5F;AACH,GAFO;;AA+BR,EAAA,iCAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACI,QAAM,WAAW,GAAG,KAAK,MAAL,CAAY,QAAZ,CAAqB,aAArB,CAAmC,KAAnC,CAAyC,WAA7D;AACA,QAAM,SAAS,GAAG,KAAK,KAAL,CAAW,OAAX,GACZ,UAAQ,KAAK,MAAL,CAAY,KAAZ,CAAkB,IAAlB,CAAuB,eADnB,GAEZ,0CAFN;AAIA,QAAI,QAAQ,GAAgC,KAAK,CAAjD;;AAEA,QAAI,KAAK,KAAL,CAAW,MAAX,IAAqB,CAAC,KAAK,KAAL,CAAW,MAArC,EAA6C;AACzC,MAAA,QAAQ,GAAG,KAAA,CAAA,SAAA,EAAA;AAAA,QAAA,QAAA,EAAA,CACL,KAAK,KAAL,CAAW,MAAX,IAAqB,KAAK,KAAL,CAAW,MAAX,KAAsB,OAA3C,IAAsD,KAAK,KAAL,CAAW,MAAX,KAAsB,eAA5E,IAA+F,KAAK,KAAL,CAAW,MAAX,KAAsB,MAAtH,IAAiI,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,UAAA,SAAS,EAAC;AAAf,SAAA,EAAwD;AAAA,UAAA,QAAA,EAAA,CACtL,IAAA,CAAC,UAAD,EAAW;AAAC,YAAA,MAAM,EAAE,YAAY,CAAC,GAAb,CAAiB,KAAK,KAAL,CAAW,MAA5B,CAAT;AAA4E,YAAA,KAAK,EAAC,iBAAlF;AAAoG,YAAA,KAAK,EAAE,KAAK,OAAhH;AAAyH,YAAA,QAAQ,EAAE,KAAK,WAAxI;AAAqJ,YAAA,QAAQ,EAAA;AAA7J,WAAX,EAAwK,KAAA,CAAxK,CADsL,EAEtL,IAAA,CAAC,UAAD,EAAW;AAAC,YAAA,KAAK,EAAE,KAAK,OAAb;AAAsB,YAAA,QAAQ,EAAE,KAAK,YAArC;AAAmD,YAAA,QAAQ,EAAA;AAA3D,WAAX,EAAsE,KAAA,CAAtE,CAFsL;AAAA,SAAxD,CAAA,EAErD,KAAA,CAFqD,CAD3H,EAKN,KAAK,KAAL,CAAW,MAAX,KAAsB,OAAtB,IAAiC,IAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,UAAA,SAAS,EAAC;AAAf,SAAA,EAAwD;AAAA,UAAA,QAAA,EACtF,IAAA,CAAC,YAAD,EAAa,QAAA,CAAA;AAAC,YAAA,MAAM,EAAC,OAAR;AAAgB,YAAA,KAAK,EAAC,iBAAtB;AAAwC,YAAA,eAAe,EAAE,IAAzD;AAA+D,YAAA,YAAY,EAAE,IAA7E;AAAmF,YAAA,UAAU,EAAE,IAA/F;AAAqG,YAAA,aAAa,EAAE,KAAK,WAAzH;AAAsI,YAAA,YAAY,EAAE;AAApJ,WAAA,EAA4J;AAAA,YAAA,QAAA,EACrK,IAAA,CAAC,kBAAD,EAAmB;AAAC,cAAA,OAAO,EAAE,KAAK;AAAf,aAAnB,EAA6C,KAAA,CAA7C;AADqK,WAA5J,CAAb,EACqD,KAAA,CADrD;AADsF,SAAxD,CAAA,EAGf,KAAA,CAHe,CAL3B,EAUN,KAAK,KAAL,CAAW,MAAX,KAAsB,eAAtB,IAAyC,IAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,UAAA,SAAS,EAAC;AAAf,SAAA,EAAwD;AAAA,UAAA,QAAA,EAC9F,IAAA,CAAC,YAAD,EAAa,QAAA,CAAA;AAAC,YAAA,MAAM,EAAC,eAAR;AAAwB,YAAA,KAAK,EAAC,iBAA9B;AAAgD,YAAA,eAAe,EAAE,IAAjE;AAAuE,YAAA,YAAY,EAAE,IAArF;AAA2F,YAAA,UAAU,EAAE,IAAvG;AAA6G,YAAA,aAAa,EAAE,KAAK,kBAAjI;AAAqJ,YAAA,YAAY,EAAE;AAAnK,WAAA,EAA2K;AAAA,YAAA,QAAA,EACpL,IAAA,CAAC,oBAAD,EAAqB;AAAC,cAAA,OAAO,EAAE,KAAK,kBAAf;AAAmC,cAAA,YAAY,EAAA;AAA/C,aAArB,EAAoE,KAAA,CAApE;AADoL,WAA3K,CAAb,EAC2E,KAAA,CAD3E;AAD8F,SAAxD,CAAA,EAGvB,KAAA,CAHuB,CAVnC,EAeN,KAAK,KAAL,CAAW,MAAX,KAAsB,MAAtB,IAAgC,IAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,UAAA,SAAS,EAAC;AAAf,SAAA,EAAwD;AAAA,UAAA,QAAA,EACrF,KAAA,CAAC,YAAD,EAAa,QAAA,CAAA;AAAC,YAAA,MAAM,EAAC,MAAR;AAAe,YAAA,KAAK,EAAC,iBAArB;AAAuC,YAAA,eAAe,EAAE,IAAxD;AAA8D,YAAA,YAAY,EAAE,IAA5E;AAAkF,YAAA,UAAU,EAAE,IAA9F;AAAoG,YAAA,aAAa,EAAE,KAAK,UAAxH;AAAoI,YAAA,YAAY,EAAE,QAAlJ;AAA4J,YAAA,SAAS,EAAC;AAAtK,WAAA,EAA6K;AAAA,YAAA,QAAA,EAAA,CACtL,IAAA,CAAC,SAAD,EAAU,QAAA,CAAA;AAAC,cAAA,MAAM,EAAC;AAAR,aAAA,EAA8B;AAAA,cAAA,QAAA,EACpC,KAAA,CAAC,QAAD,EAAS;AAAA,gBAAA,QAAA,EAAA,CAAA,MAAA,EAAK,IAAA,CAAC,IAAD,EAAK;AAAC,kBAAA,GAAG,EAAE,QAAN;AAAgB,kBAAA,MAAM,EAAA;AAAtB,iBAAL,EAA2B,KAAA,CAA3B,CAAL,EAAmC,GAAnC,EAAoC,IAAA,CAAC,IAAD,EAAK;AAAC,kBAAA,GAAG,EAAE,WAAN;AAAmB,kBAAA,MAAM,EAAA;AAAzB,iBAAL,EAA8B,KAAA,CAA9B,CAApC,EAAqE,GAArE,EAAsE,IAAA,CAAC,IAAD,EAAK;AAAC,kBAAA,GAAG,EAAE,YAAN;AAAoB,kBAAA,MAAM,EAAA;AAA1B,iBAAL,EAA+B,KAAA,CAA/B,CAAtE,EAAwG,GAAxG,EAAyG,IAAA,CAAC,IAAD,EAAK;AAAC,kBAAA,GAAG,EAAE,MAAN;AAAc,kBAAA,MAAM,EAAA;AAApB,iBAAL,EAAyB,KAAA,CAAzB,CAAzG,EAAqI,2BAArI;AAAA,eAAT,EAA8I,KAAA,CAA9I;AADoC,aAA9B,CAAV,EACsL,KAAA,CADtL,CADsL,EAItL,IAAA,CAAC,SAAD,EAAU,QAAA,CAAA;AAAC,cAAA,MAAM,EAAC;AAAR,aAAA,EAAmC;AAAA,cAAA,QAAA,EACzC,KAAA,CAAC,QAAD,EAAS;AAAA,gBAAA,QAAA,EAAA,CAAA,MAAA,EAAK,IAAA,CAAC,IAAD,EAAK;AAAC,kBAAA,GAAG,EAAE,QAAN;AAAgB,kBAAA,MAAM,EAAA;AAAtB,iBAAL,EAA2B,KAAA,CAA3B,CAAL,EAAmC,GAAnC,EAAoC,IAAA,CAAC,IAAD,EAAK;AAAC,kBAAA,GAAG,EAAE,cAAN;AAAsB,kBAAA,MAAM,EAAA;AAA5B,iBAAL,EAAiC,KAAA,CAAjC,CAApC,EAAwE,GAAxE,EAAyE,IAAA,CAAC,IAAD,EAAK;AAAC,kBAAA,GAAG,EAAE,SAAN;AAAiB,kBAAA,MAAM,EAAA;AAAvB,iBAAL,EAA4B,KAAA,CAA5B,CAAzE,EAAwG,GAAxG,EAAyG,IAAA,CAAC,IAAD,EAAK;AAAC,kBAAA,GAAG,EAAE,UAAN;AAAkB,kBAAA,MAAM,EAAA;AAAxB,iBAAL,EAA6B,KAAA,CAA7B,CAAzG,EAAyI,wEAAzI;AAAA,eAAT,EAAkJ,KAAA,CAAlJ;AADyC,aAAnC,CAAV,EACuO,KAAA,CADvO,CAJsL,EAOtL,IAAA,CAAC,mBAAD,EAAoB;AAAC,cAAA,UAAU,EAAE;AAAb,aAApB,EAAqC,KAAA,CAArC,CAPsL;AAAA,WAA7K,CAAb,EAO6C,KAAA,CAP7C;AADqF,SAAxD,CAAA,EASd,KAAA,CATc,CAf1B;AAAA,OAAA,EAyBD,KAAA,CAzBC,CAAX;AA2BH,KA5BD,MA4BO,IAAI,YAAY,CAAC,GAAb,CAAiB,KAAK,KAAL,CAAW,MAA5B,KAA8C,KAAK,KAAL,CAAW,MAAX,KAAsB,cAAxE,EAAwF;AAC3F,UAAM,OAAK,GAAG,YAAA;AAAM,eAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,MAAM,EAAE,KAAK,CAAf;AAAkB,UAAA,MAAM,EAAE,KAAxC;AAAc,SAAd,CAAA;AAAiD,OAArE;;AACA,MAAA,QAAQ,GAAG,IAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,QAAA,SAAS,EAAC;AAAf,OAAA,EAAwD;AAAA,QAAA,QAAA,EAC/D,IAAA,CAAC,YAAD,EAAa,QAAA,CAAA;AAAC,UAAA,MAAM,EAAC,8BAAR;AAAuC,UAAA,KAAK,EAAC,iBAA7C;AAA+D,UAAA,eAAe,EAAE,IAAhF;AAAsF,UAAA,YAAY,EAAE,IAApG;AAA0G,UAAA,UAAU,EAAE,IAAtH;AAA4H,UAAA,aAAa,EAAE,OAA3I;AAAkJ,UAAA,YAAY,EAAE;AAAhK,SAAA,EAAwK;AAAA,UAAA,QAAA,EACjL,IAAA,CAAC,0BAAD,EAA2B;AAAC,YAAA,QAAQ,EAAE,KAAK,KAAL,CAAW,MAAtB;AAAqC,YAAA,MAAM,EAAE,KAAK,MAAlD;AAA0D,YAAA,KAAK,EAAE;AAAjE,WAA3B,EAAiG,KAAA,CAAjG;AADiL,SAAxK,CAAb,EACyG,KAAA,CADzG;AAD+D,OAAxD,CAAA,EAGQ,KAAA,CAHR,CAAX;AAKH;;AAED,WAAO,KAAA,CAAA,SAAA,EAAA;AAAA,MAAA,QAAA,EAAA,CACH,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,QAAA,SAAS,EAAC,cAAf;AAA8B,QAAA,KAAK,EAAE;AAAE,UAAA,UAAU,EAAE;AAAd;AAArC,OAAA,EAA2D;AAAA,QAAA,QAAA,EAAA,CACvD,IAAA,CAAC,iBAAD,EAAkB;AAAC,UAAA,KAAK,EAAE,8CAAR;AAAwD,UAAA,KAAK,EAAE,wBAAwB,CAAC,WAAxF;AAAqG,UAAA,IAAI,EAAC,aAA1G;AAAwH,UAAA,KAAK,EAAE,WAA/H;AAA4I,UAAA,QAAQ,EAAE,KAAK,aAA3J;AAA0K,UAAA,UAAU,EAAE,KAAK;AAA3L,SAAlB,EAAuN,KAAA,CAAvN,CADuD,EAEvD,IAAA,CAAC,YAAD,EAAa;AAAC,UAAA,IAAI,EAAE,QAAP;AAAiB,UAAA,KAAK,EAAK,YAAY,CAAC,GAAb,CAAiB,KAAjB,IAAuB,qCAAlD;AAAyF,UAAA,MAAM,EAAE,KAAK,SAAtG;AAAiH,UAAA,UAAU,EAAE,KAAK,KAAL,CAAW,MAAX,KAAsB,KAAnJ;AAA0J,UAAA,QAAQ,EAAE,KAAK;AAAzK,SAAb,EAAgM,KAAA,CAAhM,CAFuD,EAGvD,IAAA,CAAC,YAAD,EAAa;AAAC,UAAA,IAAI,EAAE,WAAP;AAAoB,UAAA,KAAK,EAAK,YAAY,CAAC,GAAb,CAAiB,QAAjB,IAA0B,qCAAxD;AAA+F,UAAA,MAAM,EAAE,KAAK,YAA5G;AAA0H,UAAA,UAAU,EAAE,KAAK,KAAL,CAAW,MAAX,KAAsB,QAA5J;AAAsK,UAAA,QAAQ,EAAE,KAAK;AAArL,SAAb,EAA4M,KAAA,CAA5M,CAHuD,EAIvD,IAAA,CAAC,YAAD,EAAa;AAAC,UAAA,IAAI,EAAE,YAAP;AAAqB,UAAA,KAAK,EAAK,YAAY,CAAC,GAAb,CAAiB,WAAjB,IAA6B,qCAA5D;AAAmG,UAAA,MAAM,EAAE,KAAK,eAAhH;AAAiI,UAAA,UAAU,EAAE,KAAK,KAAL,CAAW,MAAX,KAAsB,WAAnK;AAAgL,UAAA,QAAQ,EAAE,KAAK;AAA/L,SAAb,EAAsN,KAAA,CAAtN,CAJuD,EAKvD,IAAA,CAAC,YAAD,EAAa;AAAC,UAAA,IAAI,EAAE,MAAP;AAAe,UAAA,KAAK,EAAK,YAAY,CAAC,GAAb,CAAiB,KAAjB,IAAuB,qCAAhD;AAAuF,UAAA,MAAM,EAAE,KAAK,SAApG;AAA+G,UAAA,UAAU,EAAE,KAAK,KAAL,CAAW,MAAX,KAAsB,KAAjJ;AAAwJ,UAAA,QAAQ,EAAE,KAAK;AAAvK,SAAb,EAA8L,KAAA,CAA9L,CALuD,EAOvD,IAAA,CAAC,YAAD,EAAa;AAAC,UAAA,IAAI,EAAE,QAAP;AAAiB,UAAA,KAAK,EAAC,0BAAvB;AAAkD,UAAA,MAAM,EAAE,KAAK,WAA/D;AAA4E,UAAA,UAAU,EAAE,KAAK,KAAL,CAAW,MAAX,KAAsB,OAA9G;AAAuH,UAAA,QAAQ,EAAE,KAAK,UAAtI;AAAkJ,UAAA,KAAK,EAAE;AAAE,YAAA,UAAU,EAAE;AAAd;AAAzJ,SAAb,EAA4L,KAAA,CAA5L,CAPuD,EAQvD,IAAA,CAAC,YAAD,EAAa;AAAC,UAAA,IAAI,EAAE,cAAP;AAAuB,UAAA,KAAK,EAAC,mDAA7B;AAAiF,UAAA,MAAM,EAAE,KAAK,kBAA9F;AAAkH,UAAA,UAAU,EAAE,KAAK,KAAL,CAAW,MAAX,KAAsB,eAApJ;AAAqK,UAAA,QAAQ,EAAE,KAAK;AAApL,SAAb,EAA2M,KAAA,CAA3M,CARuD,EASvD,IAAA,CAAC,UAAD,EAAW;AAAC,UAAA,GAAG,EAAE,SAAN;AAAiB,UAAA,KAAK,EAAC,+CAAvB;AAAuE,UAAA,OAAO,EAAE,KAAK,QAArF;AAA+F,UAAA,QAAQ,EAAE,KAAK;AAA9G,SAAX,EAAmI,KAAA,CAAnI,CATuD,EAUvD,IAAA,CAAC,UAAD,EAAW;AAAC,UAAA,GAAG,EAAE,UAAN;AAAkB,UAAA,OAAO,EAAE,KAAK,IAAhC;AAAsC,UAAA,QAAQ,EAAE,CAAC,KAAK,KAAL,CAAW,OAAZ,IAAuB,KAAK,UAA5E;AAAwF,UAAA,KAAK,EAAE;AAA/F,SAAX,EAAmH,KAAA,CAAnH,CAVuD,EAYvD,IAAA,CAAC,YAAD,EAAa;AAAC,UAAA,IAAI,EAAE,cAAP;AAAuB,UAAA,KAAK,EAAC,gBAA7B;AAA8C,UAAA,MAAM,EAAE,KAAK,UAA3D;AAAuE,UAAA,KAAK,EAAE;AAAE,YAAA,UAAU,EAAE;AAAd,WAA9E;AAAsG,UAAA,UAAU,EAAE,KAAK,KAAL,CAAW,MAAX,KAAsB;AAAxI,SAAb,EAA2J,KAAA,CAA3J,CAZuD,EAavD,IAAA,CAAC,UAAD,EAAW;AAAC,UAAA,GAAG,EAAE,iBAAN;AAAyB,UAAA,KAAK,EAAC,yBAA/B;AAAyD,UAAA,OAAO,EAAE,KAAK;AAAvE,SAAX,EAAyF,KAAA,CAAzF,CAbuD;AAAA,OAA3D,CAAA,EAaiG,KAAA,CAbjG,CADG,EAgBF,QAhBE;AAAA,KAAA,EAgBM,KAAA,CAhBN,CAAP;AAkBH,GA/DD;;AAgEJ,SAAA,iCAAA;AAAC,CAlND,CAAuD,iBAAvD,CAAA;;;;AAoNA,IAAA,+BAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAqD,EAAA,SAAA,CAAA,+BAAA,EAAA,MAAA,CAAA;;AAArD,WAAA,+BAAA,GAAA;AAAA,QAAA,KAAA,GAAA,MAAA,KAAA,IAAA,IAAA,MAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA;;AACI,IAAA,KAAA,CAAA,KAAA,GAAQ;AACJ,MAAA,OAAO,EAAE,IADL;AAEJ,MAAA,MAAM,EAAE;AAFJ,KAAR;;AAmCA,IAAA,KAAA,CAAA,KAAA,GAAQ,YAAA;AAAM,aAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,aAArB,CAAmC,WAAnC,CAAA,WAAA,EAAA;AAA4D,KAA1E;;AAEA,IAAA,KAAA,CAAA,KAAA,GAAQ,YAAA;AACJ,UAAI,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,KAAzC,CAA+C,YAA/C,KAAgE,CAApE,EAAuE;;AAC/D,UAAA,MAAM,GAAK,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,WAAzC,GAAL,MAAN;;AACR,MAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,MAArB,CAA4B,WAA5B,CAAwC,MAAxC;AACH,KAJD;;AAMA,IAAA,KAAA,CAAA,SAAA,GAAY,UAAC,CAAD,EAAiC;AACzC,MAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,aAArB,CAAmC,cAAnC,CAAkD,eAAlD;;AACA,MAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,OAAzC,CAAiD,OAAjD,CAAyD,UAAA,CAAA,EAAC;AACtD,QAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,aAArB,CAAmC,cAAnC,CAAkD,SAAlD,CAA4D;AAAE,UAAA,IAAI,EAAE,CAAC,CAAC;AAAV,SAA5D,EAAmF,KAAnF;AACH,OAFD;AAGH,KALD;;AAOA,IAAA,KAAA,CAAA,cAAA,GAAiB,YAAA;AACb,MAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,aAArB,CAAmC,cAAnC,CAAkD,eAAlD;AACH,KAFD;;;AAoBH;;AAjEG,EAAA,+BAAA,CAAA,SAAA,CAAA,iBAAA,GAAA,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACI,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,MAAzC,CAAgD,OAA/D,EAAwE,YAAA;AACpE,MAAA,KAAI,CAAC,WAAL;AACH,KAFD;AAIA,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,SAAzC,CAAmD,SAAlE,EAA6E,UAAA,CAAA,EAAC;AAC1E,UAAM,OAAO,GAAG,CAAC,CAAC,UAAF,CAAa,MAAb,KAAwB,CAAxC;;AACA,UAAI,KAAI,CAAC,KAAL,CAAW,OAAX,KAAuB,OAA3B,EAAoC;AAChC,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,OAAO,EAAA;AAAT,SAAd;AACH;AACJ,KALD;AAOA,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,SAAZ,CAAsB,KAAtB,CAA4B,MAA3C,EAAmD,UAAA,CAAA,EAAC;AAChD,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,MAAM,EAAE;AAAV,OAAd;AACH,KAFD;AAGH,GAfD;;AAiBA,EAAA,MAAA,CAAA,cAAA,CAAI,+BAAA,CAAA,SAAJ,EAAI,YAAJ,EAAc;SAAd,YAAA;AACI,aAAO,KAAK,KAAL,CAAW,MAAX,IAAqB,KAAK,KAAL,CAAW,OAAvC;AACH,KAFa;qBAAA;;AAAA,GAAd;AAIA,EAAA,MAAA,CAAA,cAAA,CAAI,+BAAA,CAAA,SAAJ,EAAI,OAAJ,EAAS;SAAT,YAAA;AACI,UAAM,KAAK,GAAG,KAAK,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,KAAvD;;AACA,UAAI,KAAK,CAAC,cAAN,KAAyB,CAAzB,IAA8B,KAAK,CAAC,YAAN,KAAuB,CAAzD,EAA4D;AACxD,eAAO,kBAAP;AACH,OAFD,MAEO;AACH,eAAU,SAAS,CAAC,KAAK,CAAC,KAAP,CAAT,GAAsB,WAAhC;AACH;AACJ,KAPQ;qBAAA;;AAAA,GAAT;;AA4BA,EAAA,+BAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACI,QAAM,KAAK,GAAG,KAAK,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,KAAvD;AACA,QAAM,KAAK,GAAG,KAAK,CAAC,cAAN,KAAyB,CAAzB,IAA8B,KAAK,CAAC,YAAN,KAAuB,CAAnE;AAEA,QAAI,KAAK,IAAI,KAAK,KAAL,CAAW,WAAxB,EAAqC,OAAO,IAAP;AAErC,WAAO,IAAA,CAAA,SAAA,EAAA;AAAA,MAAA,QAAA,EACH,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,QAAA,SAAS,EAAC;AAAf,OAAA,EAA6B;AAAA,QAAA,QAAA,EAAA,CACzB,IAAA,CAAC,MAAD,EAAO,QAAA,CAAA;AAAC,UAAA,UAAU,EAAA,IAAX;AAAY,UAAA,OAAO,EAAE,KAAK,KAA1B;AAAiC,UAAA,KAAK,EAAC,0BAAvC;AAAkE,UAAA,QAAQ,EAAE,KAA5E;AAAmF,UAAA,YAAY,EAAE,KAAK,SAAtG;AAAiH,UAAA,YAAY,EAAE,KAAK,cAApI;AACH,UAAA,KAAK,EAAE;AAAE,YAAA,aAAa,EAAE,CAAC,KAAD,GAAS,MAAT,GAAkB,KAAK;AAAxC;AADJ,SAAA,EAC+C;AAAA,UAAA,QAAA,EACjD,KAAK;AAD4C,SAD/C,CAAP,EAEe,KAAA,CAFf,CADyB,EAKxB,CAAC,KAAD,IAAU,IAAA,CAAC,UAAD,EAAW;AAAC,UAAA,GAAG,EAAE,iBAAN;AAAyB,UAAA,OAAO,EAAE,KAAK,KAAvC;AAA8C,UAAA,KAAK,EAAC,OAApD;AAA4D,UAAA,SAAS,EAAC,kBAAtE;AAAyF,UAAA,IAAI,EAAA;AAA7F,SAAX,EAAwG,KAAA,CAAxG,CALc;AAAA,OAA7B,CAAA,EAK0H,KAAA,CAL1H;AADG,KAAA,EAOG,KAAA,CAPH,CAAP;AASH,GAfD;;AAgBJ,SAAA,+BAAA;AAAC,CAvED,CAAqD,iBAArD,CAAA;;;;AAiFA,IAAA,kBAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAiC,EAAA,SAAA,CAAA,kBAAA,EAAA,MAAA,CAAA;;AAAjC,WAAA,kBAAA,GAAA;AAAA,QAAA,KAAA,GAAA,MAAA,KAAA,IAAA,IAAA,MAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA;;AACI,IAAA,KAAA,CAAA,OAAA,GAAU,aAAa,CAAC,UAAC,KAAD,EAAgC;AAAK,aAAA,yBAAyB,CAAC,cAA1B,CAAyC,KAAI,CAAC,MAA9C,EAAA,KAAA,CAAA;AAA4D,KAAlG,CAAvB;AAGA,IAAA,KAAA,CAAA,KAAA,GAAQ;AAAE,MAAA,MAAM,EAAE,eAAe,CAAC,gBAAhB,CAAiC,KAAI,CAAC,MAAtC;AAAV,KAAR;;AAEA,IAAA,KAAA,CAAA,KAAA,GAAQ,YAAA;;;AACJ,MAAA,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,UAAzC,CAAoD,KAAI,CAAC,KAAL,CAAW,MAA/D,EAAuE,KAAI,CAAC,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,OAAzC,CAAiD,UAAxH;;AACA,OAAA,EAAA,GAAA,CAAA,EAAA,GAAA,KAAI,CAAC,KAAL,EAAW,OAAX,MAAkB,IAAlB,IAAkB,EAAA,KAAA,KAAA,CAAlB,GAAkB,KAAA,CAAlB,GAAkB,EAAA,CAAA,IAAA,CAAA,EAAA,CAAlB;AACH,KAHD;;AAKA,IAAA,KAAA,CAAA,aAAA,GAAgB,UAAC,MAAD,EAAY;AAAK,aAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,MAAM,EAAtB;AAAc,OAAd,CAAA;AAAyB,KAA1D;;;AAUH;;AAnBG,EAAA,MAAA,CAAA,cAAA,CAAI,kBAAA,CAAA,SAAJ,EAAI,QAAJ,EAAU;SAAV,YAAA;AAAe,aAAO,KAAK,OAAL,CAAa,KAAK,MAAL,CAAY,QAAZ,CAAqB,SAArB,CAA+B,SAA/B,CAAyC,cAAtD,CAAP;AAA+E,KAApF;qBAAA;;AAAA,GAAV;;AAWA,EAAA,kBAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACI,WAAO,KAAA,CAAA,SAAA,EAAA;AAAA,MAAA,QAAA,EAAA,CACH,IAAA,CAAC,iBAAD,EAAkB;AAAC,QAAA,MAAM,EAAE,KAAK,MAAd;AAAsB,QAAA,MAAM,EAAE,KAAK,KAAL,CAAW,MAAzC;AAAiD,QAAA,cAAc,EAAE,KAAK;AAAtE,OAAlB,EAAqG,KAAA,CAArG,CADG,EAEH,IAAA,CAAC,MAAD,EAAO,QAAA,CAAA;AAAC,QAAA,IAAI,EAAE,QAAP;AAAiB,QAAA,SAAS,EAAC,kCAA3B;AAA8D,QAAA,OAAO,EAAE,KAAK,KAA5E;AAAmF,QAAA,KAAK,EAAE;AAAE,UAAA,SAAS,EAAE;AAAb;AAA1F,OAAA,EAA8G;AAAA,QAAA,QAAA,EAAA;AAAA,OAA9G,CAAP,EAAqH,KAAA,CAArH,CAFG;AAAA,KAAA,EAIM,KAAA,CAJN,CAAP;AAMH,GAPD;;AAQJ,SAAA,kBAAA;AAAC,CArBD,CAAiC,qBAAjC,CAAA;;AAuBA,IAAM,uBAAuB,GAAG;AAC5B,EAAA,MAAM,EAAE,eAAe,CAAC,MAAhB,CAAqD,MAArD,EAA6D,eAAe,CAAC,cAAhB,CAA+B,CAAC,MAAD,EAAS,OAAT,EAAkB,SAAlB,CAA/B,CAA7D,CADoB;AAE5B,EAAA,WAAW,EAAE,eAAe,CAAC,IAAhB,CAAqB,EAArB,EAAyB;AAAE,IAAA,WAAW,EAAE;AAAf,GAAzB;AAFe,CAAhC;AAKA,IAAM,8BAA8B,GAAG,eAAe,CAAC,gBAAhB,CAAiC,uBAAjC,CAAvC;;AAEA,SAAS,0BAAT,CAAoC,EAApC,EAAmJ;MAA7G,QAAQ,GAAA,EAAA,CAAA,Q;MAAE,MAAM,GAAA,EAAA,CAAA,M;MAAE,KAAK,GAAA,EAAA,CAAA,K;;AACnD,MAAA,EAAA,GAAoB,KAAK,CAAC,QAAN,CAAe,8BAAf,CAApB;AAAA,MAAC,KAAK,GAAA,EAAA,CAAA,CAAA,CAAN;AAAA,MAAQ,QAAQ,GAAA,EAAA,CAAA,CAAA,CAAhB;;AAEN,MAAM,KAAK,GAAG,YAAA;AACV,QAAI,KAAK,CAAC,WAAN,CAAkB,IAAlB,GAAyB,MAAzB,KAAoC,CAAxC,EAA2C;;AAE3C,QAAI;AACA,MAAA,KAAK;AACL,UAAM,KAAK,GAAG,sBAAsB,CAAC,KAAK,CAAC,WAAP,EAAoB,KAAK,CAAC,MAA1B,CAApC;AACA,MAAA,MAAM,CAAC,QAAP,CAAgB,SAAhB,CAA0B,SAA1B,CAAoC,iBAApC,CAAsD,QAAtD,EAAgE,KAAhE,EAAuE,KAAvE;AACH,KAJD,CAIE,OAAO,CAAP,EAAU;AACR,MAAA,MAAM,CAAC,GAAP,CAAW,KAAX,CAAiB,iCAA+B,CAAhD;AACH;AACJ,GAVD;;AAYA,SAAO,KAAA,CAAA,SAAA,EAAA;AAAA,IAAA,QAAA,EAAA,CACH,IAAA,CAAC,iBAAD,EAAkB;AAAC,MAAA,MAAM,EAAE,uBAAT;AAAkC,MAAA,MAAM,EAAE,KAA1C;AAAiD,MAAA,cAAc,EAAE,QAAjE;AAA2E,MAAA,OAAO,EAAE;AAApF,KAAlB,EAA2G,KAAA,CAA3G,CADG,EAEH,KAAA,CAAC,MAAD,EAAO,QAAA,CAAA;AAAC,MAAA,SAAS,EAAC,kCAAX;AAA8C,MAAA,QAAQ,EAAE,KAAK,CAAC,WAAN,CAAkB,IAAlB,GAAyB,MAAzB,KAAoC,CAA5F;AAA+F,MAAA,OAAO,EAAE,KAAxG;AAA+G,MAAA,KAAK,EAAE;AAAE,QAAA,SAAS,EAAE;AAAb;AAAtH,KAAA,EAA0I;AAAA,MAAA,QAAA,EAAA,CAC5I,UAAU,CAAC,QAAD,CADkI,EACxH,YADwH;AAAA,KAA1I,CAAP,EACyB,KAAA,CADzB,CAFG;AAAA,GAAA,EAIM,KAAA,CAJN,CAAP;AAMH","sourceRoot":"","sourcesContent":["import { __assign, __extends, __spreadArray } from \"tslib\";\r\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\n/**\r\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\r\nimport * as React from 'react';\r\nimport { getElementQueries, getNonStandardResidueQueries, getPolymerAndBranchedEntityQueries, StructureSelectionQueries } from '../../mol-plugin-state/helpers/structure-selection-query';\r\nimport { InteractivityManager } from '../../mol-plugin-state/manager/interactivity';\r\nimport { StructureComponentManager } from '../../mol-plugin-state/manager/structure/component';\r\nimport { compileIdListSelection } from '../../mol-script/util/id-list';\r\nimport { memoizeLatest } from '../../mol-util/memoize';\r\nimport { ParamDefinition } from '../../mol-util/param-definition';\r\nimport { capitalize, stripTags } from '../../mol-util/string';\r\nimport { PluginUIComponent, PurePluginUIComponent } from '../base';\r\nimport { ActionMenu } from '../controls/action-menu';\r\nimport { Button, ControlGroup, IconButton, ToggleButton } from '../controls/common';\r\nimport { BrushSvg, CancelOutlinedSvg, CloseSvg, CubeOutlineSvg, HelpOutlineSvg, Icon, IntersectSvg, RemoveSvg, RestoreSvg, SelectionModeSvg, SetSvg, SubtractSvg, UnionSvg } from '../controls/icons';\r\nimport { ParameterControls, PureSelectControl } from '../controls/parameters';\r\nimport { HelpGroup, HelpText, ViewportHelpContent } from '../viewport/help';\r\nimport { AddComponentControls } from './components';\r\nvar ToggleSelectionModeButton = /** @class */ (function (_super) {\r\n    __extends(ToggleSelectionModeButton, _super);\r\n    function ToggleSelectionModeButton() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._toggleSelMode = function () {\r\n            _this.plugin.selectionMode = !_this.plugin.selectionMode;\r\n        };\r\n        return _this;\r\n    }\r\n    ToggleSelectionModeButton.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.events.canvas3d.settingsUpdated, function () { return _this.forceUpdate(); });\r\n        this.subscribe(this.plugin.layout.events.updated, function () { return _this.forceUpdate(); });\r\n        this.subscribe(this.plugin.behaviors.interaction.selectionMode, function () { return _this.forceUpdate(); });\r\n    };\r\n    ToggleSelectionModeButton.prototype.render = function () {\r\n        var style = this.props.inline\r\n            ? { background: 'transparent', width: 'auto', height: 'auto', lineHeight: 'unset' }\r\n            : { background: 'transparent' };\r\n        return _jsx(IconButton, { svg: SelectionModeSvg, onClick: this._toggleSelMode, title: 'Toggle Selection Mode', style: style, toggleState: this.plugin.selectionMode }, void 0);\r\n    };\r\n    return ToggleSelectionModeButton;\r\n}(PurePluginUIComponent));\r\nexport { ToggleSelectionModeButton };\r\nvar StructureSelectionParams = {\r\n    granularity: InteractivityManager.Params.granularity,\r\n};\r\nvar ActionHeader = new Map([\r\n    ['add', 'Add/Union Selection'],\r\n    ['remove', 'Remove/Subtract Selection'],\r\n    ['intersect', 'Intersect Selection'],\r\n    ['set', 'Set Selection']\r\n]);\r\nvar StructureSelectionActionsControls = /** @class */ (function (_super) {\r\n    __extends(StructureSelectionActionsControls, _super);\r\n    function StructureSelectionActionsControls() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = {\r\n            action: void 0,\r\n            helper: void 0,\r\n            isEmpty: true,\r\n            isBusy: false,\r\n            canUndo: false,\r\n        };\r\n        _this.set = function (modifier, selectionQuery) {\r\n            _this.plugin.managers.structure.selection.fromSelectionQuery(modifier, selectionQuery, false);\r\n        };\r\n        _this.selectQuery = function (item, e) {\r\n            if (!item || !_this.state.action) {\r\n                _this.setState({ action: void 0 });\r\n                return;\r\n            }\r\n            var q = _this.state.action;\r\n            if (e === null || e === void 0 ? void 0 : e.shiftKey) {\r\n                _this.set(q, item.value);\r\n            }\r\n            else {\r\n                _this.setState({ action: void 0 }, function () {\r\n                    _this.set(q, item.value);\r\n                });\r\n            }\r\n        };\r\n        _this.selectHelper = function (item, e) {\r\n            console.log(item);\r\n            if (!item || !_this.state.action) {\r\n                _this.setState({ action: void 0, helper: void 0 });\r\n                return;\r\n            }\r\n            _this.setState({ helper: item.value.kind });\r\n        };\r\n        _this.queriesItems = [];\r\n        _this.queriesVersion = -1;\r\n        _this.helpersItems = void 0;\r\n        _this.toggleAdd = _this.showAction('add');\r\n        _this.toggleRemove = _this.showAction('remove');\r\n        _this.toggleIntersect = _this.showAction('intersect');\r\n        _this.toggleSet = _this.showAction('set');\r\n        _this.toggleTheme = _this.showAction('theme');\r\n        _this.toggleAddComponent = _this.showAction('add-component');\r\n        _this.toggleHelp = _this.showAction('help');\r\n        _this.setGranuality = function (_a) {\r\n            var value = _a.value;\r\n            _this.plugin.managers.interactivity.setProps({ granularity: value });\r\n        };\r\n        _this.turnOff = function () { return _this.plugin.selectionMode = false; };\r\n        _this.undo = function () {\r\n            var task = _this.plugin.state.data.undo();\r\n            if (task)\r\n                _this.plugin.runTask(task);\r\n        };\r\n        _this.subtract = function () {\r\n            var sel = _this.plugin.managers.structure.hierarchy.getStructuresWithSelection();\r\n            var components = [];\r\n            for (var _i = 0, sel_1 = sel; _i < sel_1.length; _i++) {\r\n                var s = sel_1[_i];\r\n                components.push.apply(components, s.components);\r\n            }\r\n            if (components.length === 0)\r\n                return;\r\n            _this.plugin.managers.structure.component.modifyByCurrentSelection(components, 'subtract');\r\n        };\r\n        return _this;\r\n    }\r\n    StructureSelectionActionsControls.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function (c) {\r\n            var isEmpty = c.hierarchy.structures.length === 0;\r\n            if (_this.state.isEmpty !== isEmpty) {\r\n                _this.setState({ isEmpty: isEmpty });\r\n            }\r\n            // trigger elementQueries and nonStandardResidueQueries recalculation\r\n            _this.queriesVersion = -1;\r\n            _this.forceUpdate();\r\n        });\r\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (v) {\r\n            _this.setState({ isBusy: v, action: void 0 });\r\n        });\r\n        this.subscribe(this.plugin.managers.interactivity.events.propsUpdated, function () {\r\n            _this.forceUpdate();\r\n        });\r\n        this.subscribe(this.plugin.state.data.events.historyUpdated, function (_a) {\r\n            var state = _a.state;\r\n            _this.setState({ canUndo: state.canUndo });\r\n        });\r\n    };\r\n    Object.defineProperty(StructureSelectionActionsControls.prototype, \"isDisabled\", {\r\n        get: function () {\r\n            return this.state.isBusy || this.state.isEmpty;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(StructureSelectionActionsControls.prototype, \"structures\", {\r\n        get: function () {\r\n            var _a;\r\n            var structures = [];\r\n            for (var _i = 0, _b = this.plugin.managers.structure.hierarchy.selection.structures; _i < _b.length; _i++) {\r\n                var s = _b[_i];\r\n                var structure = (_a = s.cell.obj) === null || _a === void 0 ? void 0 : _a.data;\r\n                if (structure)\r\n                    structures.push(structure);\r\n            }\r\n            return structures;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(StructureSelectionActionsControls.prototype, \"queries\", {\r\n        get: function () {\r\n            var registry = this.plugin.query.structure.registry;\r\n            if (registry.version !== this.queriesVersion) {\r\n                var structures = this.structures;\r\n                var queries = __spreadArray(__spreadArray(__spreadArray(__spreadArray([], registry.list, true), getPolymerAndBranchedEntityQueries(structures), true), getNonStandardResidueQueries(structures), true), getElementQueries(structures), true).sort(function (a, b) { return b.priority - a.priority; });\r\n                this.queriesItems = ActionMenu.createItems(queries, {\r\n                    filter: function (q) { return q !== StructureSelectionQueries.current && !q.isHidden; },\r\n                    label: function (q) { return q.label; },\r\n                    category: function (q) { return q.category; },\r\n                    description: function (q) { return q.description; }\r\n                });\r\n                this.queriesVersion = registry.version;\r\n            }\r\n            return this.queriesItems;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(StructureSelectionActionsControls.prototype, \"helpers\", {\r\n        get: function () {\r\n            if (this.helpersItems)\r\n                return this.helpersItems;\r\n            // TODO: this is an initial implementation of the helper UI\r\n            //       the plan is to add support to input queries in different languages\r\n            //       after this has been implemented in mol-script\r\n            var helpers = [\r\n                { kind: 'residue-list', category: 'Helpers', label: 'Atom/Residue Identifier List', description: 'Create a selection from a list of atom/residue ranges.' }\r\n            ];\r\n            this.helpersItems = ActionMenu.createItems(helpers, {\r\n                label: function (q) { return q.label; },\r\n                category: function (q) { return q.category; },\r\n                description: function (q) { return q.description; }\r\n            });\r\n            return this.helpersItems;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    StructureSelectionActionsControls.prototype.showAction = function (q) {\r\n        var _this = this;\r\n        return function () { return _this.setState({ action: _this.state.action === q ? void 0 : q, helper: void 0 }); };\r\n    };\r\n    StructureSelectionActionsControls.prototype.render = function () {\r\n        var _this = this;\r\n        var granularity = this.plugin.managers.interactivity.props.granularity;\r\n        var undoTitle = this.state.canUndo\r\n            ? \"Undo \" + this.plugin.state.data.latestUndoLabel\r\n            : 'Some mistakes of the past can be undone.';\r\n        var children = void 0;\r\n        if (this.state.action && !this.state.helper) {\r\n            children = _jsxs(_Fragment, { children: [(this.state.action && this.state.action !== 'theme' && this.state.action !== 'add-component' && this.state.action !== 'help') && _jsxs(\"div\", __assign({ className: 'msp-selection-viewport-controls-actions' }, { children: [_jsx(ActionMenu, { header: ActionHeader.get(this.state.action), title: 'Click to close.', items: this.queries, onSelect: this.selectQuery, noOffset: true }, void 0), _jsx(ActionMenu, { items: this.helpers, onSelect: this.selectHelper, noOffset: true }, void 0)] }), void 0), this.state.action === 'theme' && _jsx(\"div\", __assign({ className: 'msp-selection-viewport-controls-actions' }, { children: _jsx(ControlGroup, __assign({ header: 'Theme', title: 'Click to close.', initialExpanded: true, hideExpander: true, hideOffset: true, onHeaderClick: this.toggleTheme, topRightIcon: CloseSvg }, { children: _jsx(ApplyThemeControls, { onApply: this.toggleTheme }, void 0) }), void 0) }), void 0), this.state.action === 'add-component' && _jsx(\"div\", __assign({ className: 'msp-selection-viewport-controls-actions' }, { children: _jsx(ControlGroup, __assign({ header: 'Add Component', title: 'Click to close.', initialExpanded: true, hideExpander: true, hideOffset: true, onHeaderClick: this.toggleAddComponent, topRightIcon: CloseSvg }, { children: _jsx(AddComponentControls, { onApply: this.toggleAddComponent, forSelection: true }, void 0) }), void 0) }), void 0), this.state.action === 'help' && _jsx(\"div\", __assign({ className: 'msp-selection-viewport-controls-actions' }, { children: _jsxs(ControlGroup, __assign({ header: 'Help', title: 'Click to close.', initialExpanded: true, hideExpander: true, hideOffset: true, onHeaderClick: this.toggleHelp, topRightIcon: CloseSvg, maxHeight: '300px' }, { children: [_jsx(HelpGroup, __assign({ header: 'Selection Operations' }, { children: _jsxs(HelpText, { children: [\"Use \", _jsx(Icon, { svg: UnionSvg, inline: true }, void 0), \" \", _jsx(Icon, { svg: SubtractSvg, inline: true }, void 0), \" \", _jsx(Icon, { svg: IntersectSvg, inline: true }, void 0), \" \", _jsx(Icon, { svg: SetSvg, inline: true }, void 0), \" to modify the selection.\"] }, void 0) }), void 0), _jsx(HelpGroup, __assign({ header: 'Representation Operations' }, { children: _jsxs(HelpText, { children: [\"Use \", _jsx(Icon, { svg: BrushSvg, inline: true }, void 0), \" \", _jsx(Icon, { svg: CubeOutlineSvg, inline: true }, void 0), \" \", _jsx(Icon, { svg: RemoveSvg, inline: true }, void 0), \" \", _jsx(Icon, { svg: RestoreSvg, inline: true }, void 0), \" to color, create components, remove from components, or undo actions.\"] }, void 0) }), void 0), _jsx(ViewportHelpContent, { selectOnly: true }, void 0)] }), void 0) }), void 0)] }, void 0);\r\n        }\r\n        else if (ActionHeader.has(this.state.action) && this.state.helper === 'residue-list') {\r\n            var close_1 = function () { return _this.setState({ action: void 0, helper: void 0 }); };\r\n            children = _jsx(\"div\", __assign({ className: 'msp-selection-viewport-controls-actions' }, { children: _jsx(ControlGroup, __assign({ header: 'Atom/Residue Identifier List', title: 'Click to close.', initialExpanded: true, hideExpander: true, hideOffset: true, onHeaderClick: close_1, topRightIcon: CloseSvg }, { children: _jsx(ResidueListSelectionHelper, { modifier: this.state.action, plugin: this.plugin, close: close_1 }, void 0) }), void 0) }), void 0);\r\n        }\r\n        return _jsxs(_Fragment, { children: [_jsxs(\"div\", __assign({ className: 'msp-flex-row', style: { background: 'none' } }, { children: [_jsx(PureSelectControl, { title: \"Picking Level for selecting and highlighting\", param: StructureSelectionParams.granularity, name: 'granularity', value: granularity, onChange: this.setGranuality, isDisabled: this.isDisabled }, void 0), _jsx(ToggleButton, { icon: UnionSvg, title: ActionHeader.get('add') + \". Hold shift key to keep menu open.\", toggle: this.toggleAdd, isSelected: this.state.action === 'add', disabled: this.isDisabled }, void 0), _jsx(ToggleButton, { icon: SubtractSvg, title: ActionHeader.get('remove') + \". Hold shift key to keep menu open.\", toggle: this.toggleRemove, isSelected: this.state.action === 'remove', disabled: this.isDisabled }, void 0), _jsx(ToggleButton, { icon: IntersectSvg, title: ActionHeader.get('intersect') + \". Hold shift key to keep menu open.\", toggle: this.toggleIntersect, isSelected: this.state.action === 'intersect', disabled: this.isDisabled }, void 0), _jsx(ToggleButton, { icon: SetSvg, title: ActionHeader.get('set') + \". Hold shift key to keep menu open.\", toggle: this.toggleSet, isSelected: this.state.action === 'set', disabled: this.isDisabled }, void 0), _jsx(ToggleButton, { icon: BrushSvg, title: 'Apply Theme to Selection', toggle: this.toggleTheme, isSelected: this.state.action === 'theme', disabled: this.isDisabled, style: { marginLeft: '10px' } }, void 0), _jsx(ToggleButton, { icon: CubeOutlineSvg, title: 'Create Component of Selection with Representation', toggle: this.toggleAddComponent, isSelected: this.state.action === 'add-component', disabled: this.isDisabled }, void 0), _jsx(IconButton, { svg: RemoveSvg, title: 'Remove/subtract Selection from all Components', onClick: this.subtract, disabled: this.isDisabled }, void 0), _jsx(IconButton, { svg: RestoreSvg, onClick: this.undo, disabled: !this.state.canUndo || this.isDisabled, title: undoTitle }, void 0), _jsx(ToggleButton, { icon: HelpOutlineSvg, title: 'Show/hide help', toggle: this.toggleHelp, style: { marginLeft: '10px' }, isSelected: this.state.action === 'help' }, void 0), _jsx(IconButton, { svg: CancelOutlinedSvg, title: 'Turn selection mode off', onClick: this.turnOff }, void 0)] }), void 0), children] }, void 0);\r\n    };\r\n    return StructureSelectionActionsControls;\r\n}(PluginUIComponent));\r\nexport { StructureSelectionActionsControls };\r\nvar StructureSelectionStatsControls = /** @class */ (function (_super) {\r\n    __extends(StructureSelectionStatsControls, _super);\r\n    function StructureSelectionStatsControls() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = {\r\n            isEmpty: true,\r\n            isBusy: false\r\n        };\r\n        _this.clear = function () { return _this.plugin.managers.interactivity.lociSelects.deselectAll(); };\r\n        _this.focus = function () {\r\n            if (_this.plugin.managers.structure.selection.stats.elementCount === 0)\r\n                return;\r\n            var sphere = _this.plugin.managers.structure.selection.getBoundary().sphere;\r\n            _this.plugin.managers.camera.focusSphere(sphere);\r\n        };\r\n        _this.highlight = function (e) {\r\n            _this.plugin.managers.interactivity.lociHighlights.clearHighlights();\r\n            _this.plugin.managers.structure.selection.entries.forEach(function (e) {\r\n                _this.plugin.managers.interactivity.lociHighlights.highlight({ loci: e.selection }, false);\r\n            });\r\n        };\r\n        _this.clearHighlight = function () {\r\n            _this.plugin.managers.interactivity.lociHighlights.clearHighlights();\r\n        };\r\n        return _this;\r\n    }\r\n    StructureSelectionStatsControls.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.managers.structure.selection.events.changed, function () {\r\n            _this.forceUpdate();\r\n        });\r\n        this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function (c) {\r\n            var isEmpty = c.structures.length === 0;\r\n            if (_this.state.isEmpty !== isEmpty) {\r\n                _this.setState({ isEmpty: isEmpty });\r\n            }\r\n        });\r\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (v) {\r\n            _this.setState({ isBusy: v });\r\n        });\r\n    };\r\n    Object.defineProperty(StructureSelectionStatsControls.prototype, \"isDisabled\", {\r\n        get: function () {\r\n            return this.state.isBusy || this.state.isEmpty;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(StructureSelectionStatsControls.prototype, \"stats\", {\r\n        get: function () {\r\n            var stats = this.plugin.managers.structure.selection.stats;\r\n            if (stats.structureCount === 0 || stats.elementCount === 0) {\r\n                return 'Nothing Selected';\r\n            }\r\n            else {\r\n                return stripTags(stats.label) + \" Selected\";\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    StructureSelectionStatsControls.prototype.render = function () {\r\n        var stats = this.plugin.managers.structure.selection.stats;\r\n        var empty = stats.structureCount === 0 || stats.elementCount === 0;\r\n        if (empty && this.props.hideOnEmpty)\r\n            return null;\r\n        return _jsx(_Fragment, { children: _jsxs(\"div\", __assign({ className: 'msp-flex-row' }, { children: [_jsx(Button, __assign({ noOverflow: true, onClick: this.focus, title: 'Click to Focus Selection', disabled: empty, onMouseEnter: this.highlight, onMouseLeave: this.clearHighlight, style: { textAlignLast: !empty ? 'left' : void 0 } }, { children: this.stats }), void 0), !empty && _jsx(IconButton, { svg: CancelOutlinedSvg, onClick: this.clear, title: 'Clear', className: 'msp-form-control', flex: true }, void 0)] }), void 0) }, void 0);\r\n    };\r\n    return StructureSelectionStatsControls;\r\n}(PluginUIComponent));\r\nexport { StructureSelectionStatsControls };\r\nvar ApplyThemeControls = /** @class */ (function (_super) {\r\n    __extends(ApplyThemeControls, _super);\r\n    function ApplyThemeControls() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._params = memoizeLatest(function (pivot) { return StructureComponentManager.getThemeParams(_this.plugin, pivot); });\r\n        _this.state = { values: ParamDefinition.getDefaultValues(_this.params) };\r\n        _this.apply = function () {\r\n            var _a, _b;\r\n            _this.plugin.managers.structure.component.applyTheme(_this.state.values, _this.plugin.managers.structure.hierarchy.current.structures);\r\n            (_b = (_a = _this.props).onApply) === null || _b === void 0 ? void 0 : _b.call(_a);\r\n        };\r\n        _this.paramsChanged = function (values) { return _this.setState({ values: values }); };\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ApplyThemeControls.prototype, \"params\", {\r\n        get: function () { return this._params(this.plugin.managers.structure.component.pivotStructure); },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ApplyThemeControls.prototype.render = function () {\r\n        return _jsxs(_Fragment, { children: [_jsx(ParameterControls, { params: this.params, values: this.state.values, onChangeValues: this.paramsChanged }, void 0), _jsx(Button, __assign({ icon: BrushSvg, className: 'msp-btn-commit msp-btn-commit-on', onClick: this.apply, style: { marginTop: '1px' } }, { children: \"Apply Theme\" }), void 0)] }, void 0);\r\n    };\r\n    return ApplyThemeControls;\r\n}(PurePluginUIComponent));\r\nvar ResidueListIdTypeParams = {\r\n    idType: ParamDefinition.Select('auth', ParamDefinition.arrayToOptions(['auth', 'label', 'atom-id'])),\r\n    identifiers: ParamDefinition.Text('', { description: 'A comma separated list of atom identifiers (e.g. 10, 15-25) or residue ranges in given chain (e.g. A 10-15, B 25, C 30:i)' })\r\n};\r\nvar DefaultResidueListIdTypeParams = ParamDefinition.getDefaultValues(ResidueListIdTypeParams);\r\nfunction ResidueListSelectionHelper(_a) {\r\n    var modifier = _a.modifier, plugin = _a.plugin, close = _a.close;\r\n    var _b = React.useState(DefaultResidueListIdTypeParams), state = _b[0], setState = _b[1];\r\n    var apply = function () {\r\n        if (state.identifiers.trim().length === 0)\r\n            return;\r\n        try {\r\n            close();\r\n            var query = compileIdListSelection(state.identifiers, state.idType);\r\n            plugin.managers.structure.selection.fromCompiledQuery(modifier, query, false);\r\n        }\r\n        catch (e) {\r\n            plugin.log.error(\"Failed to create selection: \" + e);\r\n        }\r\n    };\r\n    return _jsxs(_Fragment, { children: [_jsx(ParameterControls, { params: ResidueListIdTypeParams, values: state, onChangeValues: setState, onEnter: apply }, void 0), _jsxs(Button, __assign({ className: 'msp-btn-commit msp-btn-commit-on', disabled: state.identifiers.trim().length === 0, onClick: apply, style: { marginTop: '1px' } }, { children: [capitalize(modifier), \" Selection\"] }), void 0)] }, void 0);\r\n}\r\n//# sourceMappingURL=selection.js.map"]},"metadata":{},"sourceType":"module"}