{"ast":null,"code":"/**\r\n * Copyright (c) 2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\nimport { __extends } from \"tslib\";\nimport { OrderedSet } from '../../../../../mol-data/int';\nimport { BestDatabaseSequenceMapping as BestDatabaseSequenceMappingProp } from '../../../../../mol-model-props/sequence/best-database-mapping';\nimport { BestDatabaseSequenceMappingColorThemeProvider } from '../../../../../mol-model-props/sequence/themes/best-database-mapping';\nimport { StructureElement } from '../../../../../mol-model/structure';\nimport { ParamDefinition as PD } from '../../../../../mol-util/param-definition';\nimport { PluginBehavior } from '../../../behavior';\nexport var BestDatabaseSequenceMapping = PluginBehavior.create({\n  name: 'best-sequence-database-mapping-prop',\n  category: 'custom-props',\n  display: {\n    name: 'Best Database Sequence Mapping'\n  },\n  ctor:\n  /** @class */\n  function (_super) {\n    __extends(class_1, _super);\n\n    function class_1() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.provider = BestDatabaseSequenceMappingProp.Provider;\n      _this.labelProvider = {\n        label: function (loci) {\n          if (!_this.params.showTooltip) return;\n          return bestDatabaseSequenceMappingLabel(loci);\n        }\n      };\n      return _this;\n    }\n\n    class_1.prototype.update = function (p) {\n      var updated = this.params.autoAttach !== p.autoAttach || this.params.showTooltip !== p.showTooltip;\n      this.params.autoAttach = p.autoAttach;\n      this.params.showTooltip = p.showTooltip;\n      this.ctx.customStructureProperties.setDefaultAutoAttach(this.provider.descriptor.name, this.params.autoAttach);\n      return updated;\n    };\n\n    class_1.prototype.register = function () {\n      this.ctx.customModelProperties.register(this.provider, this.params.autoAttach);\n      this.ctx.representation.structure.themes.colorThemeRegistry.add(BestDatabaseSequenceMappingColorThemeProvider);\n      this.ctx.managers.lociLabels.addProvider(this.labelProvider);\n    };\n\n    class_1.prototype.unregister = function () {\n      this.ctx.customModelProperties.unregister(this.provider.descriptor.name);\n      this.ctx.representation.structure.themes.colorThemeRegistry.remove(BestDatabaseSequenceMappingColorThemeProvider);\n      this.ctx.managers.lociLabels.removeProvider(this.labelProvider);\n    };\n\n    return class_1;\n  }(PluginBehavior.Handler),\n  params: function () {\n    return {\n      autoAttach: PD.Boolean(true),\n      showTooltip: PD.Boolean(true)\n    };\n  }\n}); //\n\nfunction bestDatabaseSequenceMappingLabel(loci) {\n  if (loci.kind === 'element-loci') {\n    if (loci.elements.length === 0) return;\n    var e = loci.elements[0];\n    var u = e.unit;\n    var se = StructureElement.Location.create(loci.structure, u, u.elements[OrderedSet.getAt(e.indices, 0)]);\n    return BestDatabaseSequenceMappingProp.getLabel(se);\n  }\n}","map":{"version":3,"sources":["../../../../../../src/mol-plugin/behavior/dynamic/custom-props/sequence/best-database-mapping.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\r\nimport { __extends } from \"tslib\";\r\nimport { OrderedSet } from '../../../../../mol-data/int';\r\nimport { BestDatabaseSequenceMapping as BestDatabaseSequenceMappingProp } from '../../../../../mol-model-props/sequence/best-database-mapping';\r\nimport { BestDatabaseSequenceMappingColorThemeProvider } from '../../../../../mol-model-props/sequence/themes/best-database-mapping';\r\nimport { StructureElement } from '../../../../../mol-model/structure';\r\nimport { ParamDefinition as PD } from '../../../../../mol-util/param-definition';\r\nimport { PluginBehavior } from '../../../behavior';\r\nexport var BestDatabaseSequenceMapping = PluginBehavior.create({\r\n    name: 'best-sequence-database-mapping-prop',\r\n    category: 'custom-props',\r\n    display: { name: 'Best Database Sequence Mapping' },\r\n    ctor: /** @class */ (function (_super) {\r\n        __extends(class_1, _super);\r\n        function class_1() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.provider = BestDatabaseSequenceMappingProp.Provider;\r\n            _this.labelProvider = {\r\n                label: function (loci) {\r\n                    if (!_this.params.showTooltip)\r\n                        return;\r\n                    return bestDatabaseSequenceMappingLabel(loci);\r\n                }\r\n            };\r\n            return _this;\r\n        }\r\n        class_1.prototype.update = function (p) {\r\n            var updated = (this.params.autoAttach !== p.autoAttach ||\r\n                this.params.showTooltip !== p.showTooltip);\r\n            this.params.autoAttach = p.autoAttach;\r\n            this.params.showTooltip = p.showTooltip;\r\n            this.ctx.customStructureProperties.setDefaultAutoAttach(this.provider.descriptor.name, this.params.autoAttach);\r\n            return updated;\r\n        };\r\n        class_1.prototype.register = function () {\r\n            this.ctx.customModelProperties.register(this.provider, this.params.autoAttach);\r\n            this.ctx.representation.structure.themes.colorThemeRegistry.add(BestDatabaseSequenceMappingColorThemeProvider);\r\n            this.ctx.managers.lociLabels.addProvider(this.labelProvider);\r\n        };\r\n        class_1.prototype.unregister = function () {\r\n            this.ctx.customModelProperties.unregister(this.provider.descriptor.name);\r\n            this.ctx.representation.structure.themes.colorThemeRegistry.remove(BestDatabaseSequenceMappingColorThemeProvider);\r\n            this.ctx.managers.lociLabels.removeProvider(this.labelProvider);\r\n        };\r\n        return class_1;\r\n    }(PluginBehavior.Handler)),\r\n    params: function () { return ({\r\n        autoAttach: PD.Boolean(true),\r\n        showTooltip: PD.Boolean(true)\r\n    }); }\r\n});\r\n//\r\nfunction bestDatabaseSequenceMappingLabel(loci) {\r\n    if (loci.kind === 'element-loci') {\r\n        if (loci.elements.length === 0)\r\n            return;\r\n        var e = loci.elements[0];\r\n        var u = e.unit;\r\n        var se = StructureElement.Location.create(loci.structure, u, u.elements[OrderedSet.getAt(e.indices, 0)]);\r\n        return BestDatabaseSequenceMappingProp.getLabel(se);\r\n    }\r\n}\r\n//# sourceMappingURL=best-database-mapping.js.map"]},"metadata":{},"sourceType":"module"}