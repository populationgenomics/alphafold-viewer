{"ast":null,"code":"/**\r\n * Copyright (c) 2018-2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\nimport { __assign } from \"tslib\";\nimport { Color } from '../../mol-util/color';\nimport { StructureElement, Bond } from '../../mol-model/structure';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { getPaletteParams, getPalette } from '../../mol-util/color/palette';\nimport { ColorLists, getColorListFromName } from '../../mol-util/color/lists';\nvar DefaultList = 'dark-2';\nvar DefaultColor = Color(0xCCCCCC);\nvar Description = 'Gives every polymer chain instance a unique color based on the position (index) of the polymer in the list of polymers in the structure.';\nexport var PolymerIndexColorThemeParams = __assign({}, getPaletteParams({\n  type: 'colors',\n  colorList: DefaultList\n}));\nexport function getPolymerIndexColorThemeParams(ctx) {\n  var params = PD.clone(PolymerIndexColorThemeParams);\n\n  if (ctx.structure) {\n    if (getPolymerChainCount(ctx.structure.root) > ColorLists[DefaultList].list.length) {\n      params.palette.defaultValue.name = 'colors';\n      params.palette.defaultValue.params = __assign(__assign({}, params.palette.defaultValue.params), {\n        list: {\n          kind: 'interpolate',\n          colors: getColorListFromName(DefaultList).list\n        }\n      });\n    }\n  }\n\n  return params;\n}\n\nfunction getPolymerChainCount(structure) {\n  var polymerChainCount = 0;\n  var units = structure.units;\n\n  for (var i = 0, il = units.length; i < il; ++i) {\n    if (units[i].polymerElements.length > 0) ++polymerChainCount;\n  }\n\n  return polymerChainCount;\n}\n\nexport function PolymerIndexColorTheme(ctx, props) {\n  var color;\n  var legend;\n\n  if (ctx.structure) {\n    var palette = getPalette(getPolymerChainCount(ctx.structure.root), props);\n    legend = palette.legend;\n    var units = ctx.structure.root.units;\n    var unitIdColor_1 = new Map();\n\n    for (var i = 0, j = 0, il = units.length; i < il; ++i) {\n      if (units[i].polymerElements.length > 0) {\n        unitIdColor_1.set(units[i].id, palette.color(j));\n        ++j;\n      }\n    }\n\n    color = function (location) {\n      var color;\n\n      if (StructureElement.Location.is(location)) {\n        color = unitIdColor_1.get(location.unit.id);\n      } else if (Bond.isLocation(location)) {\n        color = unitIdColor_1.get(location.aUnit.id);\n      }\n\n      return color !== undefined ? color : DefaultColor;\n    };\n  } else {\n    color = function () {\n      return DefaultColor;\n    };\n  }\n\n  return {\n    factory: PolymerIndexColorTheme,\n    granularity: 'instance',\n    color: color,\n    props: props,\n    description: Description,\n    legend: legend\n  };\n}\nexport var PolymerIndexColorThemeProvider = {\n  name: 'polymer-index',\n  label: 'Polymer Chain Instance',\n  category: \"Chain Property\"\n  /* Chain */\n  ,\n  factory: PolymerIndexColorTheme,\n  getParams: getPolymerIndexColorThemeParams,\n  defaultValues: PD.getDefaultValues(PolymerIndexColorThemeParams),\n  isApplicable: function (ctx) {\n    return !!ctx.structure;\n  }\n};","map":{"version":3,"sources":["../../../src/mol-theme/color/polymer-index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2018-2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\r\nimport { __assign } from \"tslib\";\r\nimport { Color } from '../../mol-util/color';\r\nimport { StructureElement, Bond } from '../../mol-model/structure';\r\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\r\nimport { getPaletteParams, getPalette } from '../../mol-util/color/palette';\r\nimport { ColorLists, getColorListFromName } from '../../mol-util/color/lists';\r\nvar DefaultList = 'dark-2';\r\nvar DefaultColor = Color(0xCCCCCC);\r\nvar Description = 'Gives every polymer chain instance a unique color based on the position (index) of the polymer in the list of polymers in the structure.';\r\nexport var PolymerIndexColorThemeParams = __assign({}, getPaletteParams({ type: 'colors', colorList: DefaultList }));\r\nexport function getPolymerIndexColorThemeParams(ctx) {\r\n    var params = PD.clone(PolymerIndexColorThemeParams);\r\n    if (ctx.structure) {\r\n        if (getPolymerChainCount(ctx.structure.root) > ColorLists[DefaultList].list.length) {\r\n            params.palette.defaultValue.name = 'colors';\r\n            params.palette.defaultValue.params = __assign(__assign({}, params.palette.defaultValue.params), { list: { kind: 'interpolate', colors: getColorListFromName(DefaultList).list } });\r\n        }\r\n    }\r\n    return params;\r\n}\r\nfunction getPolymerChainCount(structure) {\r\n    var polymerChainCount = 0;\r\n    var units = structure.units;\r\n    for (var i = 0, il = units.length; i < il; ++i) {\r\n        if (units[i].polymerElements.length > 0)\r\n            ++polymerChainCount;\r\n    }\r\n    return polymerChainCount;\r\n}\r\nexport function PolymerIndexColorTheme(ctx, props) {\r\n    var color;\r\n    var legend;\r\n    if (ctx.structure) {\r\n        var palette = getPalette(getPolymerChainCount(ctx.structure.root), props);\r\n        legend = palette.legend;\r\n        var units = ctx.structure.root.units;\r\n        var unitIdColor_1 = new Map();\r\n        for (var i = 0, j = 0, il = units.length; i < il; ++i) {\r\n            if (units[i].polymerElements.length > 0) {\r\n                unitIdColor_1.set(units[i].id, palette.color(j));\r\n                ++j;\r\n            }\r\n        }\r\n        color = function (location) {\r\n            var color;\r\n            if (StructureElement.Location.is(location)) {\r\n                color = unitIdColor_1.get(location.unit.id);\r\n            }\r\n            else if (Bond.isLocation(location)) {\r\n                color = unitIdColor_1.get(location.aUnit.id);\r\n            }\r\n            return color !== undefined ? color : DefaultColor;\r\n        };\r\n    }\r\n    else {\r\n        color = function () { return DefaultColor; };\r\n    }\r\n    return {\r\n        factory: PolymerIndexColorTheme,\r\n        granularity: 'instance',\r\n        color: color,\r\n        props: props,\r\n        description: Description,\r\n        legend: legend\r\n    };\r\n}\r\nexport var PolymerIndexColorThemeProvider = {\r\n    name: 'polymer-index',\r\n    label: 'Polymer Chain Instance',\r\n    category: \"Chain Property\" /* Chain */,\r\n    factory: PolymerIndexColorTheme,\r\n    getParams: getPolymerIndexColorThemeParams,\r\n    defaultValues: PD.getDefaultValues(PolymerIndexColorThemeParams),\r\n    isApplicable: function (ctx) { return !!ctx.structure; }\r\n};\r\n//# sourceMappingURL=polymer-index.js.map"]},"metadata":{},"sourceType":"module"}