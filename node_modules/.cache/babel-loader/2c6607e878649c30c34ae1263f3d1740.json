{"ast":null,"code":"/**\r\n * Copyright (c) 2020-2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\nimport { Structure, Model } from '../mol-model/structure';\n\nvar PluginConfigItem =\n/** @class */\nfunction () {\n  function PluginConfigItem(key, defaultValue) {\n    this.key = key;\n    this.defaultValue = defaultValue;\n  }\n\n  PluginConfigItem.prototype.toString = function () {\n    return this.key;\n  };\n\n  PluginConfigItem.prototype.valueOf = function () {\n    return this.key;\n  };\n\n  return PluginConfigItem;\n}();\n\nexport { PluginConfigItem };\n\nfunction item(key, defaultValue) {\n  return new PluginConfigItem(key, defaultValue);\n} // adapted from https://stackoverflow.com/questions/9038625/detect-if-device-is-ios\n\n\nfunction is_iOS() {\n  if (typeof navigator === 'undefined' || typeof window === 'undefined') return false;\n  var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);\n  var isAppleDevice = navigator.userAgent.includes('Macintosh');\n  var isTouchScreen = navigator.maxTouchPoints >= 4; // true for iOS 13 (and hopefully beyond)\n\n  return !window.MSStream && (isIOS || isAppleDevice && isTouchScreen);\n}\n\nexport var PluginConfig = {\n  item: item,\n  General: {\n    IsBusyTimeoutMs: item('plugin-config.is-busy-timeout', 750),\n    DisableAntialiasing: item('plugin-config.disable-antialiasing', false),\n    DisablePreserveDrawingBuffer: item('plugin-config.disable-preserve-drawing-buffer', false),\n    PixelScale: item('plugin-config.pixel-scale', 1),\n    PickScale: item('plugin-config.pick-scale', 0.25),\n    PickPadding: item('plugin-config.pick-padding', 3),\n    EnableWboit: item('plugin-config.enable-wboit', true),\n    // as of Oct 1 2021, WebGL 2 doesn't work on iOS 15.\n    // TODO: check back in a few weeks to see if it was fixed\n    PreferWebGl1: item('plugin-config.prefer-webgl1', is_iOS())\n  },\n  State: {\n    DefaultServer: item('plugin-state.server', 'https://webchem.ncbr.muni.cz/molstar-state'),\n    CurrentServer: item('plugin-state.server', 'https://webchem.ncbr.muni.cz/molstar-state'),\n    HistoryCapacity: item('history-capacity.server', 5)\n  },\n  VolumeStreaming: {\n    Enabled: item('volume-streaming.enabled', true),\n    DefaultServer: item('volume-streaming.server', 'https://ds.litemol.org'),\n    CanStream: item('volume-streaming.can-stream', function (s, plugin) {\n      return s.models.length === 1 && Model.probablyHasDensityMap(s.models[0]);\n    }),\n    EmdbHeaderServer: item('volume-streaming.emdb-header-server', 'https://ftp.wwpdb.org/pub/emdb/structures')\n  },\n  Viewport: {\n    ShowExpand: item('viewer.show-expand-button', true),\n    ShowControls: item('viewer.show-controls-button', true),\n    ShowSettings: item('viewer.show-settings-button', true),\n    ShowSelectionMode: item('viewer.show-selection-model-button', true),\n    ShowAnimation: item('viewer.show-animation-button', true)\n  },\n  Download: {\n    DefaultPdbProvider: item('download.default-pdb-provider', 'pdbe'),\n    DefaultEmdbProvider: item('download.default-emdb-provider', 'pdbe')\n  },\n  Structure: {\n    SizeThresholds: item('structure.size-thresholds', Structure.DefaultSizeThresholds),\n    DefaultRepresentationPresetParams: item('structure.default-representation-preset-params', {})\n  }\n};\n\nvar PluginConfigManager =\n/** @class */\nfunction () {\n  function PluginConfigManager(initial) {\n    var _this = this;\n\n    this._config = new Map();\n    if (!initial) return;\n    initial.forEach(function (_a) {\n      var k = _a[0],\n          v = _a[1];\n      return _this._config.set(k, v);\n    });\n  }\n\n  PluginConfigManager.prototype.get = function (key) {\n    if (!this._config.has(key)) return key.defaultValue;\n    return this._config.get(key);\n  };\n\n  PluginConfigManager.prototype.set = function (key, value) {\n    this._config.set(key, value);\n  };\n\n  PluginConfigManager.prototype.delete = function (key) {\n    this._config.delete(key);\n  };\n\n  return PluginConfigManager;\n}();\n\nexport { PluginConfigManager };","map":{"version":3,"sources":["../../src/mol-plugin/config.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2020-2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\r\nimport { Structure, Model } from '../mol-model/structure';\r\nvar PluginConfigItem = /** @class */ (function () {\r\n    function PluginConfigItem(key, defaultValue) {\r\n        this.key = key;\r\n        this.defaultValue = defaultValue;\r\n    }\r\n    PluginConfigItem.prototype.toString = function () { return this.key; };\r\n    PluginConfigItem.prototype.valueOf = function () { return this.key; };\r\n    return PluginConfigItem;\r\n}());\r\nexport { PluginConfigItem };\r\nfunction item(key, defaultValue) { return new PluginConfigItem(key, defaultValue); }\r\n// adapted from https://stackoverflow.com/questions/9038625/detect-if-device-is-ios\r\nfunction is_iOS() {\r\n    if (typeof navigator === 'undefined' || typeof window === 'undefined')\r\n        return false;\r\n    var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);\r\n    var isAppleDevice = navigator.userAgent.includes('Macintosh');\r\n    var isTouchScreen = navigator.maxTouchPoints >= 4; // true for iOS 13 (and hopefully beyond)\r\n    return !window.MSStream && (isIOS || (isAppleDevice && isTouchScreen));\r\n}\r\nexport var PluginConfig = {\r\n    item: item,\r\n    General: {\r\n        IsBusyTimeoutMs: item('plugin-config.is-busy-timeout', 750),\r\n        DisableAntialiasing: item('plugin-config.disable-antialiasing', false),\r\n        DisablePreserveDrawingBuffer: item('plugin-config.disable-preserve-drawing-buffer', false),\r\n        PixelScale: item('plugin-config.pixel-scale', 1),\r\n        PickScale: item('plugin-config.pick-scale', 0.25),\r\n        PickPadding: item('plugin-config.pick-padding', 3),\r\n        EnableWboit: item('plugin-config.enable-wboit', true),\r\n        // as of Oct 1 2021, WebGL 2 doesn't work on iOS 15.\r\n        // TODO: check back in a few weeks to see if it was fixed\r\n        PreferWebGl1: item('plugin-config.prefer-webgl1', is_iOS()),\r\n    },\r\n    State: {\r\n        DefaultServer: item('plugin-state.server', 'https://webchem.ncbr.muni.cz/molstar-state'),\r\n        CurrentServer: item('plugin-state.server', 'https://webchem.ncbr.muni.cz/molstar-state'),\r\n        HistoryCapacity: item('history-capacity.server', 5)\r\n    },\r\n    VolumeStreaming: {\r\n        Enabled: item('volume-streaming.enabled', true),\r\n        DefaultServer: item('volume-streaming.server', 'https://ds.litemol.org'),\r\n        CanStream: item('volume-streaming.can-stream', function (s, plugin) {\r\n            return s.models.length === 1 && Model.probablyHasDensityMap(s.models[0]);\r\n        }),\r\n        EmdbHeaderServer: item('volume-streaming.emdb-header-server', 'https://ftp.wwpdb.org/pub/emdb/structures'),\r\n    },\r\n    Viewport: {\r\n        ShowExpand: item('viewer.show-expand-button', true),\r\n        ShowControls: item('viewer.show-controls-button', true),\r\n        ShowSettings: item('viewer.show-settings-button', true),\r\n        ShowSelectionMode: item('viewer.show-selection-model-button', true),\r\n        ShowAnimation: item('viewer.show-animation-button', true),\r\n    },\r\n    Download: {\r\n        DefaultPdbProvider: item('download.default-pdb-provider', 'pdbe'),\r\n        DefaultEmdbProvider: item('download.default-emdb-provider', 'pdbe'),\r\n    },\r\n    Structure: {\r\n        SizeThresholds: item('structure.size-thresholds', Structure.DefaultSizeThresholds),\r\n        DefaultRepresentationPresetParams: item('structure.default-representation-preset-params', {})\r\n    }\r\n};\r\nvar PluginConfigManager = /** @class */ (function () {\r\n    function PluginConfigManager(initial) {\r\n        var _this = this;\r\n        this._config = new Map();\r\n        if (!initial)\r\n            return;\r\n        initial.forEach(function (_a) {\r\n            var k = _a[0], v = _a[1];\r\n            return _this._config.set(k, v);\r\n        });\r\n    }\r\n    PluginConfigManager.prototype.get = function (key) {\r\n        if (!this._config.has(key))\r\n            return key.defaultValue;\r\n        return this._config.get(key);\r\n    };\r\n    PluginConfigManager.prototype.set = function (key, value) {\r\n        this._config.set(key, value);\r\n    };\r\n    PluginConfigManager.prototype.delete = function (key) {\r\n        this._config.delete(key);\r\n    };\r\n    return PluginConfigManager;\r\n}());\r\nexport { PluginConfigManager };\r\n//# sourceMappingURL=config.js.map"]},"metadata":{},"sourceType":"module"}