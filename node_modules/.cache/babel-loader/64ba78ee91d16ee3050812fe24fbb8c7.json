{"ast":null,"code":"/**\r\n * Copyright (c) 2018-2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\nimport { Color, ColorMap } from '../../mol-util/color';\nimport { StructureElement, Unit, Bond } from '../../mol-model/structure';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { TableLegend } from '../../mol-util/legend';\nimport { getAdjustedColorMap } from '../../mol-util/color/color'; // protein colors from Jmol http://jmol.sourceforge.net/jscolors/\n\nexport var ResidueNameColors = ColorMap({\n  // standard amino acids\n  'ALA': 0x8CFF8C,\n  'ARG': 0x00007C,\n  'ASN': 0xFF7C70,\n  'ASP': 0xA00042,\n  'CYS': 0xFFFF70,\n  'GLN': 0xFF4C4C,\n  'GLU': 0x660000,\n  'GLY': 0xEEEEEE,\n  'HIS': 0x7070FF,\n  'ILE': 0x004C00,\n  'LEU': 0x455E45,\n  'LYS': 0x4747B8,\n  'MET': 0xB8A042,\n  'PHE': 0x534C52,\n  'PRO': 0x525252,\n  'SER': 0xFF7042,\n  'THR': 0xB84C00,\n  'TRP': 0x4F4600,\n  'TYR': 0x8C704C,\n  'VAL': 0xFF8CFF,\n  // rna bases\n  'A': 0xDC143C,\n  'G': 0x32CD32,\n  'I': 0x9ACD32,\n  'C': 0xFFD700,\n  'T': 0x4169E1,\n  'U': 0x40E0D0,\n  // dna bases\n  'DA': 0xDC143C,\n  'DG': 0x32CD32,\n  'DI': 0x9ACD32,\n  'DC': 0xFFD700,\n  'DT': 0x4169E1,\n  'DU': 0x40E0D0,\n  // peptide bases\n  'APN': 0xDC143C,\n  'GPN': 0x32CD32,\n  'CPN': 0xFFD700,\n  'TPN': 0x4169E1\n});\nvar DefaultResidueNameColor = Color(0xFF00FF);\nvar Description = 'Assigns a color to every residue according to its name.';\nexport var ResidueNameColorThemeParams = {\n  saturation: PD.Numeric(0, {\n    min: -6,\n    max: 6,\n    step: 0.1\n  }),\n  lightness: PD.Numeric(1, {\n    min: -6,\n    max: 6,\n    step: 0.1\n  })\n};\nexport function getResidueNameColorThemeParams(ctx) {\n  return ResidueNameColorThemeParams; // TODO return copy\n}\n\nfunction getAtomicCompId(unit, element) {\n  return unit.model.atomicHierarchy.atoms.label_comp_id.value(element);\n}\n\nfunction getCoarseCompId(unit, element) {\n  var seqIdBegin = unit.coarseElements.seq_id_begin.value(element);\n  var seqIdEnd = unit.coarseElements.seq_id_end.value(element);\n\n  if (seqIdBegin === seqIdEnd) {\n    var entityKey = unit.coarseElements.entityKey[element];\n    var seq = unit.model.sequence.byEntityKey[entityKey].sequence;\n    return seq.compId.value(seqIdBegin - 1); // 1-indexed\n  }\n}\n\nexport function residueNameColor(colorMap, residueName) {\n  var c = colorMap[residueName];\n  return c === undefined ? DefaultResidueNameColor : c;\n}\nexport function ResidueNameColorTheme(ctx, props) {\n  var colorMap = getAdjustedColorMap(ResidueNameColors, props.saturation, props.lightness);\n\n  function color(location) {\n    if (StructureElement.Location.is(location)) {\n      if (Unit.isAtomic(location.unit)) {\n        var compId = getAtomicCompId(location.unit, location.element);\n        return residueNameColor(colorMap, compId);\n      } else {\n        var compId = getCoarseCompId(location.unit, location.element);\n        if (compId) return residueNameColor(colorMap, compId);\n      }\n    } else if (Bond.isLocation(location)) {\n      if (Unit.isAtomic(location.aUnit)) {\n        var compId = getAtomicCompId(location.aUnit, location.aUnit.elements[location.aIndex]);\n        return residueNameColor(colorMap, compId);\n      } else {\n        var compId = getCoarseCompId(location.aUnit, location.aUnit.elements[location.aIndex]);\n        if (compId) return residueNameColor(colorMap, compId);\n      }\n    }\n\n    return DefaultResidueNameColor;\n  }\n\n  return {\n    factory: ResidueNameColorTheme,\n    granularity: 'group',\n    preferSmoothing: true,\n    color: color,\n    props: props,\n    description: Description,\n    legend: TableLegend(Object.keys(ResidueNameColors).map(function (name) {\n      return [name, ResidueNameColors[name]];\n    }).concat([['Unknown', DefaultResidueNameColor]]))\n  };\n}\nexport var ResidueNameColorThemeProvider = {\n  name: 'residue-name',\n  label: 'Residue Name',\n  category: \"Residue Property\"\n  /* Residue */\n  ,\n  factory: ResidueNameColorTheme,\n  getParams: getResidueNameColorThemeParams,\n  defaultValues: PD.getDefaultValues(ResidueNameColorThemeParams),\n  isApplicable: function (ctx) {\n    return !!ctx.structure;\n  }\n};","map":{"version":3,"sources":["../../../src/mol-theme/color/residue-name.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2018-2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\r\nimport { Color, ColorMap } from '../../mol-util/color';\r\nimport { StructureElement, Unit, Bond } from '../../mol-model/structure';\r\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\r\nimport { TableLegend } from '../../mol-util/legend';\r\nimport { getAdjustedColorMap } from '../../mol-util/color/color';\r\n// protein colors from Jmol http://jmol.sourceforge.net/jscolors/\r\nexport var ResidueNameColors = ColorMap({\r\n    // standard amino acids\r\n    'ALA': 0x8CFF8C,\r\n    'ARG': 0x00007C,\r\n    'ASN': 0xFF7C70,\r\n    'ASP': 0xA00042,\r\n    'CYS': 0xFFFF70,\r\n    'GLN': 0xFF4C4C,\r\n    'GLU': 0x660000,\r\n    'GLY': 0xEEEEEE,\r\n    'HIS': 0x7070FF,\r\n    'ILE': 0x004C00,\r\n    'LEU': 0x455E45,\r\n    'LYS': 0x4747B8,\r\n    'MET': 0xB8A042,\r\n    'PHE': 0x534C52,\r\n    'PRO': 0x525252,\r\n    'SER': 0xFF7042,\r\n    'THR': 0xB84C00,\r\n    'TRP': 0x4F4600,\r\n    'TYR': 0x8C704C,\r\n    'VAL': 0xFF8CFF,\r\n    // rna bases\r\n    'A': 0xDC143C,\r\n    'G': 0x32CD32,\r\n    'I': 0x9ACD32,\r\n    'C': 0xFFD700,\r\n    'T': 0x4169E1,\r\n    'U': 0x40E0D0,\r\n    // dna bases\r\n    'DA': 0xDC143C,\r\n    'DG': 0x32CD32,\r\n    'DI': 0x9ACD32,\r\n    'DC': 0xFFD700,\r\n    'DT': 0x4169E1,\r\n    'DU': 0x40E0D0,\r\n    // peptide bases\r\n    'APN': 0xDC143C,\r\n    'GPN': 0x32CD32,\r\n    'CPN': 0xFFD700,\r\n    'TPN': 0x4169E1,\r\n});\r\nvar DefaultResidueNameColor = Color(0xFF00FF);\r\nvar Description = 'Assigns a color to every residue according to its name.';\r\nexport var ResidueNameColorThemeParams = {\r\n    saturation: PD.Numeric(0, { min: -6, max: 6, step: 0.1 }),\r\n    lightness: PD.Numeric(1, { min: -6, max: 6, step: 0.1 })\r\n};\r\nexport function getResidueNameColorThemeParams(ctx) {\r\n    return ResidueNameColorThemeParams; // TODO return copy\r\n}\r\nfunction getAtomicCompId(unit, element) {\r\n    return unit.model.atomicHierarchy.atoms.label_comp_id.value(element);\r\n}\r\nfunction getCoarseCompId(unit, element) {\r\n    var seqIdBegin = unit.coarseElements.seq_id_begin.value(element);\r\n    var seqIdEnd = unit.coarseElements.seq_id_end.value(element);\r\n    if (seqIdBegin === seqIdEnd) {\r\n        var entityKey = unit.coarseElements.entityKey[element];\r\n        var seq = unit.model.sequence.byEntityKey[entityKey].sequence;\r\n        return seq.compId.value(seqIdBegin - 1); // 1-indexed\r\n    }\r\n}\r\nexport function residueNameColor(colorMap, residueName) {\r\n    var c = colorMap[residueName];\r\n    return c === undefined ? DefaultResidueNameColor : c;\r\n}\r\nexport function ResidueNameColorTheme(ctx, props) {\r\n    var colorMap = getAdjustedColorMap(ResidueNameColors, props.saturation, props.lightness);\r\n    function color(location) {\r\n        if (StructureElement.Location.is(location)) {\r\n            if (Unit.isAtomic(location.unit)) {\r\n                var compId = getAtomicCompId(location.unit, location.element);\r\n                return residueNameColor(colorMap, compId);\r\n            }\r\n            else {\r\n                var compId = getCoarseCompId(location.unit, location.element);\r\n                if (compId)\r\n                    return residueNameColor(colorMap, compId);\r\n            }\r\n        }\r\n        else if (Bond.isLocation(location)) {\r\n            if (Unit.isAtomic(location.aUnit)) {\r\n                var compId = getAtomicCompId(location.aUnit, location.aUnit.elements[location.aIndex]);\r\n                return residueNameColor(colorMap, compId);\r\n            }\r\n            else {\r\n                var compId = getCoarseCompId(location.aUnit, location.aUnit.elements[location.aIndex]);\r\n                if (compId)\r\n                    return residueNameColor(colorMap, compId);\r\n            }\r\n        }\r\n        return DefaultResidueNameColor;\r\n    }\r\n    return {\r\n        factory: ResidueNameColorTheme,\r\n        granularity: 'group',\r\n        preferSmoothing: true,\r\n        color: color,\r\n        props: props,\r\n        description: Description,\r\n        legend: TableLegend(Object.keys(ResidueNameColors).map(function (name) {\r\n            return [name, ResidueNameColors[name]];\r\n        }).concat([['Unknown', DefaultResidueNameColor]]))\r\n    };\r\n}\r\nexport var ResidueNameColorThemeProvider = {\r\n    name: 'residue-name',\r\n    label: 'Residue Name',\r\n    category: \"Residue Property\" /* Residue */,\r\n    factory: ResidueNameColorTheme,\r\n    getParams: getResidueNameColorThemeParams,\r\n    defaultValues: PD.getDefaultValues(ResidueNameColorThemeParams),\r\n    isApplicable: function (ctx) { return !!ctx.structure; }\r\n};\r\n//# sourceMappingURL=residue-name.js.map"]},"metadata":{},"sourceType":"module"}