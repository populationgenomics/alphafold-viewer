{"ast":null,"code":"/**\r\n * Copyright (c) 2018-2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\nimport { UUID } from '../mol-util';\nexport { CustomPropertyDescriptor, CustomProperties };\n\nfunction CustomPropertyDescriptor(desc) {\n  return desc;\n}\n\n(function (CustomPropertyDescriptor) {\n  function getUUID(prop) {\n    if (!prop.__key) {\n      prop.__key = UUID.create22();\n    }\n\n    return prop.__key;\n  }\n\n  CustomPropertyDescriptor.getUUID = getUUID;\n})(CustomPropertyDescriptor || (CustomPropertyDescriptor = {}));\n\nvar CustomProperties =\n/** @class */\nfunction () {\n  function CustomProperties() {\n    this._list = [];\n    this._set = new Set();\n    this._refs = new Map();\n    this._assets = new Map();\n  }\n\n  Object.defineProperty(CustomProperties.prototype, \"all\", {\n    get: function () {\n      return this._list;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  CustomProperties.prototype.add = function (desc) {\n    if (this._set.has(desc)) return;\n\n    this._list.push(desc);\n\n    this._set.add(desc);\n  };\n\n  CustomProperties.prototype.reference = function (desc, add) {\n    var refs = this._refs.get(desc) || 0;\n    refs += add ? 1 : -1;\n\n    this._refs.set(desc, Math.max(refs, 0));\n  };\n\n  CustomProperties.prototype.hasReference = function (desc) {\n    return (this._refs.get(desc) || 0) > 0;\n  };\n\n  CustomProperties.prototype.has = function (desc) {\n    return this._set.has(desc);\n  };\n  /** Sets assets for a prop, disposes of existing assets for that prop */\n\n\n  CustomProperties.prototype.assets = function (desc, assets) {\n    var prevAssets = this._assets.get(desc);\n\n    if (prevAssets) {\n      for (var _i = 0, prevAssets_1 = prevAssets; _i < prevAssets_1.length; _i++) {\n        var a = prevAssets_1[_i];\n        a.dispose();\n      }\n    }\n\n    if (assets) this._assets.set(desc, assets);else this._assets.delete(desc);\n  };\n  /** Disposes of all assets of all props */\n\n\n  CustomProperties.prototype.dispose = function () {\n    this._assets.forEach(function (assets) {\n      for (var _i = 0, assets_1 = assets; _i < assets_1.length; _i++) {\n        var a = assets_1[_i];\n        a.dispose();\n      }\n    });\n  };\n\n  return CustomProperties;\n}();","map":{"version":3,"sources":["../../src/mol-model/custom-property.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2018-2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\r\nimport { UUID } from '../mol-util';\r\nexport { CustomPropertyDescriptor, CustomProperties };\r\nfunction CustomPropertyDescriptor(desc) {\r\n    return desc;\r\n}\r\n(function (CustomPropertyDescriptor) {\r\n    function getUUID(prop) {\r\n        if (!prop.__key) {\r\n            prop.__key = UUID.create22();\r\n        }\r\n        return prop.__key;\r\n    }\r\n    CustomPropertyDescriptor.getUUID = getUUID;\r\n})(CustomPropertyDescriptor || (CustomPropertyDescriptor = {}));\r\nvar CustomProperties = /** @class */ (function () {\r\n    function CustomProperties() {\r\n        this._list = [];\r\n        this._set = new Set();\r\n        this._refs = new Map();\r\n        this._assets = new Map();\r\n    }\r\n    Object.defineProperty(CustomProperties.prototype, \"all\", {\r\n        get: function () {\r\n            return this._list;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    CustomProperties.prototype.add = function (desc) {\r\n        if (this._set.has(desc))\r\n            return;\r\n        this._list.push(desc);\r\n        this._set.add(desc);\r\n    };\r\n    CustomProperties.prototype.reference = function (desc, add) {\r\n        var refs = this._refs.get(desc) || 0;\r\n        refs += add ? 1 : -1;\r\n        this._refs.set(desc, Math.max(refs, 0));\r\n    };\r\n    CustomProperties.prototype.hasReference = function (desc) {\r\n        return (this._refs.get(desc) || 0) > 0;\r\n    };\r\n    CustomProperties.prototype.has = function (desc) {\r\n        return this._set.has(desc);\r\n    };\r\n    /** Sets assets for a prop, disposes of existing assets for that prop */\r\n    CustomProperties.prototype.assets = function (desc, assets) {\r\n        var prevAssets = this._assets.get(desc);\r\n        if (prevAssets) {\r\n            for (var _i = 0, prevAssets_1 = prevAssets; _i < prevAssets_1.length; _i++) {\r\n                var a = prevAssets_1[_i];\r\n                a.dispose();\r\n            }\r\n        }\r\n        if (assets)\r\n            this._assets.set(desc, assets);\r\n        else\r\n            this._assets.delete(desc);\r\n    };\r\n    /** Disposes of all assets of all props */\r\n    CustomProperties.prototype.dispose = function () {\r\n        this._assets.forEach(function (assets) {\r\n            for (var _i = 0, assets_1 = assets; _i < assets_1.length; _i++) {\r\n                var a = assets_1[_i];\r\n                a.dispose();\r\n            }\r\n        });\r\n    };\r\n    return CustomProperties;\r\n}());\r\n//# sourceMappingURL=custom-property.js.map"]},"metadata":{},"sourceType":"module"}