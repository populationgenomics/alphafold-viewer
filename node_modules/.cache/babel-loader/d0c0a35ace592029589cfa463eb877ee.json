{"ast":null,"code":"/**\r\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\nimport { __extends } from \"tslib\";\nimport { shallowMergeArray } from '../mol-util/object';\nimport { RxEventHelper } from '../mol-util/rx-event-helper';\nimport { arraySetRemove } from '../mol-util/array';\n\nvar PluginComponent =\n/** @class */\nfunction () {\n  function PluginComponent() {\n    this.subs = void 0;\n  }\n\n  PluginComponent.prototype.subscribe = function (obs, action) {\n    var _this = this;\n\n    if (typeof this.subs === 'undefined') this.subs = [];\n    var sub = obs.subscribe(action);\n    this.subs.push(sub);\n    return {\n      unsubscribe: function () {\n        if (sub && _this.subs && arraySetRemove(_this.subs, sub)) {\n          sub.unsubscribe();\n          sub = void 0;\n        }\n      }\n    };\n  };\n\n  Object.defineProperty(PluginComponent.prototype, \"ev\", {\n    get: function () {\n      return this._ev || (this._ev = RxEventHelper.create());\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  PluginComponent.prototype.dispose = function () {\n    if (this._ev) this._ev.dispose();\n\n    if (this.subs) {\n      for (var _i = 0, _a = this.subs; _i < _a.length; _i++) {\n        var s = _a[_i];\n        s.unsubscribe();\n      }\n\n      this.subs = void 0;\n    }\n  };\n\n  return PluginComponent;\n}();\n\nexport { PluginComponent };\n\nvar StatefulPluginComponent =\n/** @class */\nfunction (_super) {\n  __extends(StatefulPluginComponent, _super);\n\n  function StatefulPluginComponent(initialState) {\n    var _this = _super.call(this) || this;\n\n    _this._state = initialState;\n    return _this;\n  }\n\n  StatefulPluginComponent.prototype.updateState = function () {\n    var states = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      states[_i] = arguments[_i];\n    }\n\n    var latest = this.state;\n    var s = shallowMergeArray(latest, states);\n\n    if (s !== latest) {\n      this._state = s;\n      return true;\n    }\n\n    return false;\n  };\n\n  Object.defineProperty(StatefulPluginComponent.prototype, \"state\", {\n    get: function () {\n      return this._state;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return StatefulPluginComponent;\n}(PluginComponent);\n\nexport { StatefulPluginComponent };","map":{"version":3,"sources":["../../src/mol-plugin-state/component.ts"],"names":[],"mappings":"AAAA;;;;AAIG;;AAEH,SAAS,iBAAT,QAAkC,oBAAlC;AACA,SAAS,aAAT,QAA8B,6BAA9B;AAEA,SAAS,cAAT,QAA+B,mBAA/B;;AAEA,IAAA,eAAA;AAAA;AAAA,YAAA;AAAA,WAAA,eAAA,GAAA;AAEY,SAAA,IAAA,GAAmC,KAAK,CAAxC;AA6BX;;AA3Ba,EAAA,eAAA,CAAA,SAAA,CAAA,SAAA,GAAV,UAAuB,GAAvB,EAA2C,MAA3C,EAAiE;AAAjE,QAAA,KAAA,GAAA,IAAA;;AACI,QAAI,OAAO,KAAK,IAAZ,KAAqB,WAAzB,EAAsC,KAAK,IAAL,GAAY,EAAZ;AAEtC,QAAI,GAAG,GAA6B,GAAG,CAAC,SAAJ,CAAc,MAAd,CAApC;AACA,SAAK,IAAL,CAAU,IAAV,CAAe,GAAf;AAEA,WAAO;AACH,MAAA,WAAW,EAAE,YAAA;AACT,YAAI,GAAG,IAAI,KAAI,CAAC,IAAZ,IAAoB,cAAc,CAAC,KAAI,CAAC,IAAN,EAAY,GAAZ,CAAtC,EAAwD;AACpD,UAAA,GAAG,CAAC,WAAJ;AACA,UAAA,GAAG,GAAG,KAAK,CAAX;AACH;AACJ;AANE,KAAP;AAQH,GAdS;;AAgBV,EAAA,MAAA,CAAA,cAAA,CAAc,eAAA,CAAA,SAAd,EAAc,IAAd,EAAgB;SAAhB,YAAA;AACI,aAAO,KAAK,GAAL,KAAa,KAAK,GAAL,GAAW,aAAa,CAAC,MAAd,EAAxB,CAAP;AACH,KAFe;qBAAA;;AAAA,GAAhB;;AAIA,EAAA,eAAA,CAAA,SAAA,CAAA,OAAA,GAAA,YAAA;AACI,QAAI,KAAK,GAAT,EAAc,KAAK,GAAL,CAAS,OAAT;;AACd,QAAI,KAAK,IAAT,EAAe;AACX,WAAgB,IAAA,EAAA,GAAA,CAAA,EAAA,EAAA,GAAA,KAAK,IAArB,EAAgB,EAAA,GAAA,EAAA,CAAA,MAAhB,EAAgB,EAAA,EAAhB,EAAyB;AAApB,YAAM,CAAC,GAAA,EAAA,CAAA,EAAA,CAAP;AAAsB,QAAA,CAAC,CAAC,WAAF;AAAgB;;AAC3C,WAAK,IAAL,GAAY,KAAK,CAAjB;AACH;AACJ,GAND;;AAOJ,SAAA,eAAA;AAAC,CA/BD,EAAA;;;;AAiCA,IAAA,uBAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAoD,EAAA,SAAA,CAAA,uBAAA,EAAA,MAAA,CAAA;;AAiBhD,WAAA,uBAAA,CAAY,YAAZ,EAA+B;AAA/B,QAAA,KAAA,GACI,MAAA,CAAA,IAAA,CAAA,IAAA,KAAO,IADX;;AAEI,IAAA,KAAI,CAAC,MAAL,GAAc,YAAd;;AACH;;AAjBS,EAAA,uBAAA,CAAA,SAAA,CAAA,WAAA,GAAV,YAAA;AAAsB,QAAA,MAAA,GAAA,EAAA;;SAAA,IAAA,EAAA,GAAA,C,EAAA,EAAA,GAAA,SAAA,CAAA,M,EAAA,EAAA,E,EAA2B;AAA3B,MAAA,MAAA,CAAA,EAAA,CAAA,GAAA,SAAA,CAAA,EAAA,CAAA;;;AAClB,QAAM,MAAM,GAAG,KAAK,KAApB;AACA,QAAM,CAAC,GAAG,iBAAiB,CAAC,MAAD,EAAS,MAAT,CAA3B;;AACA,QAAI,CAAC,KAAK,MAAV,EAAkB;AACd,WAAK,MAAL,GAAc,CAAd;AACA,aAAO,IAAP;AACH;;AACD,WAAO,KAAP;AACH,GARS;;AAUV,EAAA,MAAA,CAAA,cAAA,CAAI,uBAAA,CAAA,SAAJ,EAAI,OAAJ,EAAS;SAAT,YAAA;AACI,aAAO,KAAK,MAAZ;AACH,KAFQ;qBAAA;;AAAA,GAAT;AAQJ,SAAA,uBAAA;AAAC,CArBD,CAAoD,eAApD,CAAA","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\r\nimport { __extends } from \"tslib\";\r\nimport { shallowMergeArray } from '../mol-util/object';\r\nimport { RxEventHelper } from '../mol-util/rx-event-helper';\r\nimport { arraySetRemove } from '../mol-util/array';\r\nvar PluginComponent = /** @class */ (function () {\r\n    function PluginComponent() {\r\n        this.subs = void 0;\r\n    }\r\n    PluginComponent.prototype.subscribe = function (obs, action) {\r\n        var _this = this;\r\n        if (typeof this.subs === 'undefined')\r\n            this.subs = [];\r\n        var sub = obs.subscribe(action);\r\n        this.subs.push(sub);\r\n        return {\r\n            unsubscribe: function () {\r\n                if (sub && _this.subs && arraySetRemove(_this.subs, sub)) {\r\n                    sub.unsubscribe();\r\n                    sub = void 0;\r\n                }\r\n            }\r\n        };\r\n    };\r\n    Object.defineProperty(PluginComponent.prototype, \"ev\", {\r\n        get: function () {\r\n            return this._ev || (this._ev = RxEventHelper.create());\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PluginComponent.prototype.dispose = function () {\r\n        if (this._ev)\r\n            this._ev.dispose();\r\n        if (this.subs) {\r\n            for (var _i = 0, _a = this.subs; _i < _a.length; _i++) {\r\n                var s = _a[_i];\r\n                s.unsubscribe();\r\n            }\r\n            this.subs = void 0;\r\n        }\r\n    };\r\n    return PluginComponent;\r\n}());\r\nexport { PluginComponent };\r\nvar StatefulPluginComponent = /** @class */ (function (_super) {\r\n    __extends(StatefulPluginComponent, _super);\r\n    function StatefulPluginComponent(initialState) {\r\n        var _this = _super.call(this) || this;\r\n        _this._state = initialState;\r\n        return _this;\r\n    }\r\n    StatefulPluginComponent.prototype.updateState = function () {\r\n        var states = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            states[_i] = arguments[_i];\r\n        }\r\n        var latest = this.state;\r\n        var s = shallowMergeArray(latest, states);\r\n        if (s !== latest) {\r\n            this._state = s;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Object.defineProperty(StatefulPluginComponent.prototype, \"state\", {\r\n        get: function () {\r\n            return this._state;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return StatefulPluginComponent;\r\n}(PluginComponent));\r\nexport { StatefulPluginComponent };\r\n//# sourceMappingURL=component.js.map"]},"metadata":{},"sourceType":"module"}