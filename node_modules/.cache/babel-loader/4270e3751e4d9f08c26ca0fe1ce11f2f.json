{"ast":null,"code":"import { __assign, __awaiter, __extends, __generator } from \"tslib\";\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { PurePluginUIComponent } from '../base';\nimport { ParameterControls } from '../controls/parameters';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { Subject } from 'rxjs';\nimport { Icon, RefreshSvg, CheckSvg, ArrowRightSvg, ArrowDropDownSvg, TuneSvg } from '../controls/icons';\nimport { ExpandGroup, ToggleButton, Button, IconButton } from '../controls/common';\nexport { StateTransformParameters, TransformControlBase };\n\nvar StateTransformParameters =\n/** @class */\nfunction (_super) {\n  __extends(StateTransformParameters, _super);\n\n  function StateTransformParameters() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (_a) {\n      var _b;\n\n      var name = _a.name,\n          value = _a.value;\n\n      var params = __assign(__assign({}, _this.props.params), (_b = {}, _b[name] = value, _b));\n\n      _this.props.events.onChange(params, _this.areInitial(params), _this.validate(params));\n    };\n\n    return _this;\n  }\n\n  StateTransformParameters.prototype.validate = function (params) {\n    // TODO\n    return void 0;\n  };\n\n  StateTransformParameters.prototype.areInitial = function (params) {\n    return PD.areEqual(this.props.info.params, params, this.props.info.initialValues);\n  };\n\n  StateTransformParameters.prototype.render = function () {\n    return _jsx(ParameterControls, {\n      params: this.props.info.params,\n      values: this.props.params,\n      onChange: this.onChange,\n      onEnter: this.props.events.onEnter,\n      isDisabled: this.props.isDisabled\n    }, void 0);\n  };\n\n  return StateTransformParameters;\n}(PurePluginUIComponent);\n\n(function (StateTransformParameters) {\n  function areParamsEmpty(params) {\n    var keys = Object.keys(params);\n\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n      var k = keys_1[_i];\n      if (!params[k].isHidden) return false;\n    }\n\n    return true;\n  }\n\n  function infoFromAction(plugin, state, action, nodeRef) {\n    var source = state.cells.get(nodeRef).obj;\n    var params = action.definition.params ? action.definition.params(source, plugin) : {};\n    var initialValues = PD.getDefaultValues(params);\n    return {\n      initialValues: initialValues,\n      params: params,\n      isEmpty: areParamsEmpty(params)\n    };\n  }\n\n  StateTransformParameters.infoFromAction = infoFromAction;\n\n  function infoFromTransform(plugin, state, transform) {\n    var cell = state.cells.get(transform.ref); // const source: StateObjectCell | undefined = (cell.sourceRef && state.cells.get(cell.sourceRef)!) || void 0;\n    // const create = transform.transformer.definition.params;\n    // const params = create ? create((source && source.obj) as any, plugin) : { };\n\n    var params = cell.params && cell.params.definition || {};\n    var initialValues = cell.params && cell.params.values || {};\n    return {\n      initialValues: initialValues,\n      params: params,\n      isEmpty: areParamsEmpty(params)\n    };\n  }\n\n  StateTransformParameters.infoFromTransform = infoFromTransform;\n})(StateTransformParameters || (StateTransformParameters = {}));\n\nvar TransformControlBase =\n/** @class */\nfunction (_super) {\n  __extends(TransformControlBase, _super);\n\n  function TransformControlBase() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.busy = new Subject();\n\n    _this.onEnter = function () {\n      if (_this.state.error) return;\n\n      _this.apply();\n    };\n\n    _this.autoApplyHandle = void 0;\n    _this.events = {\n      onEnter: _this.onEnter,\n      onChange: function (params, isInitial, errors) {\n        _this.clearAutoApply();\n\n        _this.setState({\n          params: params,\n          isInitial: isInitial,\n          error: errors && errors[0]\n        }, function () {\n          if (!isInitial && !_this.state.error && _this.canAutoApply(params)) {\n            _this.clearAutoApply();\n\n            _this.autoApplyHandle = setTimeout(_this.apply, 50);\n          }\n        });\n      }\n    };\n\n    _this.apply = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var _a;\n\n        var _b, _c;\n\n        return __generator(this, function (_d) {\n          switch (_d.label) {\n            case 0:\n              this.clearAutoApply();\n              this.setState({\n                busy: true\n              });\n              _d.label = 1;\n\n            case 1:\n              _d.trys.push([1, 3, 4, 5]);\n\n              return [4\n              /*yield*/\n              , this.applyAction()];\n\n            case 2:\n              _d.sent();\n\n              return [3\n              /*break*/\n              , 5];\n\n            case 3:\n              _a = _d.sent();\n              return [3\n              /*break*/\n              , 5];\n\n            case 4:\n              (_c = (_b = this.props).onApply) === null || _c === void 0 ? void 0 : _c.call(_b);\n              this.busy.next(false);\n              return [7\n              /*endfinally*/\n              ];\n\n            case 5:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    _this.refresh = function () {\n      _this.setState({\n        params: _this.getInfo().initialValues,\n        isInitial: true,\n        error: void 0\n      });\n    };\n\n    _this.setDefault = function () {\n      var info = _this.getInfo();\n\n      var params = PD.getDefaultValues(info.params);\n\n      _this.setState({\n        params: params,\n        isInitial: PD.areEqual(info.params, params, info.initialValues),\n        error: void 0\n      });\n    };\n\n    _this.toggleExpanded = function () {\n      _this.setState({\n        isCollapsed: !_this.state.isCollapsed\n      });\n    };\n\n    return _this;\n  }\n\n  TransformControlBase.prototype.clearAutoApply = function () {\n    if (this.autoApplyHandle !== void 0) {\n      clearTimeout(this.autoApplyHandle);\n      this.autoApplyHandle = void 0;\n    }\n  };\n\n  TransformControlBase.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.behaviors.state.isBusy, function (b) {\n      if (_this.state.busy !== b) _this.busy.next(b);\n    });\n    this.subscribe(this.busy, function (busy) {\n      if (_this.state.busy !== busy) _this.setState({\n        busy: busy\n      });\n    });\n  };\n\n  TransformControlBase.prototype.renderApply = function () {\n    var canApply = this.canApply();\n    if (this.props.autoHideApply && (!canApply || this.canAutoApply(this.state.params))) return null;\n    return _jsxs(\"div\", __assign({\n      className: 'msp-transform-apply-wrap'\n    }, {\n      children: [_jsx(IconButton, {\n        svg: RefreshSvg,\n        className: 'msp-transform-default-params',\n        onClick: this.setDefault,\n        disabled: this.state.busy,\n        title: 'Set default params'\n      }, void 0), _jsx(\"div\", __assign({\n        className: \"msp-transform-apply-wider\"\n      }, {\n        children: _jsx(Button, __assign({\n          icon: canApply ? CheckSvg : void 0,\n          className: \"msp-btn-commit msp-btn-commit-\" + (canApply ? 'on' : 'off'),\n          onClick: this.apply,\n          disabled: !canApply\n        }, {\n          children: this.props.applyLabel || this.applyText()\n        }), void 0)\n      }), void 0)]\n    }), void 0);\n  };\n\n  TransformControlBase.prototype.renderDefault = function () {\n    var info = this.getInfo();\n    var isEmpty = info.isEmpty && this.isUpdate();\n    var display = this.getHeader();\n    var tId = this.getTransformerId();\n    var ParamEditor = this.plugin.customParamEditors.has(tId) ? this.plugin.customParamEditors.get(tId) : StateTransformParameters;\n    var wrapClass = this.state.isCollapsed ? 'msp-transform-wrapper msp-transform-wrapper-collapsed' : 'msp-transform-wrapper';\n    var params = null;\n\n    if (!isEmpty && !this.state.isCollapsed) {\n      var _a = this.getSourceAndTarget(),\n          a = _a.a,\n          b = _a.b,\n          bCell = _a.bCell;\n\n      var applyControl = this.renderApply();\n      params = _jsxs(_Fragment, {\n        children: [_jsx(ParamEditor, {\n          info: info,\n          a: a,\n          b: b,\n          bCell: bCell,\n          events: this.events,\n          params: this.state.params,\n          isDisabled: this.state.busy\n        }, void 0), applyControl]\n      }, void 0);\n    }\n\n    var ctrl = _jsxs(\"div\", __assign({\n      className: wrapClass,\n      style: {\n        marginBottom: this.props.noMargin ? 0 : void 0\n      }\n    }, {\n      children: [display !== 'none' && !this.props.wrapInExpander && _jsx(\"div\", __assign({\n        className: 'msp-transform-header'\n      }, {\n        children: _jsxs(Button, __assign({\n          onClick: this.toggleExpanded,\n          title: display.description\n        }, {\n          children: [!isEmpty && _jsx(Icon, {\n            svg: this.state.isCollapsed ? ArrowRightSvg : ArrowDropDownSvg\n          }, void 0), display.name]\n        }), void 0)\n      }), void 0), params]\n    }), void 0);\n\n    if (isEmpty || !this.props.wrapInExpander) return ctrl;\n    return _jsx(ExpandGroup, __assign({\n      header: this.isUpdate() ? \"Update \" + (display === 'none' ? '' : display.name) : \"Apply \" + (display === 'none' ? '' : display.name),\n      headerLeftMargin: this.props.expanderHeaderLeftMargin\n    }, {\n      children: ctrl\n    }), void 0);\n  };\n\n  TransformControlBase.prototype.renderSimple = function () {\n    var _a, _b, _c;\n\n    var info = this.getInfo();\n    var canApply = this.canApply();\n\n    var apply = _jsxs(\"div\", __assign({\n      className: 'msp-flex-row'\n    }, {\n      children: [_jsx(Button, __assign({\n        icon: (_a = this.props.simpleApply) === null || _a === void 0 ? void 0 : _a.icon,\n        title: (_b = this.props.simpleApply) === null || _b === void 0 ? void 0 : _b.title,\n        disabled: this.state.busy || !canApply,\n        onClick: this.apply,\n        className: 'msp-btn-apply-simple'\n      }, {\n        children: (_c = this.props.simpleApply) === null || _c === void 0 ? void 0 : _c.header\n      }), void 0), !info.isEmpty && _jsx(ToggleButton, {\n        icon: TuneSvg,\n        label: '',\n        title: 'Options',\n        toggle: this.toggleExpanded,\n        isSelected: !this.state.isCollapsed,\n        disabled: this.state.busy,\n        style: {\n          flex: '0 0 40px',\n          padding: 0\n        }\n      }, void 0)]\n    }), void 0);\n\n    if (this.state.isCollapsed) return apply;\n    var tId = this.getTransformerId();\n    var ParamEditor = this.plugin.customParamEditors.has(tId) ? this.plugin.customParamEditors.get(tId) : StateTransformParameters;\n\n    var _d = this.getSourceAndTarget(),\n        a = _d.a,\n        b = _d.b,\n        bCell = _d.bCell;\n\n    return _jsxs(_Fragment, {\n      children: [apply, _jsx(ParamEditor, {\n        info: info,\n        a: a,\n        b: b,\n        bCell: bCell,\n        events: this.events,\n        params: this.state.params,\n        isDisabled: this.state.busy\n      }, void 0)]\n    }, void 0);\n  };\n\n  TransformControlBase.prototype.render = function () {\n    // console.log('rendering', ((this.props as any)?.transform?.transformer || (this.props as any)?.action)?.definition.display.name, +new Date)\n    return this.props.simpleApply ? this.renderSimple() : this.renderDefault();\n  };\n\n  return TransformControlBase;\n}(PurePluginUIComponent);","map":{"version":3,"sources":["../../../src/mol-plugin-ui/state/common.tsx"],"names":[],"mappings":";;AAQA,SAAS,qBAAT,QAAsC,SAAtC;AACA,SAAS,iBAAT,QAAiD,wBAAjD;AAEA,SAAS,eAAe,IAAI,EAA5B,QAAsC,iCAAtC;AACA,SAAS,OAAT,QAAwB,MAAxB;AACA,SAAS,IAAT,EAAe,UAAf,EAA2B,QAA3B,EAAqC,aAArC,EAAoD,gBAApD,EAAsE,OAAtE,QAAqF,mBAArF;AACA,SAAS,WAAT,EAAsB,YAAtB,EAAoC,MAApC,EAA4C,UAA5C,QAA8D,oBAA9D;AAEA,SAAS,wBAAT,EAAmC,oBAAnC;;AAEA,IAAA,wBAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAuC,EAAA,SAAA,CAAA,wBAAA,EAAA,MAAA,CAAA;;AAAvC,WAAA,wBAAA,GAAA;AAAA,QAAA,KAAA,GAAA,MAAA,KAAA,IAAA,IAAA,MAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA;;AAUI,IAAA,KAAA,CAAA,QAAA,GAA0B,UAAC,EAAD,EAAgB;;;UAAb,IAAI,GAAA,EAAA,CAAA,I;UAAE,KAAK,GAAA,EAAA,CAAA,K;;AACpC,UAAM,MAAM,GAAA,QAAA,CAAA,QAAA,CAAA,EAAA,EAAQ,KAAI,CAAC,KAAL,CAAW,MAAnB,CAAA,GAAyB,EAAA,GAAA,EAAA,EAAA,EAAA,CAAG,IAAH,CAAA,GAAU,KAAV,EAAe,EAAxC,EAAZ;;AACA,MAAA,KAAI,CAAC,KAAL,CAAW,MAAX,CAAkB,QAAlB,CAA2B,MAA3B,EAAmC,KAAI,CAAC,UAAL,CAAgB,MAAhB,CAAnC,EAA4D,KAAI,CAAC,QAAL,CAAc,MAAd,CAA5D;AACH,KAHD;;;AAQH;;AAjBG,EAAA,wBAAA,CAAA,SAAA,CAAA,QAAA,GAAA,UAAS,MAAT,EAAoB;AAChB;AACA,WAAO,KAAK,CAAZ;AACH,GAHD;;AAKA,EAAA,wBAAA,CAAA,SAAA,CAAA,UAAA,GAAA,UAAW,MAAX,EAAsB;AAClB,WAAO,EAAE,CAAC,QAAH,CAAY,KAAK,KAAL,CAAW,IAAX,CAAgB,MAA5B,EAAoC,MAApC,EAA4C,KAAK,KAAL,CAAW,IAAX,CAAgB,aAA5D,CAAP;AACH,GAFD;;AASA,EAAA,wBAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACI,WAAO,IAAA,CAAC,iBAAD,EAAkB;AAAC,MAAA,MAAM,EAAE,KAAK,KAAL,CAAW,IAAX,CAAgB,MAAzB;AAAiC,MAAA,MAAM,EAAE,KAAK,KAAL,CAAW,MAApD;AAA4D,MAAA,QAAQ,EAAE,KAAK,QAA3E;AAAqF,MAAA,OAAO,EAAE,KAAK,KAAL,CAAW,MAAX,CAAkB,OAAhH;AAAyH,MAAA,UAAU,EAAE,KAAK,KAAL,CAAW;AAAhJ,KAAlB,EAA4K,KAAA,CAA5K,CAAP;AACH,GAFD;;AAGJ,SAAA,wBAAA;AAAC,CAlBD,CAAuC,qBAAvC,CAAA;;AAqBA,CAAA,UAAU,wBAAV,EAAkC;AAoB9B,WAAS,cAAT,CAAwB,MAAxB,EAAyC;AACrC,QAAM,IAAI,GAAG,MAAM,CAAC,IAAP,CAAY,MAAZ,CAAb;;AACA,SAAgB,IAAA,EAAA,GAAA,CAAA,EAAA,MAAA,GAAA,IAAhB,EAAgB,EAAA,GAAA,MAAA,CAAA,MAAhB,EAAgB,EAAA,EAAhB,EAAsB;AAAjB,UAAM,CAAC,GAAA,MAAA,CAAA,EAAA,CAAP;AACD,UAAI,CAAC,MAAM,CAAC,CAAD,CAAN,CAAU,QAAf,EAAyB,OAAO,KAAP;AAC5B;;AACD,WAAO,IAAP;AACH;;AAED,WAAgB,cAAhB,CAA+B,MAA/B,EAAsD,KAAtD,EAAoE,MAApE,EAAyF,OAAzF,EAAoH;AAChH,QAAM,MAAM,GAAG,KAAK,CAAC,KAAN,CAAY,GAAZ,CAAgB,OAAhB,EAA0B,GAAzC;AACA,QAAM,MAAM,GAAG,MAAM,CAAC,UAAP,CAAkB,MAAlB,GAA2B,MAAM,CAAC,UAAP,CAAkB,MAAlB,CAAyB,MAAzB,EAAiC,MAAjC,CAA3B,GAAsE,EAArF;AACA,QAAM,aAAa,GAAG,EAAE,CAAC,gBAAH,CAAoB,MAApB,CAAtB;AACA,WAAO;AACH,MAAA,aAAa,EAAA,aADV;AAEH,MAAA,MAAM,EAAA,MAFH;AAGH,MAAA,OAAO,EAAE,cAAc,CAAC,MAAD;AAHpB,KAAP;AAKH;;AATe,EAAA,wBAAA,CAAA,cAAA,GAAc,cAAd;;AAWhB,WAAgB,iBAAhB,CAAkC,MAAlC,EAAyD,KAAzD,EAAuE,SAAvE,EAAgG;AAC5F,QAAM,IAAI,GAAG,KAAK,CAAC,KAAN,CAAY,GAAZ,CAAgB,SAAS,CAAC,GAA1B,CAAb,CAD4F,CAE5F;AACA;AACA;;AACA,QAAM,MAAM,GAAI,IAAI,CAAC,MAAL,IAAe,IAAI,CAAC,MAAL,CAAY,UAA5B,IAA2C,EAA1D;AACA,QAAM,aAAa,GAAI,IAAI,CAAC,MAAL,IAAe,IAAI,CAAC,MAAL,CAAY,MAA5B,IAAuC,EAA7D;AACA,WAAO;AACH,MAAA,aAAa,EAAA,aADV;AAEH,MAAA,MAAM,EAAA,MAFH;AAGH,MAAA,OAAO,EAAE,cAAc,CAAC,MAAD;AAHpB,KAAP;AAKH;;AAZe,EAAA,wBAAA,CAAA,iBAAA,GAAiB,iBAAjB;AAanB,CApDD,EAAU,wBAAwB,KAAxB,wBAAwB,GAAA,EAAA,CAAlC;;AA2EA,IAAA,oBAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAA8F,EAAA,SAAA,CAAA,oBAAA,EAAA,MAAA,CAAA;;AAA9F,WAAA,oBAAA,GAAA;AAAA,QAAA,KAAA,GAAA,MAAA,KAAA,IAAA,IAAA,MAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA;;AAYY,IAAA,KAAA,CAAA,IAAA,GAAyB,IAAI,OAAJ,EAAzB;;AAEA,IAAA,KAAA,CAAA,OAAA,GAAU,YAAA;AACd,UAAI,KAAI,CAAC,KAAL,CAAW,KAAf,EAAsB;;AACtB,MAAA,KAAI,CAAC,KAAL;AACH,KAHO;;AAKA,IAAA,KAAA,CAAA,eAAA,GAAsC,KAAK,CAA3C;AAQR,IAAA,KAAA,CAAA,MAAA,GAAmD;AAC/C,MAAA,OAAO,EAAE,KAAI,CAAC,OADiC;AAE/C,MAAA,QAAQ,EAAE,UAAC,MAAD,EAAS,SAAT,EAAoB,MAApB,EAA0B;AAChC,QAAA,KAAI,CAAC,cAAL;;AACA,QAAA,KAAI,CAAC,QAAL,CAAc;AAAE,UAAA,MAAM,EAAA,MAAR;AAAU,UAAA,SAAS,EAAA,SAAnB;AAAqB,UAAA,KAAK,EAAE,MAAM,IAAI,MAAM,CAAC,CAAD;AAA5C,SAAd,EAAiE,YAAA;AAC7D,cAAI,CAAC,SAAD,IAAc,CAAC,KAAI,CAAC,KAAL,CAAW,KAA1B,IAAmC,KAAI,CAAC,YAAL,CAAkB,MAAlB,CAAvC,EAAkE;AAC9D,YAAA,KAAI,CAAC,cAAL;;AACA,YAAA,KAAI,CAAC,eAAL,GAAuB,UAAU,CAAC,KAAI,CAAC,KAAN,EAAa,EAAb,CAAjC;AACH;AACJ,SALD;AAMH;AAV8C,KAAnD;;AAaA,IAAA,KAAA,CAAA,KAAA,GAAQ,YAAA;AAAA,aAAA,SAAA,CAAA,KAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,YAAA;;;;;;;;AACJ,mBAAK,cAAL;AACA,mBAAK,QAAL,CAAc;AAAE,gBAAA,IAAI,EAAE;AAAR,eAAd;;;;;;AAEI,qBAAA,CAAA;AAAA;AAAA,gBAAM,KAAK,WAAL,EAAN,CAAA;;;AAAA,cAAA,EAAA,CAAA,IAAA;;;;;;;;;;;;;AAIA,eAAA,EAAA,GAAA,CAAA,EAAA,GAAA,KAAK,KAAL,EAAW,OAAX,MAAkB,IAAlB,IAAkB,EAAA,KAAA,KAAA,CAAlB,GAAkB,KAAA,CAAlB,GAAkB,EAAA,CAAA,IAAA,CAAA,EAAA,CAAlB;AACA,mBAAK,IAAL,CAAU,IAAV,CAAe,KAAf;;;;;;;;;;;OATA,CAAA;AAWP,KAXD;;AAsBA,IAAA,KAAA,CAAA,OAAA,GAAU,YAAA;AACN,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,MAAM,EAAE,KAAI,CAAC,OAAL,GAAe,aAAzB;AAAwC,QAAA,SAAS,EAAE,IAAnD;AAAyD,QAAA,KAAK,EAAE,KAAK;AAArE,OAAd;AACH,KAFD;;AAIA,IAAA,KAAA,CAAA,UAAA,GAAa,YAAA;AACT,UAAM,IAAI,GAAG,KAAI,CAAC,OAAL,EAAb;;AACA,UAAM,MAAM,GAAG,EAAE,CAAC,gBAAH,CAAoB,IAAI,CAAC,MAAzB,CAAf;;AACA,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,MAAM,EAAA,MAAR;AAAU,QAAA,SAAS,EAAE,EAAE,CAAC,QAAH,CAAY,IAAI,CAAC,MAAjB,EAAyB,MAAzB,EAAiC,IAAI,CAAC,aAAtC,CAArB;AAA2E,QAAA,KAAK,EAAE,KAAK;AAAvF,OAAd;AACH,KAJD;;AAMA,IAAA,KAAA,CAAA,cAAA,GAAiB,YAAA;AACb,MAAA,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,WAAW,EAAE,CAAC,KAAI,CAAC,KAAL,CAAW;AAA3B,OAAd;AACH,KAFD;;;AA0FH;;AA9IW,EAAA,oBAAA,CAAA,SAAA,CAAA,cAAA,GAAR,YAAA;AACI,QAAI,KAAK,eAAL,KAAyB,KAAK,CAAlC,EAAqC;AACjC,MAAA,YAAY,CAAC,KAAK,eAAN,CAAZ;AACA,WAAK,eAAL,GAAuB,KAAK,CAA5B;AACH;AACJ,GALO;;AAiCR,EAAA,oBAAA,CAAA,SAAA,CAAA,iBAAA,GAAA,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACI,SAAK,SAAL,CAAe,KAAK,MAAL,CAAY,SAAZ,CAAsB,KAAtB,CAA4B,MAA3C,EAAmD,UAAA,CAAA,EAAC;AAChD,UAAI,KAAI,CAAC,KAAL,CAAW,IAAX,KAAoB,CAAxB,EAA2B,KAAI,CAAC,IAAL,CAAU,IAAV,CAAe,CAAf;AAC9B,KAFD;AAGA,SAAK,SAAL,CAAe,KAAK,IAApB,EAA0B,UAAA,IAAA,EAAI;AAC1B,UAAI,KAAI,CAAC,KAAL,CAAW,IAAX,KAAoB,IAAxB,EAA8B,KAAI,CAAC,QAAL,CAAc;AAAE,QAAA,IAAI,EAAA;AAAN,OAAd;AACjC,KAFD;AAGH,GAPD;;AAuBA,EAAA,oBAAA,CAAA,SAAA,CAAA,WAAA,GAAA,YAAA;AACI,QAAM,QAAQ,GAAG,KAAK,QAAL,EAAjB;AAEA,QAAI,KAAK,KAAL,CAAW,aAAX,KAA6B,CAAC,QAAD,IAAa,KAAK,YAAL,CAAkB,KAAK,KAAL,CAAW,MAA7B,CAA1C,CAAJ,EAAqF,OAAO,IAAP;AAErF,WAAO,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,MAAA,SAAS,EAAC;AAAf,KAAA,EAAyC;AAAA,MAAA,QAAA,EAAA,CAC5C,IAAA,CAAC,UAAD,EAAW;AAAC,QAAA,GAAG,EAAE,UAAN;AAAkB,QAAA,SAAS,EAAC,8BAA5B;AAA2D,QAAA,OAAO,EAAE,KAAK,UAAzE;AAAqF,QAAA,QAAQ,EAAE,KAAK,KAAL,CAAW,IAA1G;AAAgH,QAAA,KAAK,EAAC;AAAtH,OAAX,EAAqJ,KAAA,CAArJ,CAD4C,EAE5C,IAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,QAAA,SAAS,EAAE;AAAhB,OAAA,EAA2C;AAAA,QAAA,QAAA,EACvC,IAAA,CAAC,MAAD,EAAO,QAAA,CAAA;AAAC,UAAA,IAAI,EAAE,QAAQ,GAAG,QAAH,GAAc,KAAK,CAAlC;AAAqC,UAAA,SAAS,EAAE,oCAAiC,QAAQ,GAAG,IAAH,GAAU,KAAnD,CAAhD;AAA4G,UAAA,OAAO,EAAE,KAAK,KAA1H;AAAiI,UAAA,QAAQ,EAAE,CAAC;AAA5I,SAAA,EAAoJ;AAAA,UAAA,QAAA,EACtJ,KAAK,KAAL,CAAW,UAAX,IAAyB,KAAK,SAAL;AAD6H,SAApJ,CAAP,EAC8C,KAAA,CAD9C;AADuC,OAA3C,CAAA,EAGa,KAAA,CAHb,CAF4C;AAAA,KAAzC,CAAA,EAMG,KAAA,CANH,CAAP;AAQH,GAbD;;AAeA,EAAA,oBAAA,CAAA,SAAA,CAAA,aAAA,GAAA,YAAA;AACI,QAAM,IAAI,GAAG,KAAK,OAAL,EAAb;AACA,QAAM,OAAO,GAAG,IAAI,CAAC,OAAL,IAAgB,KAAK,QAAL,EAAhC;AAEA,QAAM,OAAO,GAAG,KAAK,SAAL,EAAhB;AAEA,QAAM,GAAG,GAAG,KAAK,gBAAL,EAAZ;AACA,QAAM,WAAW,GAAmC,KAAK,MAAL,CAAY,kBAAZ,CAA+B,GAA/B,CAAmC,GAAnC,IAC9C,KAAK,MAAL,CAAY,kBAAZ,CAA+B,GAA/B,CAAmC,GAAnC,CAD8C,GAE9C,wBAFN;AAIA,QAAM,SAAS,GAAG,KAAK,KAAL,CAAW,WAAX,GACZ,uDADY,GAEZ,uBAFN;AAIA,QAAI,MAAM,GAAG,IAAb;;AACA,QAAI,CAAC,OAAD,IAAY,CAAC,KAAK,KAAL,CAAW,WAA5B,EAAyC;AAC/B,UAAA,EAAA,GAAkB,KAAK,kBAAL,EAAlB;AAAA,UAAE,CAAC,GAAA,EAAA,CAAA,CAAH;AAAA,UAAK,CAAC,GAAA,EAAA,CAAA,CAAN;AAAA,UAAQ,KAAK,GAAA,EAAA,CAAA,KAAb;;AACN,UAAM,YAAY,GAAG,KAAK,WAAL,EAArB;AACA,MAAA,MAAM,GAAG,KAAA,CAAA,SAAA,EAAA;AAAA,QAAA,QAAA,EAAA,CACL,IAAA,CAAC,WAAD,EAAY;AAAC,UAAA,IAAI,EAAE,IAAP;AAAa,UAAA,CAAC,EAAE,CAAhB;AAAmB,UAAA,CAAC,EAAE,CAAtB;AAAyB,UAAA,KAAK,EAAE,KAAhC;AAAuC,UAAA,MAAM,EAAE,KAAK,MAApD;AAA4D,UAAA,MAAM,EAAE,KAAK,KAAL,CAAW,MAA/E;AAAuF,UAAA,UAAU,EAAE,KAAK,KAAL,CAAW;AAA9G,SAAZ,EAA8H,KAAA,CAA9H,CADK,EAEJ,YAFI;AAAA,OAAA,EAEQ,KAAA,CAFR,CAAT;AAIH;;AAED,QAAM,IAAI,GAAG,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,MAAA,SAAS,EAAE,SAAhB;AAA2B,MAAA,KAAK,EAAE;AAAE,QAAA,YAAY,EAAE,KAAK,KAAL,CAAW,QAAX,GAAsB,CAAtB,GAA0B,KAAK;AAA/C;AAAlC,KAAA,EAAoF;AAAA,MAAA,QAAA,EAAA,CAC5F,OAAO,KAAK,MAAZ,IAAsB,CAAC,KAAK,KAAL,CAAW,cAAlC,IAAoD,IAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,QAAA,SAAS,EAAC;AAAf,OAAA,EAAqC;AAAA,QAAA,QAAA,EACtF,KAAA,CAAC,MAAD,EAAO,QAAA,CAAA;AAAC,UAAA,OAAO,EAAE,KAAK,cAAf;AAA+B,UAAA,KAAK,EAAE,OAAO,CAAC;AAA9C,SAAA,EAAyD;AAAA,UAAA,QAAA,EAAA,CAC3D,CAAC,OAAD,IAAY,IAAA,CAAC,IAAD,EAAK;AAAC,YAAA,GAAG,EAAE,KAAK,KAAL,CAAW,WAAX,GAAyB,aAAzB,GAAyC;AAA/C,WAAL,EAAoE,KAAA,CAApE,CAD+C,EAE3D,OAAO,CAAC,IAFmD;AAAA,SAAzD,CAAP,EAEiB,KAAA,CAFjB;AADsF,OAArC,CAAA,EAIxC,KAAA,CAJwC,CADwC,EAO5F,MAP4F;AAAA,KAApF,CAAA,EAOF,KAAA,CAPE,CAAb;;AAUA,QAAI,OAAO,IAAI,CAAC,KAAK,KAAL,CAAW,cAA3B,EAA2C,OAAO,IAAP;AAE3C,WAAO,IAAA,CAAC,WAAD,EAAY,QAAA,CAAA;AAAC,MAAA,MAAM,EAAE,KAAK,QAAL,KAAkB,aAAU,OAAO,KAAK,MAAZ,GAAqB,EAArB,GAA0B,OAAO,CAAC,IAA5C,CAAlB,GAAuE,YAAS,OAAO,KAAK,MAAZ,GAAqB,EAArB,GAA0B,OAAO,CAAC,IAA3C,CAAhF;AAAoI,MAAA,gBAAgB,EAAE,KAAK,KAAL,CAAW;AAAjK,KAAA,EAAyL;AAAA,MAAA,QAAA,EACvM;AADuM,KAAzL,CAAZ,EACE,KAAA,CADF,CAAP;AAGH,GAxCD;;AA0CA,EAAA,oBAAA,CAAA,SAAA,CAAA,YAAA,GAAA,YAAA;;;AACI,QAAM,IAAI,GAAG,KAAK,OAAL,EAAb;AACA,QAAM,QAAQ,GAAG,KAAK,QAAL,EAAjB;;AAEA,QAAM,KAAK,GAAG,KAAA,CAAA,KAAA,EAAA,QAAA,CAAA;AAAK,MAAA,SAAS,EAAC;AAAf,KAAA,EAA6B;AAAA,MAAA,QAAA,EAAA,CACvC,IAAA,CAAC,MAAD,EAAO,QAAA,CAAA;AAAC,QAAA,IAAI,EAAE,CAAA,EAAA,GAAA,KAAK,KAAL,CAAW,WAAX,MAAsB,IAAtB,IAAsB,EAAA,KAAA,KAAA,CAAtB,GAAsB,KAAA,CAAtB,GAAsB,EAAA,CAAE,IAA/B;AAAqC,QAAA,KAAK,EAAE,CAAA,EAAA,GAAA,KAAK,KAAL,CAAW,WAAX,MAAsB,IAAtB,IAAsB,EAAA,KAAA,KAAA,CAAtB,GAAsB,KAAA,CAAtB,GAAsB,EAAA,CAAE,KAApE;AAA2E,QAAA,QAAQ,EAAE,KAAK,KAAL,CAAW,IAAX,IAAmB,CAAC,QAAzG;AAAmH,QAAA,OAAO,EAAE,KAAK,KAAjI;AAAwI,QAAA,SAAS,EAAC;AAAlJ,OAAA,EAAwK;AAAA,QAAA,QAAA,EAC1K,CAAA,EAAA,GAAA,KAAK,KAAL,CAAW,WAAX,MAAsB,IAAtB,IAAsB,EAAA,KAAA,KAAA,CAAtB,GAAsB,KAAA,CAAtB,GAAsB,EAAA,CAAE;AADkJ,OAAxK,CAAP,EACmC,KAAA,CADnC,CADuC,EAItC,CAAC,IAAI,CAAC,OAAN,IAAiB,IAAA,CAAC,YAAD,EAAa;AAAC,QAAA,IAAI,EAAE,OAAP;AAAgB,QAAA,KAAK,EAAC,EAAtB;AAAyB,QAAA,KAAK,EAAC,SAA/B;AAAyC,QAAA,MAAM,EAAE,KAAK,cAAtD;AAAsE,QAAA,UAAU,EAAE,CAAC,KAAK,KAAL,CAAW,WAA9F;AAA2G,QAAA,QAAQ,EAAE,KAAK,KAAL,CAAW,IAAhI;AAAsI,QAAA,KAAK,EAAE;AAAE,UAAA,IAAI,EAAE,UAAR;AAAoB,UAAA,OAAO,EAAE;AAA7B;AAA7I,OAAb,EAA0L,KAAA,CAA1L,CAJqB;AAAA,KAA7B,CAAA,EAIsM,KAAA,CAJtM,CAAd;;AAOA,QAAI,KAAK,KAAL,CAAW,WAAf,EAA4B,OAAO,KAAP;AAE5B,QAAM,GAAG,GAAG,KAAK,gBAAL,EAAZ;AACA,QAAM,WAAW,GAAmC,KAAK,MAAL,CAAY,kBAAZ,CAA+B,GAA/B,CAAmC,GAAnC,IAC9C,KAAK,MAAL,CAAY,kBAAZ,CAA+B,GAA/B,CAAmC,GAAnC,CAD8C,GAE9C,wBAFN;;AAGM,QAAA,EAAA,GAAkB,KAAK,kBAAL,EAAlB;AAAA,QAAE,CAAC,GAAA,EAAA,CAAA,CAAH;AAAA,QAAK,CAAC,GAAA,EAAA,CAAA,CAAN;AAAA,QAAQ,KAAK,GAAA,EAAA,CAAA,KAAb;;AAEN,WAAO,KAAA,CAAA,SAAA,EAAA;AAAA,MAAA,QAAA,EAAA,CACF,KADE,EAEH,IAAA,CAAC,WAAD,EAAY;AAAC,QAAA,IAAI,EAAE,IAAP;AAAa,QAAA,CAAC,EAAE,CAAhB;AAAmB,QAAA,CAAC,EAAE,CAAtB;AAAyB,QAAA,KAAK,EAAE,KAAhC;AAAuC,QAAA,MAAM,EAAE,KAAK,MAApD;AAA4D,QAAA,MAAM,EAAE,KAAK,KAAL,CAAW,MAA/E;AAAuF,QAAA,UAAU,EAAE,KAAK,KAAL,CAAW;AAA9G,OAAZ,EAA8H,KAAA,CAA9H,CAFG;AAAA,KAAA,EAE+H,KAAA,CAF/H,CAAP;AAIH,GAvBD;;AAyBA,EAAA,oBAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACI;AACA,WAAO,KAAK,KAAL,CAAW,WAAX,GAAyB,KAAK,YAAL,EAAzB,GAA+C,KAAK,aAAL,EAAtD;AACH,GAHD;;AAIJ,SAAA,oBAAA;AAAC,CAlKD,CAA8F,qBAA9F,CAAA","sourceRoot":"","sourcesContent":["import { __assign, __awaiter, __extends, __generator } from \"tslib\";\r\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport { PurePluginUIComponent } from '../base';\r\nimport { ParameterControls } from '../controls/parameters';\r\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\r\nimport { Subject } from 'rxjs';\r\nimport { Icon, RefreshSvg, CheckSvg, ArrowRightSvg, ArrowDropDownSvg, TuneSvg } from '../controls/icons';\r\nimport { ExpandGroup, ToggleButton, Button, IconButton } from '../controls/common';\r\nexport { StateTransformParameters, TransformControlBase };\r\nvar StateTransformParameters = /** @class */ (function (_super) {\r\n    __extends(StateTransformParameters, _super);\r\n    function StateTransformParameters() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (_a) {\r\n            var _b;\r\n            var name = _a.name, value = _a.value;\r\n            var params = __assign(__assign({}, _this.props.params), (_b = {}, _b[name] = value, _b));\r\n            _this.props.events.onChange(params, _this.areInitial(params), _this.validate(params));\r\n        };\r\n        return _this;\r\n    }\r\n    StateTransformParameters.prototype.validate = function (params) {\r\n        // TODO\r\n        return void 0;\r\n    };\r\n    StateTransformParameters.prototype.areInitial = function (params) {\r\n        return PD.areEqual(this.props.info.params, params, this.props.info.initialValues);\r\n    };\r\n    StateTransformParameters.prototype.render = function () {\r\n        return _jsx(ParameterControls, { params: this.props.info.params, values: this.props.params, onChange: this.onChange, onEnter: this.props.events.onEnter, isDisabled: this.props.isDisabled }, void 0);\r\n    };\r\n    return StateTransformParameters;\r\n}(PurePluginUIComponent));\r\n(function (StateTransformParameters) {\r\n    function areParamsEmpty(params) {\r\n        var keys = Object.keys(params);\r\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n            var k = keys_1[_i];\r\n            if (!params[k].isHidden)\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n    function infoFromAction(plugin, state, action, nodeRef) {\r\n        var source = state.cells.get(nodeRef).obj;\r\n        var params = action.definition.params ? action.definition.params(source, plugin) : {};\r\n        var initialValues = PD.getDefaultValues(params);\r\n        return {\r\n            initialValues: initialValues,\r\n            params: params,\r\n            isEmpty: areParamsEmpty(params)\r\n        };\r\n    }\r\n    StateTransformParameters.infoFromAction = infoFromAction;\r\n    function infoFromTransform(plugin, state, transform) {\r\n        var cell = state.cells.get(transform.ref);\r\n        // const source: StateObjectCell | undefined = (cell.sourceRef && state.cells.get(cell.sourceRef)!) || void 0;\r\n        // const create = transform.transformer.definition.params;\r\n        // const params = create ? create((source && source.obj) as any, plugin) : { };\r\n        var params = (cell.params && cell.params.definition) || {};\r\n        var initialValues = (cell.params && cell.params.values) || {};\r\n        return {\r\n            initialValues: initialValues,\r\n            params: params,\r\n            isEmpty: areParamsEmpty(params)\r\n        };\r\n    }\r\n    StateTransformParameters.infoFromTransform = infoFromTransform;\r\n})(StateTransformParameters || (StateTransformParameters = {}));\r\nvar TransformControlBase = /** @class */ (function (_super) {\r\n    __extends(TransformControlBase, _super);\r\n    function TransformControlBase() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.busy = new Subject();\r\n        _this.onEnter = function () {\r\n            if (_this.state.error)\r\n                return;\r\n            _this.apply();\r\n        };\r\n        _this.autoApplyHandle = void 0;\r\n        _this.events = {\r\n            onEnter: _this.onEnter,\r\n            onChange: function (params, isInitial, errors) {\r\n                _this.clearAutoApply();\r\n                _this.setState({ params: params, isInitial: isInitial, error: errors && errors[0] }, function () {\r\n                    if (!isInitial && !_this.state.error && _this.canAutoApply(params)) {\r\n                        _this.clearAutoApply();\r\n                        _this.autoApplyHandle = setTimeout(_this.apply, 50);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        _this.apply = function () { return __awaiter(_this, void 0, void 0, function () {\r\n            var _a;\r\n            var _b, _c;\r\n            return __generator(this, function (_d) {\r\n                switch (_d.label) {\r\n                    case 0:\r\n                        this.clearAutoApply();\r\n                        this.setState({ busy: true });\r\n                        _d.label = 1;\r\n                    case 1:\r\n                        _d.trys.push([1, 3, 4, 5]);\r\n                        return [4 /*yield*/, this.applyAction()];\r\n                    case 2:\r\n                        _d.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 3:\r\n                        _a = _d.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        (_c = (_b = this.props).onApply) === null || _c === void 0 ? void 0 : _c.call(_b);\r\n                        this.busy.next(false);\r\n                        return [7 /*endfinally*/];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); };\r\n        _this.refresh = function () {\r\n            _this.setState({ params: _this.getInfo().initialValues, isInitial: true, error: void 0 });\r\n        };\r\n        _this.setDefault = function () {\r\n            var info = _this.getInfo();\r\n            var params = PD.getDefaultValues(info.params);\r\n            _this.setState({ params: params, isInitial: PD.areEqual(info.params, params, info.initialValues), error: void 0 });\r\n        };\r\n        _this.toggleExpanded = function () {\r\n            _this.setState({ isCollapsed: !_this.state.isCollapsed });\r\n        };\r\n        return _this;\r\n    }\r\n    TransformControlBase.prototype.clearAutoApply = function () {\r\n        if (this.autoApplyHandle !== void 0) {\r\n            clearTimeout(this.autoApplyHandle);\r\n            this.autoApplyHandle = void 0;\r\n        }\r\n    };\r\n    TransformControlBase.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (b) {\r\n            if (_this.state.busy !== b)\r\n                _this.busy.next(b);\r\n        });\r\n        this.subscribe(this.busy, function (busy) {\r\n            if (_this.state.busy !== busy)\r\n                _this.setState({ busy: busy });\r\n        });\r\n    };\r\n    TransformControlBase.prototype.renderApply = function () {\r\n        var canApply = this.canApply();\r\n        if (this.props.autoHideApply && (!canApply || this.canAutoApply(this.state.params)))\r\n            return null;\r\n        return _jsxs(\"div\", __assign({ className: 'msp-transform-apply-wrap' }, { children: [_jsx(IconButton, { svg: RefreshSvg, className: 'msp-transform-default-params', onClick: this.setDefault, disabled: this.state.busy, title: 'Set default params' }, void 0), _jsx(\"div\", __assign({ className: \"msp-transform-apply-wider\" }, { children: _jsx(Button, __assign({ icon: canApply ? CheckSvg : void 0, className: \"msp-btn-commit msp-btn-commit-\" + (canApply ? 'on' : 'off'), onClick: this.apply, disabled: !canApply }, { children: this.props.applyLabel || this.applyText() }), void 0) }), void 0)] }), void 0);\r\n    };\r\n    TransformControlBase.prototype.renderDefault = function () {\r\n        var info = this.getInfo();\r\n        var isEmpty = info.isEmpty && this.isUpdate();\r\n        var display = this.getHeader();\r\n        var tId = this.getTransformerId();\r\n        var ParamEditor = this.plugin.customParamEditors.has(tId)\r\n            ? this.plugin.customParamEditors.get(tId)\r\n            : StateTransformParameters;\r\n        var wrapClass = this.state.isCollapsed\r\n            ? 'msp-transform-wrapper msp-transform-wrapper-collapsed'\r\n            : 'msp-transform-wrapper';\r\n        var params = null;\r\n        if (!isEmpty && !this.state.isCollapsed) {\r\n            var _a = this.getSourceAndTarget(), a = _a.a, b = _a.b, bCell = _a.bCell;\r\n            var applyControl = this.renderApply();\r\n            params = _jsxs(_Fragment, { children: [_jsx(ParamEditor, { info: info, a: a, b: b, bCell: bCell, events: this.events, params: this.state.params, isDisabled: this.state.busy }, void 0), applyControl] }, void 0);\r\n        }\r\n        var ctrl = _jsxs(\"div\", __assign({ className: wrapClass, style: { marginBottom: this.props.noMargin ? 0 : void 0 } }, { children: [display !== 'none' && !this.props.wrapInExpander && _jsx(\"div\", __assign({ className: 'msp-transform-header' }, { children: _jsxs(Button, __assign({ onClick: this.toggleExpanded, title: display.description }, { children: [!isEmpty && _jsx(Icon, { svg: this.state.isCollapsed ? ArrowRightSvg : ArrowDropDownSvg }, void 0), display.name] }), void 0) }), void 0), params] }), void 0);\r\n        if (isEmpty || !this.props.wrapInExpander)\r\n            return ctrl;\r\n        return _jsx(ExpandGroup, __assign({ header: this.isUpdate() ? \"Update \" + (display === 'none' ? '' : display.name) : \"Apply \" + (display === 'none' ? '' : display.name), headerLeftMargin: this.props.expanderHeaderLeftMargin }, { children: ctrl }), void 0);\r\n    };\r\n    TransformControlBase.prototype.renderSimple = function () {\r\n        var _a, _b, _c;\r\n        var info = this.getInfo();\r\n        var canApply = this.canApply();\r\n        var apply = _jsxs(\"div\", __assign({ className: 'msp-flex-row' }, { children: [_jsx(Button, __assign({ icon: (_a = this.props.simpleApply) === null || _a === void 0 ? void 0 : _a.icon, title: (_b = this.props.simpleApply) === null || _b === void 0 ? void 0 : _b.title, disabled: this.state.busy || !canApply, onClick: this.apply, className: 'msp-btn-apply-simple' }, { children: (_c = this.props.simpleApply) === null || _c === void 0 ? void 0 : _c.header }), void 0), !info.isEmpty && _jsx(ToggleButton, { icon: TuneSvg, label: '', title: 'Options', toggle: this.toggleExpanded, isSelected: !this.state.isCollapsed, disabled: this.state.busy, style: { flex: '0 0 40px', padding: 0 } }, void 0)] }), void 0);\r\n        if (this.state.isCollapsed)\r\n            return apply;\r\n        var tId = this.getTransformerId();\r\n        var ParamEditor = this.plugin.customParamEditors.has(tId)\r\n            ? this.plugin.customParamEditors.get(tId)\r\n            : StateTransformParameters;\r\n        var _d = this.getSourceAndTarget(), a = _d.a, b = _d.b, bCell = _d.bCell;\r\n        return _jsxs(_Fragment, { children: [apply, _jsx(ParamEditor, { info: info, a: a, b: b, bCell: bCell, events: this.events, params: this.state.params, isDisabled: this.state.busy }, void 0)] }, void 0);\r\n    };\r\n    TransformControlBase.prototype.render = function () {\r\n        // console.log('rendering', ((this.props as any)?.transform?.transformer || (this.props as any)?.action)?.definition.display.name, +new Date)\r\n        return this.props.simpleApply ? this.renderSimple() : this.renderDefault();\r\n    };\r\n    return TransformControlBase;\r\n}(PurePluginUIComponent));\r\n//# sourceMappingURL=common.js.map"]},"metadata":{},"sourceType":"module"}