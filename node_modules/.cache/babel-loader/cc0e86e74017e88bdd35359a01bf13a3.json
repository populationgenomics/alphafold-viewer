{"ast":null,"code":"import { __assign, __awaiter, __extends, __generator } from \"tslib\";\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { UpdateTrajectory } from '../mol-plugin-state/actions/structure';\nimport { StateTransforms } from '../mol-plugin-state/transforms';\nimport { PluginCommands } from '../mol-plugin/commands';\nimport { PluginUIComponent } from './base';\nimport { IconButton } from './controls/common';\nimport { Icon, NavigateBeforeSvg, NavigateNextSvg, SkipPreviousSvg, StopSvg, PlayArrowSvg, SubscriptionsOutlinedSvg, BuildSvg } from './controls/icons';\nimport { AnimationControls } from './state/animation';\nimport { StructureComponentControls } from './structure/components';\nimport { StructureMeasurementsControls } from './structure/measurements';\nimport { StructureSelectionActionsControls } from './structure/selection';\nimport { StructureSourceControls } from './structure/source';\nimport { VolumeStreamingControls, VolumeSourceControls } from './structure/volume';\nimport { PluginConfig } from '../mol-plugin/config';\nimport { StructureSuperpositionControls } from './structure/superposition';\n\nvar TrajectoryViewportControls =\n/** @class */\nfunction (_super) {\n  __extends(TrajectoryViewportControls, _super);\n\n  function TrajectoryViewportControls() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      show: false,\n      label: ''\n    };\n\n    _this.update = function () {\n      var state = _this.plugin.state.data;\n      var models = state.selectQ(function (q) {\n        return q.ofTransformer(StateTransforms.Model.ModelFromTrajectory);\n      });\n\n      if (models.length === 0) {\n        _this.setState({\n          show: false\n        });\n\n        return;\n      }\n\n      var label = '',\n          count = 0;\n      var parents = new Set();\n\n      for (var _i = 0, models_1 = models; _i < models_1.length; _i++) {\n        var m = models_1[_i];\n        if (!m.sourceRef) continue;\n        var parent_1 = state.cells.get(m.sourceRef).obj;\n        if (!parent_1) continue;\n\n        if (parent_1.data.frameCount > 1) {\n          if (parents.has(m.sourceRef)) {\n            // do not show the controls if there are 2 models of the same trajectory present\n            _this.setState({\n              show: false\n            });\n\n            return;\n          }\n\n          parents.add(m.sourceRef);\n          count++;\n\n          if (!label) {\n            var idx = m.transform.params.modelIndex;\n            label = \"Model \" + (idx + 1) + \" / \" + parent_1.data.frameCount;\n          }\n        }\n      }\n\n      if (count > 1) label = '';\n\n      _this.setState({\n        show: count > 0,\n        label: label\n      });\n    };\n\n    _this.reset = function () {\n      return PluginCommands.State.ApplyAction(_this.plugin, {\n        state: _this.plugin.state.data,\n        action: UpdateTrajectory.create({\n          action: 'reset'\n        })\n      });\n    };\n\n    _this.prev = function () {\n      return PluginCommands.State.ApplyAction(_this.plugin, {\n        state: _this.plugin.state.data,\n        action: UpdateTrajectory.create({\n          action: 'advance',\n          by: -1\n        })\n      });\n    };\n\n    _this.next = function () {\n      return PluginCommands.State.ApplyAction(_this.plugin, {\n        state: _this.plugin.state.data,\n        action: UpdateTrajectory.create({\n          action: 'advance',\n          by: 1\n        })\n      });\n    };\n\n    return _this;\n  }\n\n  TrajectoryViewportControls.prototype.componentDidMount = function () {\n    this.subscribe(this.plugin.state.data.events.changed, this.update);\n    this.subscribe(this.plugin.behaviors.state.isAnimating, this.update);\n  };\n\n  TrajectoryViewportControls.prototype.render = function () {\n    var isAnimating = this.plugin.behaviors.state.isAnimating.value;\n    if (!this.state.show || isAnimating && !this.state.label) return null;\n    return _jsxs(\"div\", __assign({\n      className: 'msp-traj-controls'\n    }, {\n      children: [!isAnimating && _jsx(IconButton, {\n        svg: SkipPreviousSvg,\n        title: 'First Model',\n        onClick: this.reset,\n        disabled: isAnimating\n      }, void 0), !isAnimating && _jsx(IconButton, {\n        svg: NavigateBeforeSvg,\n        title: 'Previous Model',\n        onClick: this.prev,\n        disabled: isAnimating\n      }, void 0), !isAnimating && _jsx(IconButton, {\n        svg: NavigateNextSvg,\n        title: 'Next Model',\n        onClick: this.next,\n        disabled: isAnimating\n      }, void 0), !!this.state.label && _jsx(\"span\", {\n        children: this.state.label\n      }, void 0)]\n    }), void 0);\n  };\n\n  return TrajectoryViewportControls;\n}(PluginUIComponent);\n\nexport { TrajectoryViewportControls };\n\nvar StateSnapshotViewportControls =\n/** @class */\nfunction (_super) {\n  __extends(StateSnapshotViewportControls, _super);\n\n  function StateSnapshotViewportControls() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isBusy: false,\n      show: true\n    };\n\n    _this.keyUp = function (e) {\n      if (!e.ctrlKey || _this.state.isBusy || e.target !== document.body) return;\n      var snapshots = _this.plugin.managers.snapshot;\n\n      if (e.keyCode === 37 || e.key === 'ArrowLeft') {\n        if (snapshots.state.isPlaying) snapshots.stop();\n\n        _this.prev();\n      } else if (e.keyCode === 38 || e.key === 'ArrowUp') {\n        if (snapshots.state.isPlaying) snapshots.stop();\n        if (snapshots.state.entries.size === 0) return;\n        var e_1 = snapshots.state.entries.get(0);\n\n        _this.update(e_1.snapshot.id);\n      } else if (e.keyCode === 39 || e.key === 'ArrowRight') {\n        if (snapshots.state.isPlaying) snapshots.stop();\n\n        _this.next();\n      } else if (e.keyCode === 40 || e.key === 'ArrowDown') {\n        if (snapshots.state.isPlaying) snapshots.stop();\n        if (snapshots.state.entries.size === 0) return;\n        var e_2 = snapshots.state.entries.get(snapshots.state.entries.size - 1);\n\n        _this.update(e_2.snapshot.id);\n      }\n    };\n\n    _this.change = function (e) {\n      if (e.target.value === 'none') return;\n\n      _this.update(e.target.value);\n    };\n\n    _this.prev = function () {\n      var s = _this.plugin.managers.snapshot;\n      var id = s.getNextId(s.state.current, -1);\n      if (id) _this.update(id);\n    };\n\n    _this.next = function () {\n      var s = _this.plugin.managers.snapshot;\n      var id = s.getNextId(s.state.current, 1);\n      if (id) _this.update(id);\n    };\n\n    _this.togglePlay = function () {\n      _this.plugin.managers.snapshot.togglePlay();\n    };\n\n    return _this;\n  }\n\n  StateSnapshotViewportControls.prototype.componentDidMount = function () {\n    var _this = this; // TODO: this needs to be diabled when the state is updating!\n\n\n    this.subscribe(this.plugin.managers.snapshot.events.changed, function () {\n      return _this.forceUpdate();\n    });\n    this.subscribe(this.plugin.behaviors.state.isBusy, function (isBusy) {\n      return _this.setState({\n        isBusy: isBusy\n      });\n    });\n    this.subscribe(this.plugin.behaviors.state.isAnimating, function (isBusy) {\n      return _this.setState({\n        isBusy: isBusy\n      });\n    });\n    window.addEventListener('keyup', this.keyUp, false);\n  };\n\n  StateSnapshotViewportControls.prototype.componentWillUnmount = function () {\n    _super.prototype.componentWillUnmount.call(this);\n\n    window.removeEventListener('keyup', this.keyUp, false);\n  };\n\n  StateSnapshotViewportControls.prototype.update = function (id) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            this.setState({\n              isBusy: true\n            });\n            return [4\n            /*yield*/\n            , PluginCommands.State.Snapshots.Apply(this.plugin, {\n              id: id\n            })];\n\n          case 1:\n            _a.sent();\n\n            this.setState({\n              isBusy: false\n            });\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  StateSnapshotViewportControls.prototype.render = function () {\n    var snapshots = this.plugin.managers.snapshot;\n    var count = snapshots.state.entries.size;\n\n    if (count < 2 || !this.state.show) {\n      return null;\n    }\n\n    var current = snapshots.state.current;\n    var isPlaying = snapshots.state.isPlaying;\n    return _jsxs(\"div\", __assign({\n      className: 'msp-state-snapshot-viewport-controls'\n    }, {\n      children: [_jsxs(\"select\", __assign({\n        className: 'msp-form-control',\n        value: current || 'none',\n        onChange: this.change,\n        disabled: this.state.isBusy || isPlaying\n      }, {\n        children: [!current && _jsx(\"option\", {\n          value: 'none'\n        }, 'none'), snapshots.state.entries.valueSeq().map(function (e, i) {\n          return _jsxs(\"option\", __assign({\n            value: e.snapshot.id\n          }, {\n            children: [\"[\" + (i + 1) + \"/\" + count + \"]\", \" \", e.name || new Date(e.timestamp).toLocaleString()]\n          }), e.snapshot.id);\n        })]\n      }), void 0), _jsx(IconButton, {\n        svg: isPlaying ? StopSvg : PlayArrowSvg,\n        title: isPlaying ? 'Pause' : 'Cycle States',\n        onClick: this.togglePlay,\n        disabled: isPlaying ? false : this.state.isBusy\n      }, void 0), !isPlaying && _jsxs(_Fragment, {\n        children: [_jsx(IconButton, {\n          svg: NavigateBeforeSvg,\n          title: 'Previous State',\n          onClick: this.prev,\n          disabled: this.state.isBusy || isPlaying\n        }, void 0), _jsx(IconButton, {\n          svg: NavigateNextSvg,\n          title: 'Next State',\n          onClick: this.next,\n          disabled: this.state.isBusy || isPlaying\n        }, void 0)]\n      }, void 0)]\n    }), void 0);\n  };\n\n  return StateSnapshotViewportControls;\n}(PluginUIComponent);\n\nexport { StateSnapshotViewportControls };\n\nvar AnimationViewportControls =\n/** @class */\nfunction (_super) {\n  __extends(AnimationViewportControls, _super);\n\n  function AnimationViewportControls() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isEmpty: true,\n      isExpanded: false,\n      isBusy: false,\n      isAnimating: false,\n      isPlaying: false\n    };\n\n    _this.toggleExpanded = function () {\n      return _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n    };\n\n    _this.stop = function () {\n      _this.plugin.managers.animation.stop();\n\n      _this.plugin.managers.snapshot.stop();\n    };\n\n    return _this;\n  }\n\n  AnimationViewportControls.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.managers.snapshot.events.changed, function () {\n      if (_this.plugin.managers.snapshot.state.isPlaying) _this.setState({\n        isPlaying: true,\n        isExpanded: false\n      });else _this.setState({\n        isPlaying: false\n      });\n    });\n    this.subscribe(this.plugin.behaviors.state.isBusy, function (isBusy) {\n      if (isBusy) _this.setState({\n        isBusy: true,\n        isExpanded: false,\n        isEmpty: _this.plugin.state.data.tree.transforms.size < 2\n      });else _this.setState({\n        isBusy: false,\n        isEmpty: _this.plugin.state.data.tree.transforms.size < 2\n      });\n    });\n    this.subscribe(this.plugin.behaviors.state.isAnimating, function (isAnimating) {\n      if (isAnimating) _this.setState({\n        isAnimating: true,\n        isExpanded: false\n      });else _this.setState({\n        isAnimating: false\n      });\n    });\n  };\n\n  AnimationViewportControls.prototype.render = function () {\n    var isPlaying = this.plugin.managers.snapshot.state.isPlaying;\n    if (isPlaying || this.state.isEmpty || this.plugin.managers.animation.isEmpty || !this.plugin.config.get(PluginConfig.Viewport.ShowAnimation)) return null;\n    var isAnimating = this.state.isAnimating;\n    return _jsxs(\"div\", __assign({\n      className: 'msp-animation-viewport-controls'\n    }, {\n      children: [_jsxs(\"div\", {\n        children: [_jsx(\"div\", {\n          className: 'msp-semi-transparent-background'\n        }, void 0), _jsx(IconButton, {\n          svg: isAnimating || isPlaying ? StopSvg : SubscriptionsOutlinedSvg,\n          transparent: true,\n          title: isAnimating ? 'Stop' : 'Select Animation',\n          onClick: isAnimating || isPlaying ? this.stop : this.toggleExpanded,\n          toggleState: this.state.isExpanded,\n          disabled: isAnimating || isPlaying ? false : this.state.isBusy || this.state.isPlaying || this.state.isEmpty\n        }, void 0)]\n      }, void 0), this.state.isExpanded && !this.state.isBusy && _jsx(\"div\", __assign({\n        className: 'msp-animation-viewport-controls-select'\n      }, {\n        children: _jsx(AnimationControls, {\n          onStart: this.toggleExpanded\n        }, void 0)\n      }), void 0)]\n    }), void 0);\n  };\n\n  return AnimationViewportControls;\n}(PluginUIComponent);\n\nexport { AnimationViewportControls };\n\nvar SelectionViewportControls =\n/** @class */\nfunction (_super) {\n  __extends(SelectionViewportControls, _super);\n\n  function SelectionViewportControls() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onMouseMove = function (e) {\n      // ignore mouse moves when no button is held\n      if (e.buttons === 0) e.stopPropagation();\n    };\n\n    return _this;\n  }\n\n  SelectionViewportControls.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.behaviors.interaction.selectionMode, function () {\n      return _this.forceUpdate();\n    });\n  };\n\n  SelectionViewportControls.prototype.render = function () {\n    if (!this.plugin.selectionMode) return null;\n    return _jsx(\"div\", __assign({\n      className: 'msp-selection-viewport-controls',\n      onMouseMove: this.onMouseMove\n    }, {\n      children: _jsx(StructureSelectionActionsControls, {}, void 0)\n    }), void 0);\n  };\n\n  return SelectionViewportControls;\n}(PluginUIComponent);\n\nexport { SelectionViewportControls };\n\nvar LociLabels =\n/** @class */\nfunction (_super) {\n  __extends(LociLabels, _super);\n\n  function LociLabels() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      labels: []\n    };\n    return _this;\n  }\n\n  LociLabels.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.behaviors.labels.highlight, function (e) {\n      return _this.setState({\n        labels: e.labels\n      });\n    });\n  };\n\n  LociLabels.prototype.render = function () {\n    if (this.state.labels.length === 0) {\n      return null;\n    }\n\n    return _jsx(\"div\", __assign({\n      className: 'msp-highlight-info'\n    }, {\n      children: this.state.labels.map(function (e, i) {\n        return _jsx(\"div\", {\n          dangerouslySetInnerHTML: {\n            __html: e\n          }\n        }, '' + i);\n      })\n    }), void 0);\n  };\n\n  return LociLabels;\n}(PluginUIComponent);\n\nexport { LociLabels };\n\nvar CustomStructureControls =\n/** @class */\nfunction (_super) {\n  __extends(CustomStructureControls, _super);\n\n  function CustomStructureControls() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  CustomStructureControls.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.state.behaviors.events.changed, function () {\n      return _this.forceUpdate();\n    });\n  };\n\n  CustomStructureControls.prototype.render = function () {\n    var _this = this;\n\n    var controls = [];\n    this.plugin.customStructureControls.forEach(function (Controls, key) {\n      controls.push(_jsx(Controls, {\n        initiallyCollapsed: _this.props.initiallyCollapsed\n      }, key));\n    });\n    return controls.length > 0 ? _jsx(_Fragment, {\n      children: controls\n    }, void 0) : null;\n  };\n\n  return CustomStructureControls;\n}(PluginUIComponent);\n\nexport { CustomStructureControls };\n\nvar DefaultStructureTools =\n/** @class */\nfunction (_super) {\n  __extends(DefaultStructureTools, _super);\n\n  function DefaultStructureTools() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DefaultStructureTools.prototype.render = function () {\n    return _jsxs(_Fragment, {\n      children: [_jsxs(\"div\", __assign({\n        className: 'msp-section-header'\n      }, {\n        children: [_jsx(Icon, {\n          svg: BuildSvg\n        }, void 0), \"Structure Tools\"]\n      }), void 0), _jsx(StructureSourceControls, {}, void 0), _jsx(StructureMeasurementsControls, {}, void 0), _jsx(StructureSuperpositionControls, {}, void 0), _jsx(StructureComponentControls, {}, void 0), this.plugin.config.get(PluginConfig.VolumeStreaming.Enabled) && _jsx(VolumeStreamingControls, {}, void 0), _jsx(VolumeSourceControls, {}, void 0), _jsx(CustomStructureControls, {}, void 0)]\n    }, void 0);\n  };\n\n  return DefaultStructureTools;\n}(PluginUIComponent);\n\nexport { DefaultStructureTools };","map":{"version":3,"sources":["../../src/mol-plugin-ui/controls.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __awaiter, __extends, __generator } from \"tslib\";\r\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport { UpdateTrajectory } from '../mol-plugin-state/actions/structure';\r\nimport { StateTransforms } from '../mol-plugin-state/transforms';\r\nimport { PluginCommands } from '../mol-plugin/commands';\r\nimport { PluginUIComponent } from './base';\r\nimport { IconButton } from './controls/common';\r\nimport { Icon, NavigateBeforeSvg, NavigateNextSvg, SkipPreviousSvg, StopSvg, PlayArrowSvg, SubscriptionsOutlinedSvg, BuildSvg } from './controls/icons';\r\nimport { AnimationControls } from './state/animation';\r\nimport { StructureComponentControls } from './structure/components';\r\nimport { StructureMeasurementsControls } from './structure/measurements';\r\nimport { StructureSelectionActionsControls } from './structure/selection';\r\nimport { StructureSourceControls } from './structure/source';\r\nimport { VolumeStreamingControls, VolumeSourceControls } from './structure/volume';\r\nimport { PluginConfig } from '../mol-plugin/config';\r\nimport { StructureSuperpositionControls } from './structure/superposition';\r\nvar TrajectoryViewportControls = /** @class */ (function (_super) {\r\n    __extends(TrajectoryViewportControls, _super);\r\n    function TrajectoryViewportControls() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { show: false, label: '' };\r\n        _this.update = function () {\r\n            var state = _this.plugin.state.data;\r\n            var models = state.selectQ(function (q) { return q.ofTransformer(StateTransforms.Model.ModelFromTrajectory); });\r\n            if (models.length === 0) {\r\n                _this.setState({ show: false });\r\n                return;\r\n            }\r\n            var label = '', count = 0;\r\n            var parents = new Set();\r\n            for (var _i = 0, models_1 = models; _i < models_1.length; _i++) {\r\n                var m = models_1[_i];\r\n                if (!m.sourceRef)\r\n                    continue;\r\n                var parent_1 = state.cells.get(m.sourceRef).obj;\r\n                if (!parent_1)\r\n                    continue;\r\n                if (parent_1.data.frameCount > 1) {\r\n                    if (parents.has(m.sourceRef)) {\r\n                        // do not show the controls if there are 2 models of the same trajectory present\r\n                        _this.setState({ show: false });\r\n                        return;\r\n                    }\r\n                    parents.add(m.sourceRef);\r\n                    count++;\r\n                    if (!label) {\r\n                        var idx = m.transform.params.modelIndex;\r\n                        label = \"Model \" + (idx + 1) + \" / \" + parent_1.data.frameCount;\r\n                    }\r\n                }\r\n            }\r\n            if (count > 1)\r\n                label = '';\r\n            _this.setState({ show: count > 0, label: label });\r\n        };\r\n        _this.reset = function () { return PluginCommands.State.ApplyAction(_this.plugin, {\r\n            state: _this.plugin.state.data,\r\n            action: UpdateTrajectory.create({ action: 'reset' })\r\n        }); };\r\n        _this.prev = function () { return PluginCommands.State.ApplyAction(_this.plugin, {\r\n            state: _this.plugin.state.data,\r\n            action: UpdateTrajectory.create({ action: 'advance', by: -1 })\r\n        }); };\r\n        _this.next = function () { return PluginCommands.State.ApplyAction(_this.plugin, {\r\n            state: _this.plugin.state.data,\r\n            action: UpdateTrajectory.create({ action: 'advance', by: 1 })\r\n        }); };\r\n        return _this;\r\n    }\r\n    TrajectoryViewportControls.prototype.componentDidMount = function () {\r\n        this.subscribe(this.plugin.state.data.events.changed, this.update);\r\n        this.subscribe(this.plugin.behaviors.state.isAnimating, this.update);\r\n    };\r\n    TrajectoryViewportControls.prototype.render = function () {\r\n        var isAnimating = this.plugin.behaviors.state.isAnimating.value;\r\n        if (!this.state.show || (isAnimating && !this.state.label))\r\n            return null;\r\n        return _jsxs(\"div\", __assign({ className: 'msp-traj-controls' }, { children: [!isAnimating && _jsx(IconButton, { svg: SkipPreviousSvg, title: 'First Model', onClick: this.reset, disabled: isAnimating }, void 0), !isAnimating && _jsx(IconButton, { svg: NavigateBeforeSvg, title: 'Previous Model', onClick: this.prev, disabled: isAnimating }, void 0), !isAnimating && _jsx(IconButton, { svg: NavigateNextSvg, title: 'Next Model', onClick: this.next, disabled: isAnimating }, void 0), !!this.state.label && _jsx(\"span\", { children: this.state.label }, void 0)] }), void 0);\r\n    };\r\n    return TrajectoryViewportControls;\r\n}(PluginUIComponent));\r\nexport { TrajectoryViewportControls };\r\nvar StateSnapshotViewportControls = /** @class */ (function (_super) {\r\n    __extends(StateSnapshotViewportControls, _super);\r\n    function StateSnapshotViewportControls() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isBusy: false, show: true };\r\n        _this.keyUp = function (e) {\r\n            if (!e.ctrlKey || _this.state.isBusy || e.target !== document.body)\r\n                return;\r\n            var snapshots = _this.plugin.managers.snapshot;\r\n            if (e.keyCode === 37 || e.key === 'ArrowLeft') {\r\n                if (snapshots.state.isPlaying)\r\n                    snapshots.stop();\r\n                _this.prev();\r\n            }\r\n            else if (e.keyCode === 38 || e.key === 'ArrowUp') {\r\n                if (snapshots.state.isPlaying)\r\n                    snapshots.stop();\r\n                if (snapshots.state.entries.size === 0)\r\n                    return;\r\n                var e_1 = snapshots.state.entries.get(0);\r\n                _this.update(e_1.snapshot.id);\r\n            }\r\n            else if (e.keyCode === 39 || e.key === 'ArrowRight') {\r\n                if (snapshots.state.isPlaying)\r\n                    snapshots.stop();\r\n                _this.next();\r\n            }\r\n            else if (e.keyCode === 40 || e.key === 'ArrowDown') {\r\n                if (snapshots.state.isPlaying)\r\n                    snapshots.stop();\r\n                if (snapshots.state.entries.size === 0)\r\n                    return;\r\n                var e_2 = snapshots.state.entries.get(snapshots.state.entries.size - 1);\r\n                _this.update(e_2.snapshot.id);\r\n            }\r\n        };\r\n        _this.change = function (e) {\r\n            if (e.target.value === 'none')\r\n                return;\r\n            _this.update(e.target.value);\r\n        };\r\n        _this.prev = function () {\r\n            var s = _this.plugin.managers.snapshot;\r\n            var id = s.getNextId(s.state.current, -1);\r\n            if (id)\r\n                _this.update(id);\r\n        };\r\n        _this.next = function () {\r\n            var s = _this.plugin.managers.snapshot;\r\n            var id = s.getNextId(s.state.current, 1);\r\n            if (id)\r\n                _this.update(id);\r\n        };\r\n        _this.togglePlay = function () {\r\n            _this.plugin.managers.snapshot.togglePlay();\r\n        };\r\n        return _this;\r\n    }\r\n    StateSnapshotViewportControls.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        // TODO: this needs to be diabled when the state is updating!\r\n        this.subscribe(this.plugin.managers.snapshot.events.changed, function () { return _this.forceUpdate(); });\r\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (isBusy) { return _this.setState({ isBusy: isBusy }); });\r\n        this.subscribe(this.plugin.behaviors.state.isAnimating, function (isBusy) { return _this.setState({ isBusy: isBusy }); });\r\n        window.addEventListener('keyup', this.keyUp, false);\r\n    };\r\n    StateSnapshotViewportControls.prototype.componentWillUnmount = function () {\r\n        _super.prototype.componentWillUnmount.call(this);\r\n        window.removeEventListener('keyup', this.keyUp, false);\r\n    };\r\n    StateSnapshotViewportControls.prototype.update = function (id) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.setState({ isBusy: true });\r\n                        return [4 /*yield*/, PluginCommands.State.Snapshots.Apply(this.plugin, { id: id })];\r\n                    case 1:\r\n                        _a.sent();\r\n                        this.setState({ isBusy: false });\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    StateSnapshotViewportControls.prototype.render = function () {\r\n        var snapshots = this.plugin.managers.snapshot;\r\n        var count = snapshots.state.entries.size;\r\n        if (count < 2 || !this.state.show) {\r\n            return null;\r\n        }\r\n        var current = snapshots.state.current;\r\n        var isPlaying = snapshots.state.isPlaying;\r\n        return _jsxs(\"div\", __assign({ className: 'msp-state-snapshot-viewport-controls' }, { children: [_jsxs(\"select\", __assign({ className: 'msp-form-control', value: current || 'none', onChange: this.change, disabled: this.state.isBusy || isPlaying }, { children: [!current && _jsx(\"option\", { value: 'none' }, 'none'), snapshots.state.entries.valueSeq().map(function (e, i) { return _jsxs(\"option\", __assign({ value: e.snapshot.id }, { children: [\"[\" + (i + 1) + \"/\" + count + \"]\", \" \", e.name || new Date(e.timestamp).toLocaleString()] }), e.snapshot.id); })] }), void 0), _jsx(IconButton, { svg: isPlaying ? StopSvg : PlayArrowSvg, title: isPlaying ? 'Pause' : 'Cycle States', onClick: this.togglePlay, disabled: isPlaying ? false : this.state.isBusy }, void 0), !isPlaying && _jsxs(_Fragment, { children: [_jsx(IconButton, { svg: NavigateBeforeSvg, title: 'Previous State', onClick: this.prev, disabled: this.state.isBusy || isPlaying }, void 0), _jsx(IconButton, { svg: NavigateNextSvg, title: 'Next State', onClick: this.next, disabled: this.state.isBusy || isPlaying }, void 0)] }, void 0)] }), void 0);\r\n    };\r\n    return StateSnapshotViewportControls;\r\n}(PluginUIComponent));\r\nexport { StateSnapshotViewportControls };\r\nvar AnimationViewportControls = /** @class */ (function (_super) {\r\n    __extends(AnimationViewportControls, _super);\r\n    function AnimationViewportControls() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isEmpty: true, isExpanded: false, isBusy: false, isAnimating: false, isPlaying: false };\r\n        _this.toggleExpanded = function () { return _this.setState({ isExpanded: !_this.state.isExpanded }); };\r\n        _this.stop = function () {\r\n            _this.plugin.managers.animation.stop();\r\n            _this.plugin.managers.snapshot.stop();\r\n        };\r\n        return _this;\r\n    }\r\n    AnimationViewportControls.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.managers.snapshot.events.changed, function () {\r\n            if (_this.plugin.managers.snapshot.state.isPlaying)\r\n                _this.setState({ isPlaying: true, isExpanded: false });\r\n            else\r\n                _this.setState({ isPlaying: false });\r\n        });\r\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (isBusy) {\r\n            if (isBusy)\r\n                _this.setState({ isBusy: true, isExpanded: false, isEmpty: _this.plugin.state.data.tree.transforms.size < 2 });\r\n            else\r\n                _this.setState({ isBusy: false, isEmpty: _this.plugin.state.data.tree.transforms.size < 2 });\r\n        });\r\n        this.subscribe(this.plugin.behaviors.state.isAnimating, function (isAnimating) {\r\n            if (isAnimating)\r\n                _this.setState({ isAnimating: true, isExpanded: false });\r\n            else\r\n                _this.setState({ isAnimating: false });\r\n        });\r\n    };\r\n    AnimationViewportControls.prototype.render = function () {\r\n        var isPlaying = this.plugin.managers.snapshot.state.isPlaying;\r\n        if (isPlaying || this.state.isEmpty || this.plugin.managers.animation.isEmpty || !this.plugin.config.get(PluginConfig.Viewport.ShowAnimation))\r\n            return null;\r\n        var isAnimating = this.state.isAnimating;\r\n        return _jsxs(\"div\", __assign({ className: 'msp-animation-viewport-controls' }, { children: [_jsxs(\"div\", { children: [_jsx(\"div\", { className: 'msp-semi-transparent-background' }, void 0), _jsx(IconButton, { svg: isAnimating || isPlaying ? StopSvg : SubscriptionsOutlinedSvg, transparent: true, title: isAnimating ? 'Stop' : 'Select Animation', onClick: isAnimating || isPlaying ? this.stop : this.toggleExpanded, toggleState: this.state.isExpanded, disabled: isAnimating || isPlaying ? false : this.state.isBusy || this.state.isPlaying || this.state.isEmpty }, void 0)] }, void 0), (this.state.isExpanded && !this.state.isBusy) && _jsx(\"div\", __assign({ className: 'msp-animation-viewport-controls-select' }, { children: _jsx(AnimationControls, { onStart: this.toggleExpanded }, void 0) }), void 0)] }), void 0);\r\n    };\r\n    return AnimationViewportControls;\r\n}(PluginUIComponent));\r\nexport { AnimationViewportControls };\r\nvar SelectionViewportControls = /** @class */ (function (_super) {\r\n    __extends(SelectionViewportControls, _super);\r\n    function SelectionViewportControls() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onMouseMove = function (e) {\r\n            // ignore mouse moves when no button is held\r\n            if (e.buttons === 0)\r\n                e.stopPropagation();\r\n        };\r\n        return _this;\r\n    }\r\n    SelectionViewportControls.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.behaviors.interaction.selectionMode, function () { return _this.forceUpdate(); });\r\n    };\r\n    SelectionViewportControls.prototype.render = function () {\r\n        if (!this.plugin.selectionMode)\r\n            return null;\r\n        return _jsx(\"div\", __assign({ className: 'msp-selection-viewport-controls', onMouseMove: this.onMouseMove }, { children: _jsx(StructureSelectionActionsControls, {}, void 0) }), void 0);\r\n    };\r\n    return SelectionViewportControls;\r\n}(PluginUIComponent));\r\nexport { SelectionViewportControls };\r\nvar LociLabels = /** @class */ (function (_super) {\r\n    __extends(LociLabels, _super);\r\n    function LociLabels() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { labels: [] };\r\n        return _this;\r\n    }\r\n    LociLabels.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.behaviors.labels.highlight, function (e) { return _this.setState({ labels: e.labels }); });\r\n    };\r\n    LociLabels.prototype.render = function () {\r\n        if (this.state.labels.length === 0) {\r\n            return null;\r\n        }\r\n        return _jsx(\"div\", __assign({ className: 'msp-highlight-info' }, { children: this.state.labels.map(function (e, i) { return _jsx(\"div\", { dangerouslySetInnerHTML: { __html: e } }, '' + i); }) }), void 0);\r\n    };\r\n    return LociLabels;\r\n}(PluginUIComponent));\r\nexport { LociLabels };\r\nvar CustomStructureControls = /** @class */ (function (_super) {\r\n    __extends(CustomStructureControls, _super);\r\n    function CustomStructureControls() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CustomStructureControls.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.state.behaviors.events.changed, function () { return _this.forceUpdate(); });\r\n    };\r\n    CustomStructureControls.prototype.render = function () {\r\n        var _this = this;\r\n        var controls = [];\r\n        this.plugin.customStructureControls.forEach(function (Controls, key) {\r\n            controls.push(_jsx(Controls, { initiallyCollapsed: _this.props.initiallyCollapsed }, key));\r\n        });\r\n        return controls.length > 0 ? _jsx(_Fragment, { children: controls }, void 0) : null;\r\n    };\r\n    return CustomStructureControls;\r\n}(PluginUIComponent));\r\nexport { CustomStructureControls };\r\nvar DefaultStructureTools = /** @class */ (function (_super) {\r\n    __extends(DefaultStructureTools, _super);\r\n    function DefaultStructureTools() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DefaultStructureTools.prototype.render = function () {\r\n        return _jsxs(_Fragment, { children: [_jsxs(\"div\", __assign({ className: 'msp-section-header' }, { children: [_jsx(Icon, { svg: BuildSvg }, void 0), \"Structure Tools\"] }), void 0), _jsx(StructureSourceControls, {}, void 0), _jsx(StructureMeasurementsControls, {}, void 0), _jsx(StructureSuperpositionControls, {}, void 0), _jsx(StructureComponentControls, {}, void 0), this.plugin.config.get(PluginConfig.VolumeStreaming.Enabled) && _jsx(VolumeStreamingControls, {}, void 0), _jsx(VolumeSourceControls, {}, void 0), _jsx(CustomStructureControls, {}, void 0)] }, void 0);\r\n    };\r\n    return DefaultStructureTools;\r\n}(PluginUIComponent));\r\nexport { DefaultStructureTools };\r\n//# sourceMappingURL=controls.js.map"]},"metadata":{},"sourceType":"module"}