{"ast":null,"code":"import { __assign, __extends, __spreadArray } from \"tslib\";\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\n/**\r\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\n\nimport * as React from 'react';\nimport { Mat4, Vec3 } from '../../mol-math/linear-algebra';\nimport { Color } from '../../mol-util/color';\nimport { ColorListOptions, ColorListOptionsScale, ColorListOptionsSet, getColorListFromName } from '../../mol-util/color/lists';\nimport { memoize1, memoizeLatest } from '../../mol-util/memoize';\nimport { getPrecision } from '../../mol-util/number';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { camelCaseToWords } from '../../mol-util/string';\nimport { PluginUIComponent } from '../base';\nimport { ActionMenu } from './action-menu';\nimport { ColorOptions, ColorValueOption, CombinedColorControl } from './color';\nimport { Button, ControlGroup, ControlRow, ExpandGroup, IconButton, TextInput, ToggleButton } from './common';\nimport { Icon, HelpOutlineSvg, CheckSvg, ClearSvg, BookmarksOutlinedSvg, MoreHorizSvg, ArrowDropDownSvg, ArrowRightSvg, ArrowDownwardSvg, ArrowUpwardSvg, DeleteOutlinedSvg } from './icons';\nimport { legendFor } from './legend';\nimport { LineGraphComponent } from './line-graph/line-graph-component';\nimport { Slider, Slider2 } from './slider';\nimport { Asset } from '../../mol-util/assets';\n\nvar ParameterControls =\n/** @class */\nfunction (_super) {\n  __extends(ParameterControls, _super);\n\n  function ParameterControls() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (params) {\n      var _a;\n\n      var _b, _c;\n\n      (_c = (_b = _this.props).onChange) === null || _c === void 0 ? void 0 : _c.call(_b, params, _this.props.values);\n\n      if (_this.props.onChangeValues) {\n        var values = __assign(__assign({}, _this.props.values), (_a = {}, _a[params.name] = params.value, _a));\n\n        _this.props.onChangeValues(values, _this.props.values);\n      }\n    };\n\n    _this.paramGroups = memoizeLatest(function (params) {\n      return classifyParams(params);\n    });\n    return _this;\n  }\n\n  ParameterControls.prototype.renderGroup = function (group) {\n    var _a;\n\n    if (group.length === 0) return null;\n    var values = this.props.values;\n    var ctrls = null;\n    var category = void 0;\n\n    for (var _i = 0, group_1 = group; _i < group_1.length; _i++) {\n      var _b = group_1[_i],\n          key = _b[0],\n          p = _b[1],\n          Control = _b[2];\n      if ((_a = p.hideIf) === null || _a === void 0 ? void 0 : _a.call(p, values)) continue;\n      if (!ctrls) ctrls = [];\n      category = p.category;\n      ctrls.push(_jsx(Control, {\n        param: p,\n        onChange: this.onChange,\n        onEnter: this.props.onEnter,\n        isDisabled: this.props.isDisabled,\n        name: key,\n        value: values[key]\n      }, key));\n    }\n\n    if (!ctrls) return null;\n\n    if (category) {\n      return [_jsx(ExpandGroup, __assign({\n        header: category\n      }, {\n        children: ctrls\n      }), category)];\n    }\n\n    return ctrls;\n  };\n\n  ParameterControls.prototype.renderPart = function (groups) {\n    var parts = null;\n\n    for (var _i = 0, groups_1 = groups; _i < groups_1.length; _i++) {\n      var g = groups_1[_i];\n      var ctrls = this.renderGroup(g);\n      if (!ctrls) continue;\n      if (!parts) parts = [];\n\n      for (var _a = 0, ctrls_1 = ctrls; _a < ctrls_1.length; _a++) {\n        var c = ctrls_1[_a];\n        parts.push(c);\n      }\n    }\n\n    return parts;\n  };\n\n  ParameterControls.prototype.render = function () {\n    var groups = this.paramGroups(this.props.params);\n    var essentials = this.renderPart(groups.essentials);\n    var advanced = this.renderPart(groups.advanced);\n\n    if (essentials && advanced) {\n      return _jsxs(_Fragment, {\n        children: [essentials, _jsx(ExpandGroup, __assign({\n          header: 'Advanced Options'\n        }, {\n          children: advanced\n        }), void 0)]\n      }, void 0);\n    } else if (essentials) {\n      return essentials;\n    } else {\n      return advanced;\n    }\n  };\n\n  return ParameterControls;\n}(React.PureComponent);\n\nexport { ParameterControls };\n\nvar ParameterMappingControl =\n/** @class */\nfunction (_super) {\n  __extends(ParameterMappingControl, _super);\n\n  function ParameterMappingControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.setSettings = function (p, old) {\n      var _a;\n\n      var values = __assign(__assign({}, old), (_a = {}, _a[p.name] = p.value, _a));\n\n      var t = _this.props.mapping.update(values, _this.plugin);\n\n      _this.props.mapping.apply(t, _this.plugin);\n    };\n\n    return _this;\n  }\n\n  ParameterMappingControl.prototype.componentDidMount = function () {\n    var _this = this;\n\n    this.subscribe(this.plugin.events.canvas3d.settingsUpdated, function () {\n      return _this.forceUpdate();\n    });\n  };\n\n  ParameterMappingControl.prototype.render = function () {\n    var t = this.props.mapping.getTarget(this.plugin);\n    var values = this.props.mapping.getValues(t, this.plugin);\n    var params = this.props.mapping.params(this.plugin);\n    return _jsx(ParameterControls, {\n      params: params,\n      values: values,\n      onChange: this.setSettings\n    }, void 0);\n  };\n\n  return ParameterMappingControl;\n}(PluginUIComponent);\n\nexport { ParameterMappingControl };\n\nfunction classifyParams(params) {\n  function addParam(k, p, group) {\n    var ctrl = controlFor(p);\n    if (!ctrl) return;\n    if (!p.category) group.params[0].push([k, p, ctrl]);else {\n      if (!group.map) group.map = new Map();\n      var c = group.map.get(p.category);\n\n      if (!c) {\n        c = [];\n        group.map.set(p.category, c);\n        group.params.push(c);\n      }\n\n      c.push([k, p, ctrl]);\n    }\n  }\n\n  function sortGroups(x, y) {\n    var a = x[0],\n        b = y[0];\n    if (!a || !a[1].category) return -1;\n    if (!b || !b[1].category) return 1;\n    return a[1].category < b[1].category ? -1 : 1;\n  }\n\n  var keys = Object.keys(params);\n  var essentials = {\n    params: [[]],\n    map: void 0\n  };\n  var advanced = {\n    params: [[]],\n    map: void 0\n  };\n\n  for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n    var k = keys_1[_i];\n    var p = params[k];\n    if (p.isHidden) continue;\n    if (p.isEssential) addParam(k, p, essentials);else addParam(k, p, advanced);\n  }\n\n  essentials.params.sort(sortGroups);\n  advanced.params.sort(sortGroups);\n  return {\n    essentials: essentials.params,\n    advanced: advanced.params\n  };\n}\n\nfunction controlFor(param) {\n  switch (param.type) {\n    case 'value':\n      return void 0;\n\n    case 'boolean':\n      return BoolControl;\n\n    case 'number':\n      return typeof param.min !== 'undefined' && typeof param.max !== 'undefined' ? NumberRangeControl : NumberInputControl;\n\n    case 'converted':\n      return ConvertedControl;\n\n    case 'conditioned':\n      return ConditionedControl;\n\n    case 'multi-select':\n      return MultiSelectControl;\n\n    case 'color':\n      return CombinedColorControl;\n\n    case 'color-list':\n      return param.offsets ? OffsetColorListControl : ColorListControl;\n\n    case 'vec3':\n      return Vec3Control;\n\n    case 'mat4':\n      return Mat4Control;\n\n    case 'url':\n      return UrlControl;\n\n    case 'file':\n      return FileControl;\n\n    case 'file-list':\n      return FileListControl;\n\n    case 'select':\n      return SelectControl;\n\n    case 'value-ref':\n      return ValueRefControl;\n\n    case 'data-ref':\n      return void 0;\n\n    case 'text':\n      return TextControl;\n\n    case 'interval':\n      return typeof param.min !== 'undefined' && typeof param.max !== 'undefined' ? BoundedIntervalControl : IntervalControl;\n\n    case 'group':\n      return GroupControl;\n\n    case 'mapped':\n      return MappedControl;\n\n    case 'line-graph':\n      return LineGraphControl;\n\n    case 'script':\n      return ScriptControl;\n\n    case 'object-list':\n      return ObjectListControl;\n\n    default:\n      var _ = param;\n      console.warn(_ + \" has no associated UI component\");\n      return void 0;\n  }\n}\n\nvar ParamHelp =\n/** @class */\nfunction (_super) {\n  __extends(ParamHelp, _super);\n\n  function ParamHelp() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  ParamHelp.prototype.render = function () {\n    var _a = this.props,\n        legend = _a.legend,\n        description = _a.description;\n    var Legend = legend && legendFor(legend);\n    return _jsx(\"div\", __assign({\n      className: 'msp-help-text'\n    }, {\n      children: _jsxs(\"div\", {\n        children: [_jsxs(\"div\", __assign({\n          className: 'msp-help-description'\n        }, {\n          children: [_jsx(Icon, {\n            svg: HelpOutlineSvg,\n            inline: true\n          }, void 0), description]\n        }), void 0), Legend && _jsx(\"div\", __assign({\n          className: 'msp-help-legend'\n        }, {\n          children: _jsx(Legend, {\n            legend: legend\n          }, void 0)\n        }), void 0)]\n      }, void 0)\n    }), void 0);\n  };\n\n  return ParamHelp;\n}(React.PureComponent);\n\nexport { ParamHelp };\n\nfunction renderSimple(options) {\n  var props = options.props,\n      state = options.state,\n      control = options.control,\n      toggleHelp = options.toggleHelp,\n      addOn = options.addOn;\n  var _className = [];\n  if (props.param.shortLabel) _className.push('msp-control-label-short');\n  if (props.param.twoColumns) _className.push('msp-control-col-2');\n\n  var className = _className.join(' ');\n\n  var label = props.param.label || camelCaseToWords(props.name);\n  var help = props.param.help ? props.param.help(props.value) : {\n    description: props.param.description,\n    legend: props.param.legend\n  };\n  var hasHelp = help.description || help.legend;\n  var desc = label + (hasHelp ? '. Click for help.' : '');\n  return _jsxs(_Fragment, {\n    children: [_jsx(ControlRow, {\n      className: className,\n      title: desc,\n      label: _jsxs(_Fragment, {\n        children: [label, hasHelp && _jsx(\"button\", __assign({\n          className: 'msp-help msp-btn-link msp-btn-icon msp-control-group-expander',\n          onClick: toggleHelp,\n          title: desc || (state.showHelp ? 'Hide' : 'Show') + \" help\",\n          style: {\n            background: 'transparent',\n            textAlign: 'left',\n            padding: '0'\n          }\n        }, {\n          children: _jsx(Icon, {\n            svg: HelpOutlineSvg\n          }, void 0)\n        }), void 0)]\n      }, void 0),\n      control: control\n    }, void 0), hasHelp && state.showHelp && _jsx(\"div\", __assign({\n      className: 'msp-control-offset'\n    }, {\n      children: _jsx(ParamHelp, {\n        legend: help.legend,\n        description: help.description\n      }, void 0)\n    }), void 0), addOn]\n  }, void 0);\n}\n\nvar SimpleParam =\n/** @class */\nfunction (_super) {\n  __extends(SimpleParam, _super);\n\n  function SimpleParam() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      showHelp: false\n    };\n\n    _this.toggleHelp = function () {\n      return _this.setState({\n        showHelp: !_this.state.showHelp\n      });\n    };\n\n    return _this;\n  }\n\n  SimpleParam.prototype.update = function (value) {\n    this.props.onChange({\n      param: this.props.param,\n      name: this.props.name,\n      value: value\n    });\n  };\n\n  SimpleParam.prototype.renderAddOn = function () {\n    return null;\n  };\n\n  SimpleParam.prototype.render = function () {\n    return renderSimple({\n      props: this.props,\n      state: this.state,\n      control: this.renderControl(),\n      toggleHelp: this.toggleHelp,\n      addOn: this.renderAddOn()\n    });\n  };\n\n  return SimpleParam;\n}(React.PureComponent);\n\nexport { SimpleParam };\n\nvar BoolControl =\n/** @class */\nfunction (_super) {\n  __extends(BoolControl, _super);\n\n  function BoolControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onClick = function (e) {\n      _this.update(!_this.props.value);\n\n      e.currentTarget.blur();\n    };\n\n    return _this;\n  }\n\n  BoolControl.prototype.renderControl = function () {\n    return _jsxs(\"button\", __assign({\n      onClick: this.onClick,\n      disabled: this.props.isDisabled\n    }, {\n      children: [_jsx(Icon, {\n        svg: this.props.value ? CheckSvg : ClearSvg\n      }, void 0), this.props.value ? 'On' : 'Off']\n    }), void 0);\n  };\n\n  return BoolControl;\n}(SimpleParam);\n\nexport { BoolControl };\n\nvar LineGraphControl =\n/** @class */\nfunction (_super) {\n  __extends(LineGraphControl, _super);\n\n  function LineGraphControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: false,\n      isOverPoint: false,\n      message: _this.props.param.defaultValue.length + \" points\"\n    };\n\n    _this.onHover = function (point) {\n      _this.setState({\n        isOverPoint: !_this.state.isOverPoint\n      });\n\n      if (point) {\n        _this.setState({\n          message: \"(\" + point[0].toFixed(2) + \", \" + point[1].toFixed(2) + \")\"\n        });\n\n        return;\n      }\n\n      _this.setState({\n        message: _this.props.value.length + \" points\"\n      });\n    };\n\n    _this.onDrag = function (point) {\n      _this.setState({\n        message: \"(\" + point[0].toFixed(2) + \", \" + point[1].toFixed(2) + \")\"\n      });\n    };\n\n    _this.onChange = function (value) {\n      _this.props.onChange({\n        name: _this.props.name,\n        param: _this.props.param,\n        value: value\n      });\n    };\n\n    _this.toggleExpanded = function (e) {\n      _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n\n      e.currentTarget.blur();\n    };\n\n    return _this;\n  }\n\n  LineGraphControl.prototype.render = function () {\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    return _jsxs(_Fragment, {\n      children: [_jsx(ControlRow, {\n        label: label,\n        control: _jsx(\"button\", __assign({\n          onClick: this.toggleExpanded,\n          disabled: this.props.isDisabled\n        }, {\n          children: \"\" + this.state.message\n        }), void 0)\n      }, void 0), _jsx(\"div\", __assign({\n        className: 'msp-control-offset',\n        style: {\n          display: this.state.isExpanded ? 'block' : 'none'\n        }\n      }, {\n        children: _jsx(LineGraphComponent, {\n          data: this.props.param.defaultValue,\n          onChange: this.onChange,\n          onHover: this.onHover,\n          onDrag: this.onDrag\n        }, void 0)\n      }), void 0)]\n    }, void 0);\n  };\n\n  return LineGraphControl;\n}(React.PureComponent);\n\nexport { LineGraphControl };\n\nvar NumberInputControl =\n/** @class */\nfunction (_super) {\n  __extends(NumberInputControl, _super);\n\n  function NumberInputControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      value: '0'\n    };\n\n    _this.update = function (value) {\n      var p = getPrecision(_this.props.param.step || 0.01);\n      value = parseFloat(value.toFixed(p));\n\n      _this.props.onChange({\n        param: _this.props.param,\n        name: _this.props.name,\n        value: value\n      });\n    };\n\n    return _this;\n  }\n\n  NumberInputControl.prototype.render = function () {\n    var placeholder = this.props.param.label || camelCaseToWords(this.props.name);\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    var p = getPrecision(this.props.param.step || 0.01);\n    return _jsx(ControlRow, {\n      title: this.props.param.description,\n      label: label,\n      control: _jsx(TextInput, {\n        numeric: true,\n        value: parseFloat(this.props.value.toFixed(p)),\n        onEnter: this.props.onEnter,\n        placeholder: placeholder,\n        isDisabled: this.props.isDisabled,\n        onChange: this.update\n      }, void 0)\n    }, void 0);\n  };\n\n  return NumberInputControl;\n}(React.PureComponent);\n\nexport { NumberInputControl };\n\nvar NumberRangeControl =\n/** @class */\nfunction (_super) {\n  __extends(NumberRangeControl, _super);\n\n  function NumberRangeControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (v) {\n      _this.update(v);\n    };\n\n    return _this;\n  }\n\n  NumberRangeControl.prototype.renderControl = function () {\n    var value = typeof this.props.value === 'undefined' ? this.props.param.defaultValue : this.props.value;\n    return _jsx(Slider, {\n      value: value,\n      min: this.props.param.min,\n      max: this.props.param.max,\n      step: this.props.param.step,\n      onChange: this.onChange,\n      onChangeImmediate: this.props.param.immediateUpdate ? this.onChange : void 0,\n      disabled: this.props.isDisabled,\n      onEnter: this.props.onEnter\n    }, void 0);\n  };\n\n  return NumberRangeControl;\n}(SimpleParam);\n\nexport { NumberRangeControl };\n\nvar TextControl =\n/** @class */\nfunction (_super) {\n  __extends(TextControl, _super);\n\n  function TextControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (e) {\n      var value = e.target.value;\n\n      if (value !== _this.props.value) {\n        _this.update(value);\n      }\n    };\n\n    _this.onKeyPress = function (e) {\n      if (e.keyCode === 13 || e.charCode === 13 || e.key === 'Enter') {\n        if (_this.props.onEnter) _this.props.onEnter();\n      }\n\n      e.stopPropagation();\n    };\n\n    return _this;\n  }\n\n  TextControl.prototype.renderControl = function () {\n    var placeholder = this.props.param.label || camelCaseToWords(this.props.name);\n    return _jsx(\"input\", {\n      type: 'text',\n      value: this.props.value || '',\n      placeholder: placeholder,\n      onChange: this.onChange,\n      onKeyPress: this.props.onEnter ? this.onKeyPress : void 0,\n      disabled: this.props.isDisabled\n    }, void 0);\n  };\n\n  return TextControl;\n}(SimpleParam);\n\nexport { TextControl };\n\nvar PureSelectControl =\n/** @class */\nfunction (_super) {\n  __extends(PureSelectControl, _super);\n\n  function PureSelectControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (e) {\n      if (typeof _this.props.param.defaultValue === 'number') {\n        _this.update(parseInt(e.target.value, 10));\n      } else {\n        _this.update(e.target.value);\n      }\n    };\n\n    return _this;\n  }\n\n  PureSelectControl.prototype.update = function (value) {\n    this.props.onChange({\n      param: this.props.param,\n      name: this.props.name,\n      value: value\n    });\n  };\n\n  PureSelectControl.prototype.render = function () {\n    var _this = this;\n\n    var isInvalid = this.props.value !== void 0 && !this.props.param.options.some(function (e) {\n      return e[0] === _this.props.value;\n    });\n    return _jsxs(\"select\", __assign({\n      className: 'msp-form-control',\n      title: this.props.title,\n      value: this.props.value !== void 0 ? this.props.value : this.props.param.defaultValue,\n      onChange: this.onChange,\n      disabled: this.props.isDisabled\n    }, {\n      children: [isInvalid && _jsx(\"option\", __assign({\n        value: this.props.value\n      }, {\n        children: \"[Invalid] \" + this.props.value\n      }), this.props.value), this.props.param.options.map(function (_a) {\n        var value = _a[0],\n            label = _a[1];\n        return _jsx(\"option\", __assign({\n          value: value\n        }, {\n          children: label\n        }), value);\n      })]\n    }), void 0);\n  };\n\n  return PureSelectControl;\n}(React.PureComponent);\n\nexport { PureSelectControl };\n\nvar SelectControl =\n/** @class */\nfunction (_super) {\n  __extends(SelectControl, _super);\n\n  function SelectControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      showHelp: false,\n      showOptions: false\n    };\n\n    _this.onSelect = function (item) {\n      if (!item || item.value === _this.props.value) {\n        _this.setState({\n          showOptions: false\n        });\n      } else {\n        _this.setState({\n          showOptions: false\n        }, function () {\n          _this.props.onChange({\n            param: _this.props.param,\n            name: _this.props.name,\n            value: item.value\n          });\n        });\n      }\n    };\n\n    _this.toggle = function () {\n      return _this.setState({\n        showOptions: !_this.state.showOptions\n      });\n    };\n\n    _this.cycle = function () {\n      var options = _this.props.param.options;\n      var current = options.findIndex(function (o) {\n        return o[0] === _this.props.value;\n      });\n      var next = current === options.length - 1 ? 0 : current + 1;\n\n      _this.props.onChange({\n        param: _this.props.param,\n        name: _this.props.name,\n        value: options[next][0]\n      });\n    };\n\n    _this.items = memoizeLatest(function (param) {\n      return ActionMenu.createItemsFromSelectOptions(param.options);\n    });\n\n    _this.toggleHelp = function () {\n      return _this.setState({\n        showHelp: !_this.state.showHelp\n      });\n    };\n\n    return _this;\n  }\n\n  SelectControl.prototype.renderControl = function () {\n    var _a;\n\n    var items = this.items(this.props.param);\n    var current = this.props.value !== undefined ? ActionMenu.findItem(items, this.props.value) : void 0;\n    var label = current ? current.label : typeof this.props.value === 'undefined' ? (((_a = ActionMenu.getFirstItem(items)) === null || _a === void 0 ? void 0 : _a.label) || '') + \" [Default]\" : \"[Invalid] \" + this.props.value;\n    var toggle = this.props.param.cycle ? this.cycle : this.toggle;\n    var textAlign = this.props.param.cycle ? 'center' : 'left';\n    var icon = this.props.param.cycle ? this.props.value === 'on' ? CheckSvg : this.props.value === 'off' ? ClearSvg : void 0 : void 0;\n    return _jsx(ToggleButton, {\n      disabled: this.props.isDisabled,\n      style: {\n        textAlign: textAlign,\n        overflow: 'hidden',\n        textOverflow: 'ellipsis'\n      },\n      label: label,\n      title: label,\n      icon: icon,\n      toggle: toggle,\n      isSelected: this.state.showOptions\n    }, void 0);\n  };\n\n  SelectControl.prototype.renderAddOn = function () {\n    if (!this.state.showOptions) return null;\n    var items = this.items(this.props.param);\n    var current = ActionMenu.findItem(items, this.props.value);\n    return _jsx(ActionMenu, {\n      items: items,\n      current: current,\n      onSelect: this.onSelect\n    }, void 0);\n  };\n\n  SelectControl.prototype.render = function () {\n    return renderSimple({\n      props: this.props,\n      state: this.state,\n      control: this.renderControl(),\n      toggleHelp: this.toggleHelp,\n      addOn: this.renderAddOn()\n    });\n  };\n\n  return SelectControl;\n}(React.PureComponent);\n\nexport { SelectControl };\n\nvar ValueRefControl =\n/** @class */\nfunction (_super) {\n  __extends(ValueRefControl, _super);\n\n  function ValueRefControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      showHelp: false,\n      showOptions: false\n    };\n\n    _this.onSelect = function (item) {\n      if (!item || item.value === _this.props.value) {\n        _this.setState({\n          showOptions: false\n        });\n      } else {\n        _this.setState({\n          showOptions: false\n        }, function () {\n          _this.props.onChange({\n            param: _this.props.param,\n            name: _this.props.name,\n            value: {\n              ref: item.value\n            }\n          });\n        });\n      }\n    };\n\n    _this.toggle = function () {\n      return _this.setState({\n        showOptions: !_this.state.showOptions\n      });\n    };\n\n    _this.items = memoizeLatest(function (param) {\n      return ActionMenu.createItemsFromSelectOptions(param.getOptions());\n    });\n\n    _this.toggleHelp = function () {\n      return _this.setState({\n        showHelp: !_this.state.showHelp\n      });\n    };\n\n    return _this;\n  }\n\n  ValueRefControl.prototype.renderControl = function () {\n    var _a;\n\n    var items = this.items(this.props.param);\n    var current = this.props.value.ref ? ActionMenu.findItem(items, this.props.value.ref) : void 0;\n    var label = current ? current.label : \"[Ref] \" + ((_a = this.props.value.ref) !== null && _a !== void 0 ? _a : '');\n    return _jsx(ToggleButton, {\n      disabled: this.props.isDisabled,\n      style: {\n        textAlign: 'left',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis'\n      },\n      label: label,\n      title: label,\n      toggle: this.toggle,\n      isSelected: this.state.showOptions\n    }, void 0);\n  };\n\n  ValueRefControl.prototype.renderAddOn = function () {\n    if (!this.state.showOptions) return null;\n    var items = this.items(this.props.param);\n    var current = ActionMenu.findItem(items, this.props.value.ref);\n    return _jsx(ActionMenu, {\n      items: items,\n      current: current,\n      onSelect: this.onSelect\n    }, void 0);\n  };\n\n  ValueRefControl.prototype.render = function () {\n    return renderSimple({\n      props: this.props,\n      state: this.state,\n      control: this.renderControl(),\n      toggleHelp: this.toggleHelp,\n      addOn: this.renderAddOn()\n    });\n  };\n\n  return ValueRefControl;\n}(React.PureComponent);\n\nexport { ValueRefControl };\n\nvar IntervalControl =\n/** @class */\nfunction (_super) {\n  __extends(IntervalControl, _super);\n\n  function IntervalControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: false\n    };\n    _this.components = {\n      0: PD.Numeric(0, {\n        step: _this.props.param.step\n      }, {\n        label: 'Min'\n      }),\n      1: PD.Numeric(0, {\n        step: _this.props.param.step\n      }, {\n        label: 'Max'\n      })\n    };\n\n    _this.componentChange = function (_a) {\n      var name = _a.name,\n          value = _a.value;\n\n      var v = __spreadArray([], _this.props.value, true);\n\n      v[+name] = value;\n\n      _this.change(v);\n    };\n\n    _this.toggleExpanded = function (e) {\n      _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n\n      e.currentTarget.blur();\n    };\n\n    return _this;\n  }\n\n  IntervalControl.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: value\n    });\n  };\n\n  IntervalControl.prototype.render = function () {\n    var v = this.props.value;\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    var p = getPrecision(this.props.param.step || 0.01);\n    var value = \"[\" + v[0].toFixed(p) + \", \" + v[1].toFixed(p) + \"]\";\n    return _jsxs(_Fragment, {\n      children: [_jsx(ControlRow, {\n        label: label,\n        control: _jsx(\"button\", __assign({\n          onClick: this.toggleExpanded,\n          disabled: this.props.isDisabled\n        }, {\n          children: value\n        }), void 0)\n      }, void 0), this.state.isExpanded && _jsx(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: _jsx(ParameterControls, {\n          params: this.components,\n          values: v,\n          onChange: this.componentChange,\n          onEnter: this.props.onEnter\n        }, void 0)\n      }), void 0)]\n    }, void 0);\n  };\n\n  return IntervalControl;\n}(React.PureComponent);\n\nexport { IntervalControl };\n\nvar BoundedIntervalControl =\n/** @class */\nfunction (_super) {\n  __extends(BoundedIntervalControl, _super);\n\n  function BoundedIntervalControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (v) {\n      _this.update(v);\n    };\n\n    return _this;\n  }\n\n  BoundedIntervalControl.prototype.renderControl = function () {\n    return _jsx(Slider2, {\n      value: this.props.value,\n      min: this.props.param.min,\n      max: this.props.param.max,\n      step: this.props.param.step,\n      onChange: this.onChange,\n      disabled: this.props.isDisabled,\n      onEnter: this.props.onEnter\n    }, void 0);\n  };\n\n  return BoundedIntervalControl;\n}(SimpleParam);\n\nexport { BoundedIntervalControl };\n\nvar ColorControl =\n/** @class */\nfunction (_super) {\n  __extends(ColorControl, _super);\n\n  function ColorControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (e) {\n      _this.update(Color(parseInt(e.target.value)));\n    };\n\n    return _this;\n  }\n\n  ColorControl.prototype.stripStyle = function () {\n    return {\n      background: Color.toStyle(this.props.value),\n      position: 'absolute',\n      bottom: '0',\n      height: '4px',\n      right: '0',\n      left: '0'\n    };\n  };\n\n  ColorControl.prototype.renderControl = function () {\n    return _jsxs(\"div\", __assign({\n      style: {\n        position: 'relative'\n      }\n    }, {\n      children: [_jsxs(\"select\", __assign({\n        value: this.props.value,\n        onChange: this.onChange\n      }, {\n        children: [ColorValueOption(this.props.value), ColorOptions()]\n      }), void 0), _jsx(\"div\", {\n        style: this.stripStyle()\n      }, void 0)]\n    }), void 0);\n  };\n\n  return ColorControl;\n}(SimpleParam);\n\nexport { ColorControl };\n\nfunction colorEntryToStyle(e, includeOffset) {\n  if (includeOffset === void 0) {\n    includeOffset = false;\n  }\n\n  if (Array.isArray(e)) {\n    if (includeOffset) return Color.toStyle(e[0]) + \" \" + (100 * e[1]).toFixed(2) + \"%\";\n    return Color.toStyle(e[0]);\n  }\n\n  return Color.toStyle(e);\n}\n\nvar colorGradientInterpolated = memoize1(function (colors) {\n  var styles = colors.map(function (c) {\n    return colorEntryToStyle(c, true);\n  });\n  return \"linear-gradient(to right, \" + styles.join(', ') + \")\";\n});\nvar colorGradientBanded = memoize1(function (colors) {\n  var n = colors.length;\n  var styles = [colorEntryToStyle(colors[0]) + \" \" + 100 * (1 / n) + \"%\"]; // TODO: does this need to support offsets?\n\n  for (var i = 1, il = n - 1; i < il; ++i) {\n    styles.push(colorEntryToStyle(colors[i]) + \" \" + 100 * (i / n) + \"%\", colorEntryToStyle(colors[i]) + \" \" + 100 * ((i + 1) / n) + \"%\");\n  }\n\n  styles.push(colorEntryToStyle(colors[n - 1]) + \" \" + 100 * ((n - 1) / n) + \"%\");\n  return \"linear-gradient(to right, \" + styles.join(', ') + \")\";\n});\n\nfunction colorStripStyle(list, right) {\n  if (right === void 0) {\n    right = '0';\n  }\n\n  return {\n    background: colorGradient(list.colors, list.kind === 'set'),\n    position: 'absolute',\n    bottom: '0',\n    height: '4px',\n    right: right,\n    left: '0'\n  };\n}\n\nfunction colorGradient(colors, banded) {\n  return banded ? colorGradientBanded(colors) : colorGradientInterpolated(colors);\n}\n\nfunction createColorListHelpers() {\n  var addOn = function (l) {\n    var preset = getColorListFromName(l[0]);\n    return _jsx(\"div\", {\n      style: colorStripStyle({\n        kind: preset.type !== 'qualitative' ? 'interpolate' : 'set',\n        colors: preset.list\n      })\n    }, void 0);\n  };\n\n  return {\n    ColorPresets: {\n      all: ActionMenu.createItemsFromSelectOptions(ColorListOptions, {\n        addOn: addOn\n      }),\n      scale: ActionMenu.createItemsFromSelectOptions(ColorListOptionsScale, {\n        addOn: addOn\n      }),\n      set: ActionMenu.createItemsFromSelectOptions(ColorListOptionsSet, {\n        addOn: addOn\n      })\n    },\n    ColorsParam: PD.ObjectList({\n      color: PD.Color(0x0)\n    }, function (_a) {\n      var color = _a.color;\n      return Color.toHexString(color).toUpperCase();\n    }),\n    OffsetColorsParam: PD.ObjectList({\n      color: PD.Color(0x0),\n      offset: PD.Numeric(0, {\n        min: 0,\n        max: 1,\n        step: 0.01\n      })\n    }, function (_a) {\n      var color = _a.color,\n          offset = _a.offset;\n      return Color.toHexString(color).toUpperCase() + \" [\" + offset.toFixed(2) + \"]\";\n    }),\n    IsInterpolatedParam: PD.Boolean(false, {\n      label: 'Interpolated'\n    })\n  };\n}\n\nvar _colorListHelpers;\n\nfunction ColorListHelpers() {\n  if (_colorListHelpers) return _colorListHelpers;\n  _colorListHelpers = createColorListHelpers();\n  return _colorListHelpers;\n}\n\nvar ColorListControl =\n/** @class */\nfunction (_super) {\n  __extends(ColorListControl, _super);\n\n  function ColorListControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      showHelp: false,\n      show: void 0\n    };\n\n    _this.toggleEdit = function () {\n      return _this.setState({\n        show: _this.state.show === 'edit' ? void 0 : 'edit'\n      });\n    };\n\n    _this.togglePresets = function () {\n      return _this.setState({\n        show: _this.state.show === 'presets' ? void 0 : 'presets'\n      });\n    };\n\n    _this.selectPreset = function (item) {\n      if (!item) return;\n\n      _this.setState({\n        show: void 0\n      });\n\n      var preset = getColorListFromName(item.value);\n\n      _this.update({\n        kind: preset.type !== 'qualitative' ? 'interpolate' : 'set',\n        colors: preset.list\n      });\n    };\n\n    _this.colorsChanged = function (_a) {\n      var value = _a.value;\n\n      _this.update({\n        kind: _this.props.value.kind,\n        colors: value.map(function (c) {\n          return c.color;\n        })\n      });\n    };\n\n    _this.isInterpolatedChanged = function (_a) {\n      var value = _a.value;\n\n      _this.update({\n        kind: value ? 'interpolate' : 'set',\n        colors: _this.props.value.colors\n      });\n    };\n\n    _this.toggleHelp = function () {\n      return _this.setState({\n        showHelp: !_this.state.showHelp\n      });\n    };\n\n    return _this;\n  }\n\n  ColorListControl.prototype.update = function (value) {\n    this.props.onChange({\n      param: this.props.param,\n      name: this.props.name,\n      value: value\n    });\n  };\n\n  ColorListControl.prototype.renderControl = function () {\n    var value = this.props.value; // TODO: fix the button right offset\n\n    return _jsxs(_Fragment, {\n      children: [_jsxs(\"button\", __assign({\n        onClick: this.toggleEdit,\n        style: {\n          position: 'relative',\n          paddingRight: '33px'\n        }\n      }, {\n        children: [value.colors.length === 1 ? '1 color' : value.colors.length + \" colors\", _jsx(\"div\", {\n          style: colorStripStyle(value, '33px')\n        }, void 0)]\n      }), void 0), _jsx(IconButton, {\n        svg: BookmarksOutlinedSvg,\n        onClick: this.togglePresets,\n        toggleState: this.state.show === 'presets',\n        title: 'Color Presets',\n        style: {\n          padding: 0,\n          position: 'absolute',\n          right: 0,\n          top: 0,\n          width: '32px'\n        }\n      }, void 0)]\n    }, void 0);\n  };\n\n  ColorListControl.prototype.renderColors = function () {\n    if (!this.state.show) return null;\n\n    var _a = ColorListHelpers(),\n        ColorPresets = _a.ColorPresets,\n        ColorsParam = _a.ColorsParam,\n        IsInterpolatedParam = _a.IsInterpolatedParam;\n\n    var preset = ColorPresets[this.props.param.presetKind];\n    if (this.state.show === 'presets') return _jsx(ActionMenu, {\n      items: preset,\n      onSelect: this.selectPreset\n    }, void 0);\n    var values = this.props.value.colors.map(function (color) {\n      return {\n        color: color\n      };\n    });\n    return _jsxs(\"div\", __assign({\n      className: 'msp-control-offset'\n    }, {\n      children: [_jsx(ObjectListControl, {\n        name: 'colors',\n        param: ColorsParam,\n        value: values,\n        onChange: this.colorsChanged,\n        isDisabled: this.props.isDisabled,\n        onEnter: this.props.onEnter\n      }, void 0), _jsx(BoolControl, {\n        name: 'isInterpolated',\n        param: IsInterpolatedParam,\n        value: this.props.value.kind === 'interpolate',\n        onChange: this.isInterpolatedChanged,\n        isDisabled: this.props.isDisabled,\n        onEnter: this.props.onEnter\n      }, void 0)]\n    }), void 0);\n  };\n\n  ColorListControl.prototype.render = function () {\n    return renderSimple({\n      props: this.props,\n      state: this.state,\n      control: this.renderControl(),\n      toggleHelp: this.toggleHelp,\n      addOn: this.renderColors()\n    });\n  };\n\n  return ColorListControl;\n}(React.PureComponent);\n\nexport { ColorListControl };\n\nvar OffsetColorListControl =\n/** @class */\nfunction (_super) {\n  __extends(OffsetColorListControl, _super);\n\n  function OffsetColorListControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      showHelp: false,\n      show: void 0\n    };\n\n    _this.toggleEdit = function () {\n      return _this.setState({\n        show: _this.state.show === 'edit' ? void 0 : 'edit'\n      });\n    };\n\n    _this.togglePresets = function () {\n      return _this.setState({\n        show: _this.state.show === 'presets' ? void 0 : 'presets'\n      });\n    };\n\n    _this.selectPreset = function (item) {\n      if (!item) return;\n\n      _this.setState({\n        show: void 0\n      });\n\n      var preset = getColorListFromName(item.value);\n\n      _this.update({\n        kind: preset.type !== 'qualitative' ? 'interpolate' : 'set',\n        colors: preset.list\n      });\n    };\n\n    _this.colorsChanged = function (_a) {\n      var value = _a.value;\n      var colors = value.map(function (c) {\n        return [c.color, c.offset];\n      });\n      colors.sort(function (a, b) {\n        return a[1] - b[1];\n      });\n\n      _this.update({\n        kind: _this.props.value.kind,\n        colors: colors\n      });\n    };\n\n    _this.isInterpolatedChanged = function (_a) {\n      var value = _a.value;\n\n      _this.update({\n        kind: value ? 'interpolate' : 'set',\n        colors: _this.props.value.colors\n      });\n    };\n\n    _this.toggleHelp = function () {\n      return _this.setState({\n        showHelp: !_this.state.showHelp\n      });\n    };\n\n    return _this;\n  }\n\n  OffsetColorListControl.prototype.update = function (value) {\n    this.props.onChange({\n      param: this.props.param,\n      name: this.props.name,\n      value: value\n    });\n  };\n\n  OffsetColorListControl.prototype.renderControl = function () {\n    var value = this.props.value; // TODO: fix the button right offset\n\n    return _jsxs(_Fragment, {\n      children: [_jsxs(\"button\", __assign({\n        onClick: this.toggleEdit,\n        style: {\n          position: 'relative',\n          paddingRight: '33px'\n        }\n      }, {\n        children: [value.colors.length === 1 ? '1 color' : value.colors.length + \" colors\", _jsx(\"div\", {\n          style: colorStripStyle(value, '33px')\n        }, void 0)]\n      }), void 0), _jsx(IconButton, {\n        svg: BookmarksOutlinedSvg,\n        onClick: this.togglePresets,\n        toggleState: this.state.show === 'presets',\n        title: 'Color Presets',\n        style: {\n          padding: 0,\n          position: 'absolute',\n          right: 0,\n          top: 0,\n          width: '32px'\n        }\n      }, void 0)]\n    }, void 0);\n  };\n\n  OffsetColorListControl.prototype.renderColors = function () {\n    if (!this.state.show) return null;\n\n    var _a = ColorListHelpers(),\n        ColorPresets = _a.ColorPresets,\n        OffsetColorsParam = _a.OffsetColorsParam,\n        IsInterpolatedParam = _a.IsInterpolatedParam;\n\n    var preset = ColorPresets[this.props.param.presetKind];\n    if (this.state.show === 'presets') return _jsx(ActionMenu, {\n      items: preset,\n      onSelect: this.selectPreset\n    }, void 0);\n    var colors = this.props.value.colors;\n    var values = colors.map(function (color, i) {\n      if (Array.isArray(color)) return {\n        color: color[0],\n        offset: color[1]\n      };\n      return {\n        color: color,\n        offset: i / colors.length\n      };\n    });\n    values.sort(function (a, b) {\n      return a.offset - b.offset;\n    });\n    return _jsxs(\"div\", __assign({\n      className: 'msp-control-offset'\n    }, {\n      children: [_jsx(ObjectListControl, {\n        name: 'colors',\n        param: OffsetColorsParam,\n        value: values,\n        onChange: this.colorsChanged,\n        isDisabled: this.props.isDisabled,\n        onEnter: this.props.onEnter\n      }, void 0), _jsx(BoolControl, {\n        name: 'isInterpolated',\n        param: IsInterpolatedParam,\n        value: this.props.value.kind === 'interpolate',\n        onChange: this.isInterpolatedChanged,\n        isDisabled: this.props.isDisabled,\n        onEnter: this.props.onEnter\n      }, void 0)]\n    }), void 0);\n  };\n\n  OffsetColorListControl.prototype.render = function () {\n    return renderSimple({\n      props: this.props,\n      state: this.state,\n      control: this.renderControl(),\n      toggleHelp: this.toggleHelp,\n      addOn: this.renderColors()\n    });\n  };\n\n  return OffsetColorListControl;\n}(React.PureComponent);\n\nexport { OffsetColorListControl };\n\nvar Vec3Control =\n/** @class */\nfunction (_super) {\n  __extends(Vec3Control, _super);\n\n  function Vec3Control() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: false\n    };\n    _this.components = {\n      0: PD.Numeric(0, {\n        step: _this.props.param.step\n      }, {\n        label: _this.props.param.fieldLabels && _this.props.param.fieldLabels.x || 'X'\n      }),\n      1: PD.Numeric(0, {\n        step: _this.props.param.step\n      }, {\n        label: _this.props.param.fieldLabels && _this.props.param.fieldLabels.y || 'Y'\n      }),\n      2: PD.Numeric(0, {\n        step: _this.props.param.step\n      }, {\n        label: _this.props.param.fieldLabels && _this.props.param.fieldLabels.z || 'Z'\n      })\n    };\n\n    _this.componentChange = function (_a) {\n      var name = _a.name,\n          value = _a.value;\n      var v = Vec3.copy(Vec3.zero(), _this.props.value);\n      v[+name] = value;\n\n      _this.change(v);\n    };\n\n    _this.toggleExpanded = function (e) {\n      _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n\n      e.currentTarget.blur();\n    };\n\n    return _this;\n  }\n\n  Vec3Control.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: value\n    });\n  };\n\n  Vec3Control.prototype.render = function () {\n    var v = this.props.value;\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    var p = getPrecision(this.props.param.step || 0.01);\n    var value = \"[\" + v[0].toFixed(p) + \", \" + v[1].toFixed(p) + \", \" + v[2].toFixed(p) + \"]\";\n    return _jsxs(_Fragment, {\n      children: [_jsx(ControlRow, {\n        label: label,\n        control: _jsx(\"button\", __assign({\n          onClick: this.toggleExpanded,\n          disabled: this.props.isDisabled\n        }, {\n          children: value\n        }), void 0)\n      }, void 0), this.state.isExpanded && _jsx(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: _jsx(ParameterControls, {\n          params: this.components,\n          values: v,\n          onChange: this.componentChange,\n          onEnter: this.props.onEnter\n        }, void 0)\n      }), void 0)]\n    }, void 0);\n  };\n\n  return Vec3Control;\n}(React.PureComponent);\n\nexport { Vec3Control };\n\nvar Mat4Control =\n/** @class */\nfunction (_super) {\n  __extends(Mat4Control, _super);\n\n  function Mat4Control() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: false\n    };\n    _this.components = {\n      json: PD.Text(JSON.stringify(Mat4()), {\n        description: 'JSON array with 4x4 matrix in a column major (j * 4 + i indexing) format'\n      })\n    };\n\n    _this.componentChange = function (_a) {\n      var name = _a.name,\n          value = _a.value;\n      var v = Mat4.copy(Mat4(), _this.props.value);\n\n      if (name === 'json') {\n        Mat4.copy(v, JSON.parse(value));\n      } else {\n        v[+name] = value;\n      }\n\n      _this.change(v);\n    };\n\n    _this.toggleExpanded = function (e) {\n      _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n\n      e.currentTarget.blur();\n    };\n\n    return _this;\n  }\n\n  Mat4Control.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: value\n    });\n  };\n\n  Mat4Control.prototype.changeValue = function (idx) {\n    var _this = this;\n\n    return function (v) {\n      var m = Mat4.copy(Mat4(), _this.props.value);\n      m[idx] = v;\n\n      _this.change(m);\n    };\n  };\n\n  Object.defineProperty(Mat4Control.prototype, \"grid\", {\n    get: function () {\n      var v = this.props.value;\n      var rows = [];\n\n      for (var i = 0; i < 4; i++) {\n        var row = [];\n\n        for (var j = 0; j < 4; j++) {\n          row.push(_jsx(TextInput, {\n            numeric: true,\n            delayMs: 50,\n            value: Mat4.getValue(v, i, j),\n            onChange: this.changeValue(4 * j + i),\n            className: 'msp-form-control',\n            blurOnEnter: true,\n            isDisabled: this.props.isDisabled\n          }, j));\n        }\n\n        rows.push(_jsx(\"div\", __assign({\n          className: 'msp-flex-row'\n        }, {\n          children: row\n        }), i));\n      }\n\n      return _jsx(\"div\", __assign({\n        className: 'msp-parameter-matrix'\n      }, {\n        children: rows\n      }), void 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  Mat4Control.prototype.render = function () {\n    var v = {\n      json: JSON.stringify(this.props.value)\n    };\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    return _jsxs(_Fragment, {\n      children: [_jsx(ControlRow, {\n        label: label,\n        control: _jsx(\"button\", __assign({\n          onClick: this.toggleExpanded,\n          disabled: this.props.isDisabled\n        }, {\n          children: '4\\u00D74 Matrix'\n        }), void 0)\n      }, void 0), this.state.isExpanded && _jsxs(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: [this.grid, _jsx(ParameterControls, {\n          params: this.components,\n          values: v,\n          onChange: this.componentChange,\n          onEnter: this.props.onEnter\n        }, void 0)]\n      }), void 0)]\n    }, void 0);\n  };\n\n  return Mat4Control;\n}(React.PureComponent);\n\nexport { Mat4Control };\n\nvar UrlControl =\n/** @class */\nfunction (_super) {\n  __extends(UrlControl, _super);\n\n  function UrlControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (e) {\n      var value = e.target.value;\n\n      if (value !== Asset.getUrl(_this.props.value || '')) {\n        _this.update(Asset.Url(value));\n      }\n    };\n\n    _this.onKeyPress = function (e) {\n      if (e.keyCode === 13 || e.charCode === 13 || e.key === 'Enter') {\n        if (_this.props.onEnter) _this.props.onEnter();\n      }\n\n      e.stopPropagation();\n    };\n\n    return _this;\n  }\n\n  UrlControl.prototype.renderControl = function () {\n    var placeholder = this.props.param.label || camelCaseToWords(this.props.name);\n    return _jsx(\"input\", {\n      type: 'text',\n      value: Asset.getUrl(this.props.value || ''),\n      placeholder: placeholder,\n      onChange: this.onChange,\n      onKeyPress: this.props.onEnter ? this.onKeyPress : void 0,\n      disabled: this.props.isDisabled\n    }, void 0);\n  };\n\n  return UrlControl;\n}(SimpleParam);\n\nexport { UrlControl };\n\nvar FileControl =\n/** @class */\nfunction (_super) {\n  __extends(FileControl, _super);\n\n  function FileControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      showHelp: false\n    };\n\n    _this.onChangeFile = function (e) {\n      _this.change(e.target.files[0]);\n    };\n\n    _this.toggleHelp = function () {\n      return _this.setState({\n        showHelp: !_this.state.showHelp\n      });\n    };\n\n    return _this;\n  }\n\n  FileControl.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: Asset.File(value)\n    });\n  };\n\n  FileControl.prototype.renderControl = function () {\n    var value = this.props.value;\n    return _jsxs(\"div\", __assign({\n      className: 'msp-btn msp-btn-block msp-btn-action msp-loader-msp-btn-file',\n      style: {\n        marginTop: '1px'\n      }\n    }, {\n      children: [value ? value.name : 'Select a file...', \" \", _jsx(\"input\", {\n        disabled: this.props.isDisabled,\n        onChange: this.onChangeFile,\n        type: 'file',\n        multiple: false,\n        accept: this.props.param.accept\n      }, void 0)]\n    }), void 0);\n  };\n\n  FileControl.prototype.render = function () {\n    if (this.props.param.label) {\n      return renderSimple({\n        props: this.props,\n        state: this.state,\n        control: this.renderControl(),\n        toggleHelp: this.toggleHelp,\n        addOn: null\n      });\n    } else {\n      return this.renderControl();\n    }\n  };\n\n  return FileControl;\n}(React.PureComponent);\n\nexport { FileControl };\n\nvar FileListControl =\n/** @class */\nfunction (_super) {\n  __extends(FileListControl, _super);\n\n  function FileListControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      showHelp: false\n    };\n\n    _this.onChangeFileList = function (e) {\n      _this.change(e.target.files);\n    };\n\n    _this.toggleHelp = function () {\n      return _this.setState({\n        showHelp: !_this.state.showHelp\n      });\n    };\n\n    return _this;\n  }\n\n  FileListControl.prototype.change = function (value) {\n    var files = [];\n\n    if (value) {\n      for (var i = 0, il = value.length; i < il; ++i) {\n        files.push(Asset.File(value[i]));\n      }\n    }\n\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: files\n    });\n  };\n\n  FileListControl.prototype.renderControl = function () {\n    var value = this.props.value;\n    var names = [];\n\n    if (value) {\n      for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\n        var file = value_1[_i];\n        names.push(file.name);\n      }\n    }\n\n    var label = names.length === 0 ? 'Select files...' : names.length === 1 ? names[0] : names.length + \" files selected\";\n    return _jsxs(\"div\", __assign({\n      className: 'msp-btn msp-btn-block msp-btn-action msp-loader-msp-btn-file',\n      style: {\n        marginTop: '1px'\n      }\n    }, {\n      children: [label, \" \", _jsx(\"input\", {\n        disabled: this.props.isDisabled,\n        onChange: this.onChangeFileList,\n        type: 'file',\n        multiple: true,\n        accept: this.props.param.accept\n      }, void 0)]\n    }), void 0);\n  };\n\n  FileListControl.prototype.render = function () {\n    if (this.props.param.label) {\n      return renderSimple({\n        props: this.props,\n        state: this.state,\n        control: this.renderControl(),\n        toggleHelp: this.toggleHelp,\n        addOn: null\n      });\n    } else {\n      return this.renderControl();\n    }\n  };\n\n  return FileListControl;\n}(React.PureComponent);\n\nexport { FileListControl };\n\nvar MultiSelectControl =\n/** @class */\nfunction (_super) {\n  __extends(MultiSelectControl, _super);\n\n  function MultiSelectControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: false\n    };\n\n    _this.toggleExpanded = function (e) {\n      _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n\n      e.currentTarget.blur();\n    };\n\n    return _this;\n  }\n\n  MultiSelectControl.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: value\n    });\n  };\n\n  MultiSelectControl.prototype.toggle = function (key) {\n    var _this = this;\n\n    return function (e) {\n      if (_this.props.value.indexOf(key) < 0) _this.change(_this.props.value.concat(key));else _this.change(_this.props.value.filter(function (v) {\n        return v !== key;\n      }));\n      e.currentTarget.blur();\n    };\n  };\n\n  MultiSelectControl.prototype.render = function () {\n    var _this = this;\n\n    var current = this.props.value;\n    var emptyLabel = this.props.param.emptyValue;\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    return _jsxs(_Fragment, {\n      children: [_jsx(ControlRow, {\n        label: label,\n        control: _jsx(\"button\", __assign({\n          onClick: this.toggleExpanded,\n          disabled: this.props.isDisabled\n        }, {\n          children: current.length === 0 && emptyLabel ? emptyLabel : current.length + \" of \" + this.props.param.options.length\n        }), void 0)\n      }, void 0), this.state.isExpanded && _jsx(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: this.props.param.options.map(function (_a) {\n          var value = _a[0],\n              label = _a[1];\n          var sel = current.indexOf(value) >= 0;\n          return _jsx(Button, __assign({\n            onClick: _this.toggle(value),\n            disabled: _this.props.isDisabled,\n            style: {\n              marginTop: '1px'\n            }\n          }, {\n            children: _jsx(\"span\", __assign({\n              style: {\n                float: sel ? 'left' : 'right'\n              }\n            }, {\n              children: sel ? \"\\u2713 \" + label : label + \" \\u2717\"\n            }), void 0)\n          }), value);\n        })\n      }), void 0)]\n    }, void 0);\n  };\n\n  return MultiSelectControl;\n}(React.PureComponent);\n\nexport { MultiSelectControl };\n\nvar GroupControl =\n/** @class */\nfunction (_super) {\n  __extends(GroupControl, _super);\n\n  function GroupControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: !!_this.props.param.isExpanded,\n      showHelp: false\n    };\n\n    _this.onChangeParam = function (e) {\n      var _a;\n\n      _this.change(__assign(__assign({}, _this.props.value), (_a = {}, _a[e.name] = e.value, _a)));\n    };\n\n    _this.toggleExpanded = function () {\n      return _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n    };\n\n    return _this;\n  }\n\n  GroupControl.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: value\n    });\n  };\n\n  GroupControl.prototype.pivoted = function () {\n    var key = this.props.param.pivot;\n    var params = this.props.param.params;\n    var pivot = params[key];\n    var Control = controlFor(pivot);\n\n    var ctrl = _jsx(Control, {\n      name: key,\n      param: pivot,\n      value: this.props.value[key],\n      onChange: this.onChangeParam,\n      onEnter: this.props.onEnter,\n      isDisabled: this.props.isDisabled\n    }, void 0);\n\n    if (!this.state.isExpanded) {\n      return _jsxs(\"div\", __assign({\n        className: 'msp-mapped-parameter-group'\n      }, {\n        children: [ctrl, _jsx(IconButton, {\n          svg: MoreHorizSvg,\n          onClick: this.toggleExpanded,\n          toggleState: this.state.isExpanded,\n          title: \"More Options\"\n        }, void 0)]\n      }), void 0);\n    }\n\n    var filtered = Object.create(null);\n\n    for (var _i = 0, _a = Object.keys(params); _i < _a.length; _i++) {\n      var k = _a[_i];\n      if (k !== key) filtered[k] = params[k];\n    }\n\n    return _jsxs(\"div\", __assign({\n      className: 'msp-mapped-parameter-group'\n    }, {\n      children: [ctrl, _jsx(IconButton, {\n        svg: MoreHorizSvg,\n        onClick: this.toggleExpanded,\n        toggleState: this.state.isExpanded,\n        title: \"More Options\"\n      }, void 0), _jsx(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: _jsx(ParameterControls, {\n          params: filtered,\n          onEnter: this.props.onEnter,\n          values: this.props.value,\n          onChange: this.onChangeParam,\n          isDisabled: this.props.isDisabled\n        }, void 0)\n      }), void 0)]\n    }), void 0);\n  };\n\n  GroupControl.prototype.render = function () {\n    var params = this.props.param.params; // Do not show if there are no params.\n\n    if (Object.keys(params).length === 0) return null;\n    if (this.props.param.pivot) return this.pivoted();\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n\n    var controls = _jsx(ParameterControls, {\n      params: params,\n      onChange: this.onChangeParam,\n      values: this.props.value,\n      onEnter: this.props.onEnter,\n      isDisabled: this.props.isDisabled\n    }, void 0);\n\n    if (this.props.inMapped) {\n      return _jsx(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: controls\n      }), void 0);\n    }\n\n    if (this.props.param.isFlat) {\n      return controls;\n    }\n\n    return _jsxs(\"div\", __assign({\n      className: 'msp-control-group-wrapper'\n    }, {\n      children: [_jsx(\"div\", __assign({\n        className: 'msp-control-group-header'\n      }, {\n        children: _jsxs(\"button\", __assign({\n          className: 'msp-btn msp-form-control msp-btn-block',\n          onClick: this.toggleExpanded\n        }, {\n          children: [_jsx(Icon, {\n            svg: this.state.isExpanded ? ArrowDropDownSvg : ArrowRightSvg\n          }, void 0), label]\n        }), void 0)\n      }), void 0), this.state.isExpanded && _jsx(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: controls\n      }), void 0)]\n    }), void 0);\n  };\n\n  return GroupControl;\n}(React.PureComponent);\n\nexport { GroupControl };\n\nvar MappedControl =\n/** @class */\nfunction (_super) {\n  __extends(MappedControl, _super);\n\n  function MappedControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: false\n    }; // TODO: this could lead to a rare bug where the component is reused with different mapped control.\n    // I think there are currently no cases where this could happen in the UI, but still need to watch out..\n\n    _this.valuesCache = {};\n\n    _this.onChangeName = function (e) {\n      _this.change({\n        name: e.value,\n        params: _this.getValues(e.value)\n      });\n    };\n\n    _this.onChangeParam = function (e) {\n      _this.setValues(_this.props.value.name, e.value);\n\n      _this.change({\n        name: _this.props.value.name,\n        params: e.value\n      });\n    };\n\n    _this.toggleExpanded = function () {\n      return _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n    };\n\n    return _this;\n  }\n\n  MappedControl.prototype.setValues = function (name, values) {\n    this.valuesCache[name] = values;\n  };\n\n  MappedControl.prototype.getValues = function (name) {\n    if (name in this.valuesCache) {\n      return this.valuesCache[name];\n    } else {\n      return this.props.param.map(name).defaultValue;\n    }\n  };\n\n  MappedControl.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: value\n    });\n  };\n\n  MappedControl.prototype.areParamsEmpty = function (params) {\n    for (var _i = 0, _a = Object.keys(params); _i < _a.length; _i++) {\n      var k = _a[_i];\n      if (!params[k].isHidden) return false;\n    }\n\n    return true;\n  };\n\n  MappedControl.prototype.render = function () {\n    var _this = this;\n\n    var value = this.props.value || this.props.param.defaultValue;\n    var param = this.props.param.map(value.name);\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    var Mapped = controlFor(param);\n    var help = this.props.param.help;\n    var select = help ? __assign(__assign({}, this.props.param.select), {\n      help: function (name) {\n        return help({\n          name: name,\n          params: _this.getValues(name)\n        });\n      }\n    }) : this.props.param.select;\n\n    var Select = _jsx(SelectControl, {\n      param: select,\n      isDisabled: this.props.isDisabled,\n      onChange: this.onChangeName,\n      onEnter: this.props.onEnter,\n      name: label,\n      value: value.name\n    }, void 0);\n\n    if (!Mapped) {\n      return Select;\n    }\n\n    if (param.type === 'group' && !param.isFlat) {\n      if (!this.areParamsEmpty(param.params)) {\n        return _jsxs(\"div\", __assign({\n          className: 'msp-mapped-parameter-group'\n        }, {\n          children: [Select, _jsx(IconButton, {\n            svg: MoreHorizSvg,\n            onClick: this.toggleExpanded,\n            toggleState: this.state.isExpanded,\n            title: label + \" Properties\"\n          }, void 0), this.state.isExpanded && _jsx(GroupControl, {\n            inMapped: true,\n            param: param,\n            value: value.params,\n            name: value.name,\n            onChange: this.onChangeParam,\n            onEnter: this.props.onEnter,\n            isDisabled: this.props.isDisabled\n          }, void 0)]\n        }), void 0);\n      }\n\n      return Select;\n    }\n\n    return _jsxs(_Fragment, {\n      children: [Select, _jsx(Mapped, {\n        param: param,\n        value: value.params,\n        name: value.name,\n        onChange: this.onChangeParam,\n        onEnter: this.props.onEnter,\n        isDisabled: this.props.isDisabled\n      }, void 0)]\n    }, void 0);\n  };\n\n  return MappedControl;\n}(React.PureComponent);\n\nexport { MappedControl };\n\nvar ObjectListEditor =\n/** @class */\nfunction (_super) {\n  __extends(ObjectListEditor, _super);\n\n  function ObjectListEditor() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      current: _this.props.value\n    };\n\n    _this.onChangeParam = function (e) {\n      var _a;\n\n      _this.setState({\n        current: __assign(__assign({}, _this.state.current), (_a = {}, _a[e.name] = e.value, _a))\n      });\n    };\n\n    _this.apply = function () {\n      _this.props.apply(_this.state.current);\n    };\n\n    return _this;\n  }\n\n  ObjectListEditor.prototype.componentDidUpdate = function (prevProps) {\n    if (this.props.params !== prevProps.params || this.props.value !== prevProps.value) {\n      this.setState({\n        current: this.props.value\n      });\n    }\n  };\n\n  ObjectListEditor.prototype.render = function () {\n    return _jsxs(_Fragment, {\n      children: [_jsx(ParameterControls, {\n        params: this.props.params,\n        onChange: this.onChangeParam,\n        values: this.state.current,\n        onEnter: this.apply,\n        isDisabled: this.props.isDisabled\n      }, void 0), _jsx(\"button\", __assign({\n        className: \"msp-btn msp-btn-block msp-form-control msp-control-top-offset\",\n        onClick: this.apply,\n        disabled: this.props.isDisabled\n      }, {\n        children: this.props.isUpdate ? 'Update' : 'Add'\n      }), void 0)]\n    }, void 0);\n  };\n\n  return ObjectListEditor;\n}(React.PureComponent);\n\nvar ObjectListItem =\n/** @class */\nfunction (_super) {\n  __extends(ObjectListItem, _super);\n\n  function ObjectListItem() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: false\n    };\n\n    _this.update = function (v) {\n      // this.setState({ isExpanded: false }); // TODO auto update? mark changed state?\n      _this.props.actions.update(v, _this.props.index);\n    };\n\n    _this.moveUp = function () {\n      _this.props.actions.move(_this.props.index, -1);\n    };\n\n    _this.moveDown = function () {\n      _this.props.actions.move(_this.props.index, 1);\n    };\n\n    _this.remove = function () {\n      _this.setState({\n        isExpanded: false\n      });\n\n      _this.props.actions.remove(_this.props.index);\n    };\n\n    _this.toggleExpanded = function (e) {\n      _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n\n      e.currentTarget.blur();\n    };\n\n    return _this;\n  }\n\n  ObjectListItem.prototype.render = function () {\n    return _jsxs(_Fragment, {\n      children: [_jsxs(\"div\", __assign({\n        className: 'msp-param-object-list-item'\n      }, {\n        children: [_jsxs(\"button\", __assign({\n          className: 'msp-btn msp-btn-block msp-form-control',\n          onClick: this.toggleExpanded\n        }, {\n          children: [_jsx(\"span\", {\n            children: this.props.index + 1 + \": \"\n          }, void 0), this.props.param.getLabel(this.props.value)]\n        }), void 0), _jsxs(\"div\", {\n          children: [_jsx(IconButton, {\n            svg: ArrowDownwardSvg,\n            title: 'Move Up',\n            onClick: this.moveUp,\n            small: true\n          }, void 0), _jsx(IconButton, {\n            svg: ArrowUpwardSvg,\n            title: 'Move Down',\n            onClick: this.moveDown,\n            small: true\n          }, void 0), _jsx(IconButton, {\n            svg: DeleteOutlinedSvg,\n            title: 'Remove',\n            onClick: this.remove,\n            small: true\n          }, void 0)]\n        }, void 0)]\n      }), void 0), this.state.isExpanded && _jsx(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: _jsx(ObjectListEditor, {\n          params: this.props.param.element,\n          apply: this.update,\n          value: this.props.value,\n          isUpdate: true,\n          isDisabled: this.props.isDisabled\n        }, void 0)\n      }), void 0)]\n    }, void 0);\n  };\n\n  return ObjectListItem;\n}(React.PureComponent);\n\nvar ObjectListControl =\n/** @class */\nfunction (_super) {\n  __extends(ObjectListControl, _super);\n\n  function ObjectListControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      isExpanded: false\n    };\n\n    _this.add = function (v) {\n      _this.change(__spreadArray(__spreadArray([], _this.props.value, true), [v], false));\n    };\n\n    _this.actions = {\n      update: function (v, i) {\n        var value = _this.props.value.slice(0);\n\n        value[i] = v;\n\n        _this.change(value);\n      },\n      move: function (i, dir) {\n        var xs = _this.props.value;\n        if (xs.length === 1) return;\n        var j = (i + dir) % xs.length;\n        if (j < 0) j += xs.length;\n        xs = xs.slice(0);\n        var t = xs[i];\n        xs[i] = xs[j];\n        xs[j] = t;\n\n        _this.change(xs);\n      },\n      remove: function (i) {\n        var xs = _this.props.value;\n        var update = [];\n\n        for (var j = 0; j < xs.length; j++) {\n          if (i !== j) update.push(xs[j]);\n        }\n\n        _this.change(update);\n      }\n    };\n\n    _this.toggleExpanded = function (e) {\n      _this.setState({\n        isExpanded: !_this.state.isExpanded\n      });\n\n      e.currentTarget.blur();\n    };\n\n    return _this;\n  }\n\n  ObjectListControl.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: value\n    });\n  };\n\n  ObjectListControl.prototype.render = function () {\n    var _this = this;\n\n    var v = this.props.value;\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    var value = v.length + \" item\" + (v.length !== 1 ? 's' : '');\n    return _jsxs(_Fragment, {\n      children: [_jsx(ControlRow, {\n        label: label,\n        control: _jsx(\"button\", __assign({\n          onClick: this.toggleExpanded,\n          disabled: this.props.isDisabled\n        }, {\n          children: value\n        }), void 0)\n      }, void 0), this.state.isExpanded && _jsxs(\"div\", __assign({\n        className: 'msp-control-offset'\n      }, {\n        children: [this.props.value.map(function (v, i) {\n          return _jsx(ObjectListItem, {\n            param: _this.props.param,\n            value: v,\n            index: i,\n            actions: _this.actions,\n            isDisabled: _this.props.isDisabled\n          }, i);\n        }), _jsx(ControlGroup, __assign({\n          header: 'New Item'\n        }, {\n          children: _jsx(ObjectListEditor, {\n            params: this.props.param.element,\n            apply: this.add,\n            value: this.props.param.ctor(),\n            isDisabled: this.props.isDisabled\n          }, void 0)\n        }), void 0)]\n      }), void 0)]\n    }, void 0);\n  };\n\n  return ObjectListControl;\n}(React.PureComponent);\n\nexport { ObjectListControl };\n\nvar ConditionedControl =\n/** @class */\nfunction (_super) {\n  __extends(ConditionedControl, _super);\n\n  function ConditionedControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChangeCondition = function (e) {\n      _this.change(_this.props.param.conditionedValue(_this.props.value, e.value));\n    };\n\n    _this.onChangeParam = function (e) {\n      _this.change(e.value);\n    };\n\n    return _this;\n  }\n\n  ConditionedControl.prototype.change = function (value) {\n    this.props.onChange({\n      name: this.props.name,\n      param: this.props.param,\n      value: value\n    });\n  };\n\n  ConditionedControl.prototype.render = function () {\n    var value = this.props.value;\n    var condition = this.props.param.conditionForValue(value);\n    var param = this.props.param.conditionParams[condition];\n    var label = this.props.param.label || camelCaseToWords(this.props.name);\n    var Conditioned = controlFor(param);\n\n    var select = _jsx(SelectControl, {\n      param: this.props.param.select,\n      isDisabled: this.props.isDisabled,\n      onChange: this.onChangeCondition,\n      onEnter: this.props.onEnter,\n      name: label + \" Kind\",\n      value: condition\n    }, void 0);\n\n    if (!Conditioned) {\n      return select;\n    }\n\n    return _jsxs(_Fragment, {\n      children: [select, _jsx(Conditioned, {\n        param: param,\n        value: value,\n        name: label,\n        onChange: this.onChangeParam,\n        onEnter: this.props.onEnter,\n        isDisabled: this.props.isDisabled\n      }, void 0)]\n    }, void 0);\n  };\n\n  return ConditionedControl;\n}(React.PureComponent);\n\nexport { ConditionedControl };\n\nvar ConvertedControl =\n/** @class */\nfunction (_super) {\n  __extends(ConvertedControl, _super);\n\n  function ConvertedControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (e) {\n      _this.props.onChange({\n        name: _this.props.name,\n        param: _this.props.param,\n        value: _this.props.param.toValue(e.value)\n      });\n    };\n\n    return _this;\n  }\n\n  ConvertedControl.prototype.render = function () {\n    var value = this.props.param.fromValue(this.props.value);\n    var Converted = controlFor(this.props.param.converted);\n    if (!Converted) return null;\n    return _jsx(Converted, {\n      param: this.props.param.converted,\n      value: value,\n      name: this.props.name,\n      onChange: this.onChange,\n      onEnter: this.props.onEnter,\n      isDisabled: this.props.isDisabled\n    }, void 0);\n  };\n\n  return ConvertedControl;\n}(React.PureComponent);\n\nexport { ConvertedControl };\n\nvar ScriptControl =\n/** @class */\nfunction (_super) {\n  __extends(ScriptControl, _super);\n\n  function ScriptControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.onChange = function (e) {\n      var value = e.target.value;\n\n      if (value !== _this.props.value.expression) {\n        _this.update({\n          language: _this.props.value.language,\n          expression: value\n        });\n      }\n    };\n\n    _this.onKeyPress = function (e) {\n      if (e.keyCode === 13 || e.charCode === 13 || e.key === 'Enter') {\n        if (_this.props.onEnter) _this.props.onEnter();\n      }\n\n      e.stopPropagation();\n    };\n\n    return _this;\n  }\n\n  ScriptControl.prototype.renderControl = function () {\n    // TODO: improve!\n    var placeholder = this.props.param.label || camelCaseToWords(this.props.name);\n    return _jsx(\"input\", {\n      type: 'text',\n      value: this.props.value.expression || '',\n      placeholder: placeholder,\n      onChange: this.onChange,\n      onKeyPress: this.props.onEnter ? this.onKeyPress : void 0,\n      disabled: this.props.isDisabled\n    }, void 0);\n  };\n\n  return ScriptControl;\n}(SimpleParam);\n\nexport { ScriptControl };","map":{"version":3,"sources":["../../../src/mol-plugin-ui/controls/parameters.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __extends, __spreadArray } from \"tslib\";\r\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\r\n/**\r\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\r\nimport * as React from 'react';\r\nimport { Mat4, Vec3 } from '../../mol-math/linear-algebra';\r\nimport { Color } from '../../mol-util/color';\r\nimport { ColorListOptions, ColorListOptionsScale, ColorListOptionsSet, getColorListFromName } from '../../mol-util/color/lists';\r\nimport { memoize1, memoizeLatest } from '../../mol-util/memoize';\r\nimport { getPrecision } from '../../mol-util/number';\r\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\r\nimport { camelCaseToWords } from '../../mol-util/string';\r\nimport { PluginUIComponent } from '../base';\r\nimport { ActionMenu } from './action-menu';\r\nimport { ColorOptions, ColorValueOption, CombinedColorControl } from './color';\r\nimport { Button, ControlGroup, ControlRow, ExpandGroup, IconButton, TextInput, ToggleButton } from './common';\r\nimport { Icon, HelpOutlineSvg, CheckSvg, ClearSvg, BookmarksOutlinedSvg, MoreHorizSvg, ArrowDropDownSvg, ArrowRightSvg, ArrowDownwardSvg, ArrowUpwardSvg, DeleteOutlinedSvg } from './icons';\r\nimport { legendFor } from './legend';\r\nimport { LineGraphComponent } from './line-graph/line-graph-component';\r\nimport { Slider, Slider2 } from './slider';\r\nimport { Asset } from '../../mol-util/assets';\r\nvar ParameterControls = /** @class */ (function (_super) {\r\n    __extends(ParameterControls, _super);\r\n    function ParameterControls() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (params) {\r\n            var _a;\r\n            var _b, _c;\r\n            (_c = (_b = _this.props).onChange) === null || _c === void 0 ? void 0 : _c.call(_b, params, _this.props.values);\r\n            if (_this.props.onChangeValues) {\r\n                var values = __assign(__assign({}, _this.props.values), (_a = {}, _a[params.name] = params.value, _a));\r\n                _this.props.onChangeValues(values, _this.props.values);\r\n            }\r\n        };\r\n        _this.paramGroups = memoizeLatest(function (params) { return classifyParams(params); });\r\n        return _this;\r\n    }\r\n    ParameterControls.prototype.renderGroup = function (group) {\r\n        var _a;\r\n        if (group.length === 0)\r\n            return null;\r\n        var values = this.props.values;\r\n        var ctrls = null;\r\n        var category = void 0;\r\n        for (var _i = 0, group_1 = group; _i < group_1.length; _i++) {\r\n            var _b = group_1[_i], key = _b[0], p = _b[1], Control = _b[2];\r\n            if ((_a = p.hideIf) === null || _a === void 0 ? void 0 : _a.call(p, values))\r\n                continue;\r\n            if (!ctrls)\r\n                ctrls = [];\r\n            category = p.category;\r\n            ctrls.push(_jsx(Control, { param: p, onChange: this.onChange, onEnter: this.props.onEnter, isDisabled: this.props.isDisabled, name: key, value: values[key] }, key));\r\n        }\r\n        if (!ctrls)\r\n            return null;\r\n        if (category) {\r\n            return [_jsx(ExpandGroup, __assign({ header: category }, { children: ctrls }), category)];\r\n        }\r\n        return ctrls;\r\n    };\r\n    ParameterControls.prototype.renderPart = function (groups) {\r\n        var parts = null;\r\n        for (var _i = 0, groups_1 = groups; _i < groups_1.length; _i++) {\r\n            var g = groups_1[_i];\r\n            var ctrls = this.renderGroup(g);\r\n            if (!ctrls)\r\n                continue;\r\n            if (!parts)\r\n                parts = [];\r\n            for (var _a = 0, ctrls_1 = ctrls; _a < ctrls_1.length; _a++) {\r\n                var c = ctrls_1[_a];\r\n                parts.push(c);\r\n            }\r\n        }\r\n        return parts;\r\n    };\r\n    ParameterControls.prototype.render = function () {\r\n        var groups = this.paramGroups(this.props.params);\r\n        var essentials = this.renderPart(groups.essentials);\r\n        var advanced = this.renderPart(groups.advanced);\r\n        if (essentials && advanced) {\r\n            return _jsxs(_Fragment, { children: [essentials, _jsx(ExpandGroup, __assign({ header: 'Advanced Options' }, { children: advanced }), void 0)] }, void 0);\r\n        }\r\n        else if (essentials) {\r\n            return essentials;\r\n        }\r\n        else {\r\n            return advanced;\r\n        }\r\n    };\r\n    return ParameterControls;\r\n}(React.PureComponent));\r\nexport { ParameterControls };\r\nvar ParameterMappingControl = /** @class */ (function (_super) {\r\n    __extends(ParameterMappingControl, _super);\r\n    function ParameterMappingControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.setSettings = function (p, old) {\r\n            var _a;\r\n            var values = __assign(__assign({}, old), (_a = {}, _a[p.name] = p.value, _a));\r\n            var t = _this.props.mapping.update(values, _this.plugin);\r\n            _this.props.mapping.apply(t, _this.plugin);\r\n        };\r\n        return _this;\r\n    }\r\n    ParameterMappingControl.prototype.componentDidMount = function () {\r\n        var _this = this;\r\n        this.subscribe(this.plugin.events.canvas3d.settingsUpdated, function () { return _this.forceUpdate(); });\r\n    };\r\n    ParameterMappingControl.prototype.render = function () {\r\n        var t = this.props.mapping.getTarget(this.plugin);\r\n        var values = this.props.mapping.getValues(t, this.plugin);\r\n        var params = this.props.mapping.params(this.plugin);\r\n        return _jsx(ParameterControls, { params: params, values: values, onChange: this.setSettings }, void 0);\r\n    };\r\n    return ParameterMappingControl;\r\n}(PluginUIComponent));\r\nexport { ParameterMappingControl };\r\nfunction classifyParams(params) {\r\n    function addParam(k, p, group) {\r\n        var ctrl = controlFor(p);\r\n        if (!ctrl)\r\n            return;\r\n        if (!p.category)\r\n            group.params[0].push([k, p, ctrl]);\r\n        else {\r\n            if (!group.map)\r\n                group.map = new Map();\r\n            var c = group.map.get(p.category);\r\n            if (!c) {\r\n                c = [];\r\n                group.map.set(p.category, c);\r\n                group.params.push(c);\r\n            }\r\n            c.push([k, p, ctrl]);\r\n        }\r\n    }\r\n    function sortGroups(x, y) {\r\n        var a = x[0], b = y[0];\r\n        if (!a || !a[1].category)\r\n            return -1;\r\n        if (!b || !b[1].category)\r\n            return 1;\r\n        return a[1].category < b[1].category ? -1 : 1;\r\n    }\r\n    var keys = Object.keys(params);\r\n    var essentials = { params: [[]], map: void 0 };\r\n    var advanced = { params: [[]], map: void 0 };\r\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n        var k = keys_1[_i];\r\n        var p = params[k];\r\n        if (p.isHidden)\r\n            continue;\r\n        if (p.isEssential)\r\n            addParam(k, p, essentials);\r\n        else\r\n            addParam(k, p, advanced);\r\n    }\r\n    essentials.params.sort(sortGroups);\r\n    advanced.params.sort(sortGroups);\r\n    return { essentials: essentials.params, advanced: advanced.params };\r\n}\r\nfunction controlFor(param) {\r\n    switch (param.type) {\r\n        case 'value': return void 0;\r\n        case 'boolean': return BoolControl;\r\n        case 'number': return typeof param.min !== 'undefined' && typeof param.max !== 'undefined'\r\n            ? NumberRangeControl : NumberInputControl;\r\n        case 'converted': return ConvertedControl;\r\n        case 'conditioned': return ConditionedControl;\r\n        case 'multi-select': return MultiSelectControl;\r\n        case 'color': return CombinedColorControl;\r\n        case 'color-list': return param.offsets ? OffsetColorListControl : ColorListControl;\r\n        case 'vec3': return Vec3Control;\r\n        case 'mat4': return Mat4Control;\r\n        case 'url': return UrlControl;\r\n        case 'file': return FileControl;\r\n        case 'file-list': return FileListControl;\r\n        case 'select': return SelectControl;\r\n        case 'value-ref': return ValueRefControl;\r\n        case 'data-ref': return void 0;\r\n        case 'text': return TextControl;\r\n        case 'interval': return typeof param.min !== 'undefined' && typeof param.max !== 'undefined'\r\n            ? BoundedIntervalControl : IntervalControl;\r\n        case 'group': return GroupControl;\r\n        case 'mapped': return MappedControl;\r\n        case 'line-graph': return LineGraphControl;\r\n        case 'script': return ScriptControl;\r\n        case 'object-list': return ObjectListControl;\r\n        default:\r\n            var _ = param;\r\n            console.warn(_ + \" has no associated UI component\");\r\n            return void 0;\r\n    }\r\n}\r\nvar ParamHelp = /** @class */ (function (_super) {\r\n    __extends(ParamHelp, _super);\r\n    function ParamHelp() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ParamHelp.prototype.render = function () {\r\n        var _a = this.props, legend = _a.legend, description = _a.description;\r\n        var Legend = legend && legendFor(legend);\r\n        return _jsx(\"div\", __assign({ className: 'msp-help-text' }, { children: _jsxs(\"div\", { children: [_jsxs(\"div\", __assign({ className: 'msp-help-description' }, { children: [_jsx(Icon, { svg: HelpOutlineSvg, inline: true }, void 0), description] }), void 0), Legend && _jsx(\"div\", __assign({ className: 'msp-help-legend' }, { children: _jsx(Legend, { legend: legend }, void 0) }), void 0)] }, void 0) }), void 0);\r\n    };\r\n    return ParamHelp;\r\n}(React.PureComponent));\r\nexport { ParamHelp };\r\nfunction renderSimple(options) {\r\n    var props = options.props, state = options.state, control = options.control, toggleHelp = options.toggleHelp, addOn = options.addOn;\r\n    var _className = [];\r\n    if (props.param.shortLabel)\r\n        _className.push('msp-control-label-short');\r\n    if (props.param.twoColumns)\r\n        _className.push('msp-control-col-2');\r\n    var className = _className.join(' ');\r\n    var label = props.param.label || camelCaseToWords(props.name);\r\n    var help = props.param.help\r\n        ? props.param.help(props.value)\r\n        : { description: props.param.description, legend: props.param.legend };\r\n    var hasHelp = help.description || help.legend;\r\n    var desc = label + (hasHelp ? '. Click for help.' : '');\r\n    return _jsxs(_Fragment, { children: [_jsx(ControlRow, { className: className, title: desc, label: _jsxs(_Fragment, { children: [label, hasHelp &&\r\n                            _jsx(\"button\", __assign({ className: 'msp-help msp-btn-link msp-btn-icon msp-control-group-expander', onClick: toggleHelp, title: desc || (state.showHelp ? 'Hide' : 'Show') + \" help\", style: { background: 'transparent', textAlign: 'left', padding: '0' } }, { children: _jsx(Icon, { svg: HelpOutlineSvg }, void 0) }), void 0)] }, void 0), control: control }, void 0), hasHelp && state.showHelp && _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: _jsx(ParamHelp, { legend: help.legend, description: help.description }, void 0) }), void 0), addOn] }, void 0);\r\n}\r\nvar SimpleParam = /** @class */ (function (_super) {\r\n    __extends(SimpleParam, _super);\r\n    function SimpleParam() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { showHelp: false };\r\n        _this.toggleHelp = function () { return _this.setState({ showHelp: !_this.state.showHelp }); };\r\n        return _this;\r\n    }\r\n    SimpleParam.prototype.update = function (value) {\r\n        this.props.onChange({ param: this.props.param, name: this.props.name, value: value });\r\n    };\r\n    SimpleParam.prototype.renderAddOn = function () { return null; };\r\n    SimpleParam.prototype.render = function () {\r\n        return renderSimple({\r\n            props: this.props,\r\n            state: this.state,\r\n            control: this.renderControl(),\r\n            toggleHelp: this.toggleHelp,\r\n            addOn: this.renderAddOn()\r\n        });\r\n    };\r\n    return SimpleParam;\r\n}(React.PureComponent));\r\nexport { SimpleParam };\r\nvar BoolControl = /** @class */ (function (_super) {\r\n    __extends(BoolControl, _super);\r\n    function BoolControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onClick = function (e) { _this.update(!_this.props.value); e.currentTarget.blur(); };\r\n        return _this;\r\n    }\r\n    BoolControl.prototype.renderControl = function () {\r\n        return _jsxs(\"button\", __assign({ onClick: this.onClick, disabled: this.props.isDisabled }, { children: [_jsx(Icon, { svg: this.props.value ? CheckSvg : ClearSvg }, void 0), this.props.value ? 'On' : 'Off'] }), void 0);\r\n    };\r\n    return BoolControl;\r\n}(SimpleParam));\r\nexport { BoolControl };\r\nvar LineGraphControl = /** @class */ (function (_super) {\r\n    __extends(LineGraphControl, _super);\r\n    function LineGraphControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = {\r\n            isExpanded: false,\r\n            isOverPoint: false,\r\n            message: _this.props.param.defaultValue.length + \" points\",\r\n        };\r\n        _this.onHover = function (point) {\r\n            _this.setState({ isOverPoint: !_this.state.isOverPoint });\r\n            if (point) {\r\n                _this.setState({ message: \"(\" + point[0].toFixed(2) + \", \" + point[1].toFixed(2) + \")\" });\r\n                return;\r\n            }\r\n            _this.setState({ message: _this.props.value.length + \" points\" });\r\n        };\r\n        _this.onDrag = function (point) {\r\n            _this.setState({ message: \"(\" + point[0].toFixed(2) + \", \" + point[1].toFixed(2) + \")\" });\r\n        };\r\n        _this.onChange = function (value) {\r\n            _this.props.onChange({ name: _this.props.name, param: _this.props.param, value: value });\r\n        };\r\n        _this.toggleExpanded = function (e) {\r\n            _this.setState({ isExpanded: !_this.state.isExpanded });\r\n            e.currentTarget.blur();\r\n        };\r\n        return _this;\r\n    }\r\n    LineGraphControl.prototype.render = function () {\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        return _jsxs(_Fragment, { children: [_jsx(ControlRow, { label: label, control: _jsx(\"button\", __assign({ onClick: this.toggleExpanded, disabled: this.props.isDisabled }, { children: \"\" + this.state.message }), void 0) }, void 0), _jsx(\"div\", __assign({ className: 'msp-control-offset', style: { display: this.state.isExpanded ? 'block' : 'none' } }, { children: _jsx(LineGraphComponent, { data: this.props.param.defaultValue, onChange: this.onChange, onHover: this.onHover, onDrag: this.onDrag }, void 0) }), void 0)] }, void 0);\r\n    };\r\n    return LineGraphControl;\r\n}(React.PureComponent));\r\nexport { LineGraphControl };\r\nvar NumberInputControl = /** @class */ (function (_super) {\r\n    __extends(NumberInputControl, _super);\r\n    function NumberInputControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { value: '0' };\r\n        _this.update = function (value) {\r\n            var p = getPrecision(_this.props.param.step || 0.01);\r\n            value = parseFloat(value.toFixed(p));\r\n            _this.props.onChange({ param: _this.props.param, name: _this.props.name, value: value });\r\n        };\r\n        return _this;\r\n    }\r\n    NumberInputControl.prototype.render = function () {\r\n        var placeholder = this.props.param.label || camelCaseToWords(this.props.name);\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        var p = getPrecision(this.props.param.step || 0.01);\r\n        return _jsx(ControlRow, { title: this.props.param.description, label: label, control: _jsx(TextInput, { numeric: true, value: parseFloat(this.props.value.toFixed(p)), onEnter: this.props.onEnter, placeholder: placeholder, isDisabled: this.props.isDisabled, onChange: this.update }, void 0) }, void 0);\r\n    };\r\n    return NumberInputControl;\r\n}(React.PureComponent));\r\nexport { NumberInputControl };\r\nvar NumberRangeControl = /** @class */ (function (_super) {\r\n    __extends(NumberRangeControl, _super);\r\n    function NumberRangeControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (v) { _this.update(v); };\r\n        return _this;\r\n    }\r\n    NumberRangeControl.prototype.renderControl = function () {\r\n        var value = typeof this.props.value === 'undefined' ? this.props.param.defaultValue : this.props.value;\r\n        return _jsx(Slider, { value: value, min: this.props.param.min, max: this.props.param.max, step: this.props.param.step, onChange: this.onChange, onChangeImmediate: this.props.param.immediateUpdate ? this.onChange : void 0, disabled: this.props.isDisabled, onEnter: this.props.onEnter }, void 0);\r\n    };\r\n    return NumberRangeControl;\r\n}(SimpleParam));\r\nexport { NumberRangeControl };\r\nvar TextControl = /** @class */ (function (_super) {\r\n    __extends(TextControl, _super);\r\n    function TextControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (e) {\r\n            var value = e.target.value;\r\n            if (value !== _this.props.value) {\r\n                _this.update(value);\r\n            }\r\n        };\r\n        _this.onKeyPress = function (e) {\r\n            if ((e.keyCode === 13 || e.charCode === 13 || e.key === 'Enter')) {\r\n                if (_this.props.onEnter)\r\n                    _this.props.onEnter();\r\n            }\r\n            e.stopPropagation();\r\n        };\r\n        return _this;\r\n    }\r\n    TextControl.prototype.renderControl = function () {\r\n        var placeholder = this.props.param.label || camelCaseToWords(this.props.name);\r\n        return _jsx(\"input\", { type: 'text', value: this.props.value || '', placeholder: placeholder, onChange: this.onChange, onKeyPress: this.props.onEnter ? this.onKeyPress : void 0, disabled: this.props.isDisabled }, void 0);\r\n    };\r\n    return TextControl;\r\n}(SimpleParam));\r\nexport { TextControl };\r\nvar PureSelectControl = /** @class */ (function (_super) {\r\n    __extends(PureSelectControl, _super);\r\n    function PureSelectControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (e) {\r\n            if (typeof _this.props.param.defaultValue === 'number') {\r\n                _this.update(parseInt(e.target.value, 10));\r\n            }\r\n            else {\r\n                _this.update(e.target.value);\r\n            }\r\n        };\r\n        return _this;\r\n    }\r\n    PureSelectControl.prototype.update = function (value) {\r\n        this.props.onChange({ param: this.props.param, name: this.props.name, value: value });\r\n    };\r\n    PureSelectControl.prototype.render = function () {\r\n        var _this = this;\r\n        var isInvalid = this.props.value !== void 0 && !this.props.param.options.some(function (e) { return e[0] === _this.props.value; });\r\n        return _jsxs(\"select\", __assign({ className: 'msp-form-control', title: this.props.title, value: this.props.value !== void 0 ? this.props.value : this.props.param.defaultValue, onChange: this.onChange, disabled: this.props.isDisabled }, { children: [isInvalid && _jsx(\"option\", __assign({ value: this.props.value }, { children: \"[Invalid] \" + this.props.value }), this.props.value), this.props.param.options.map(function (_a) {\r\n                    var value = _a[0], label = _a[1];\r\n                    return _jsx(\"option\", __assign({ value: value }, { children: label }), value);\r\n                })] }), void 0);\r\n    };\r\n    return PureSelectControl;\r\n}(React.PureComponent));\r\nexport { PureSelectControl };\r\nvar SelectControl = /** @class */ (function (_super) {\r\n    __extends(SelectControl, _super);\r\n    function SelectControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { showHelp: false, showOptions: false };\r\n        _this.onSelect = function (item) {\r\n            if (!item || item.value === _this.props.value) {\r\n                _this.setState({ showOptions: false });\r\n            }\r\n            else {\r\n                _this.setState({ showOptions: false }, function () {\r\n                    _this.props.onChange({ param: _this.props.param, name: _this.props.name, value: item.value });\r\n                });\r\n            }\r\n        };\r\n        _this.toggle = function () { return _this.setState({ showOptions: !_this.state.showOptions }); };\r\n        _this.cycle = function () {\r\n            var options = _this.props.param.options;\r\n            var current = options.findIndex(function (o) { return o[0] === _this.props.value; });\r\n            var next = current === options.length - 1 ? 0 : current + 1;\r\n            _this.props.onChange({ param: _this.props.param, name: _this.props.name, value: options[next][0] });\r\n        };\r\n        _this.items = memoizeLatest(function (param) { return ActionMenu.createItemsFromSelectOptions(param.options); });\r\n        _this.toggleHelp = function () { return _this.setState({ showHelp: !_this.state.showHelp }); };\r\n        return _this;\r\n    }\r\n    SelectControl.prototype.renderControl = function () {\r\n        var _a;\r\n        var items = this.items(this.props.param);\r\n        var current = this.props.value !== undefined ? ActionMenu.findItem(items, this.props.value) : void 0;\r\n        var label = current\r\n            ? current.label\r\n            : typeof this.props.value === 'undefined'\r\n                ? (((_a = ActionMenu.getFirstItem(items)) === null || _a === void 0 ? void 0 : _a.label) || '') + \" [Default]\"\r\n                : \"[Invalid] \" + this.props.value;\r\n        var toggle = this.props.param.cycle ? this.cycle : this.toggle;\r\n        var textAlign = this.props.param.cycle ? 'center' : 'left';\r\n        var icon = this.props.param.cycle\r\n            ? (this.props.value === 'on' ? CheckSvg\r\n                : this.props.value === 'off' ? ClearSvg : void 0)\r\n            : void 0;\r\n        return _jsx(ToggleButton, { disabled: this.props.isDisabled, style: { textAlign: textAlign, overflow: 'hidden', textOverflow: 'ellipsis' }, label: label, title: label, icon: icon, toggle: toggle, isSelected: this.state.showOptions }, void 0);\r\n    };\r\n    SelectControl.prototype.renderAddOn = function () {\r\n        if (!this.state.showOptions)\r\n            return null;\r\n        var items = this.items(this.props.param);\r\n        var current = ActionMenu.findItem(items, this.props.value);\r\n        return _jsx(ActionMenu, { items: items, current: current, onSelect: this.onSelect }, void 0);\r\n    };\r\n    SelectControl.prototype.render = function () {\r\n        return renderSimple({\r\n            props: this.props,\r\n            state: this.state,\r\n            control: this.renderControl(),\r\n            toggleHelp: this.toggleHelp,\r\n            addOn: this.renderAddOn()\r\n        });\r\n    };\r\n    return SelectControl;\r\n}(React.PureComponent));\r\nexport { SelectControl };\r\nvar ValueRefControl = /** @class */ (function (_super) {\r\n    __extends(ValueRefControl, _super);\r\n    function ValueRefControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { showHelp: false, showOptions: false };\r\n        _this.onSelect = function (item) {\r\n            if (!item || item.value === _this.props.value) {\r\n                _this.setState({ showOptions: false });\r\n            }\r\n            else {\r\n                _this.setState({ showOptions: false }, function () {\r\n                    _this.props.onChange({ param: _this.props.param, name: _this.props.name, value: { ref: item.value } });\r\n                });\r\n            }\r\n        };\r\n        _this.toggle = function () { return _this.setState({ showOptions: !_this.state.showOptions }); };\r\n        _this.items = memoizeLatest(function (param) { return ActionMenu.createItemsFromSelectOptions(param.getOptions()); });\r\n        _this.toggleHelp = function () { return _this.setState({ showHelp: !_this.state.showHelp }); };\r\n        return _this;\r\n    }\r\n    ValueRefControl.prototype.renderControl = function () {\r\n        var _a;\r\n        var items = this.items(this.props.param);\r\n        var current = this.props.value.ref ? ActionMenu.findItem(items, this.props.value.ref) : void 0;\r\n        var label = current\r\n            ? current.label\r\n            : \"[Ref] \" + ((_a = this.props.value.ref) !== null && _a !== void 0 ? _a : '');\r\n        return _jsx(ToggleButton, { disabled: this.props.isDisabled, style: { textAlign: 'left', overflow: 'hidden', textOverflow: 'ellipsis' }, label: label, title: label, toggle: this.toggle, isSelected: this.state.showOptions }, void 0);\r\n    };\r\n    ValueRefControl.prototype.renderAddOn = function () {\r\n        if (!this.state.showOptions)\r\n            return null;\r\n        var items = this.items(this.props.param);\r\n        var current = ActionMenu.findItem(items, this.props.value.ref);\r\n        return _jsx(ActionMenu, { items: items, current: current, onSelect: this.onSelect }, void 0);\r\n    };\r\n    ValueRefControl.prototype.render = function () {\r\n        return renderSimple({\r\n            props: this.props,\r\n            state: this.state,\r\n            control: this.renderControl(),\r\n            toggleHelp: this.toggleHelp,\r\n            addOn: this.renderAddOn()\r\n        });\r\n    };\r\n    return ValueRefControl;\r\n}(React.PureComponent));\r\nexport { ValueRefControl };\r\nvar IntervalControl = /** @class */ (function (_super) {\r\n    __extends(IntervalControl, _super);\r\n    function IntervalControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isExpanded: false };\r\n        _this.components = {\r\n            0: PD.Numeric(0, { step: _this.props.param.step }, { label: 'Min' }),\r\n            1: PD.Numeric(0, { step: _this.props.param.step }, { label: 'Max' })\r\n        };\r\n        _this.componentChange = function (_a) {\r\n            var name = _a.name, value = _a.value;\r\n            var v = __spreadArray([], _this.props.value, true);\r\n            v[+name] = value;\r\n            _this.change(v);\r\n        };\r\n        _this.toggleExpanded = function (e) {\r\n            _this.setState({ isExpanded: !_this.state.isExpanded });\r\n            e.currentTarget.blur();\r\n        };\r\n        return _this;\r\n    }\r\n    IntervalControl.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: value });\r\n    };\r\n    IntervalControl.prototype.render = function () {\r\n        var v = this.props.value;\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        var p = getPrecision(this.props.param.step || 0.01);\r\n        var value = \"[\" + v[0].toFixed(p) + \", \" + v[1].toFixed(p) + \"]\";\r\n        return _jsxs(_Fragment, { children: [_jsx(ControlRow, { label: label, control: _jsx(\"button\", __assign({ onClick: this.toggleExpanded, disabled: this.props.isDisabled }, { children: value }), void 0) }, void 0), this.state.isExpanded && _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: _jsx(ParameterControls, { params: this.components, values: v, onChange: this.componentChange, onEnter: this.props.onEnter }, void 0) }), void 0)] }, void 0);\r\n    };\r\n    return IntervalControl;\r\n}(React.PureComponent));\r\nexport { IntervalControl };\r\nvar BoundedIntervalControl = /** @class */ (function (_super) {\r\n    __extends(BoundedIntervalControl, _super);\r\n    function BoundedIntervalControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (v) { _this.update(v); };\r\n        return _this;\r\n    }\r\n    BoundedIntervalControl.prototype.renderControl = function () {\r\n        return _jsx(Slider2, { value: this.props.value, min: this.props.param.min, max: this.props.param.max, step: this.props.param.step, onChange: this.onChange, disabled: this.props.isDisabled, onEnter: this.props.onEnter }, void 0);\r\n    };\r\n    return BoundedIntervalControl;\r\n}(SimpleParam));\r\nexport { BoundedIntervalControl };\r\nvar ColorControl = /** @class */ (function (_super) {\r\n    __extends(ColorControl, _super);\r\n    function ColorControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (e) {\r\n            _this.update(Color(parseInt(e.target.value)));\r\n        };\r\n        return _this;\r\n    }\r\n    ColorControl.prototype.stripStyle = function () {\r\n        return {\r\n            background: Color.toStyle(this.props.value),\r\n            position: 'absolute',\r\n            bottom: '0',\r\n            height: '4px',\r\n            right: '0',\r\n            left: '0'\r\n        };\r\n    };\r\n    ColorControl.prototype.renderControl = function () {\r\n        return _jsxs(\"div\", __assign({ style: { position: 'relative' } }, { children: [_jsxs(\"select\", __assign({ value: this.props.value, onChange: this.onChange }, { children: [ColorValueOption(this.props.value), ColorOptions()] }), void 0), _jsx(\"div\", { style: this.stripStyle() }, void 0)] }), void 0);\r\n    };\r\n    return ColorControl;\r\n}(SimpleParam));\r\nexport { ColorControl };\r\nfunction colorEntryToStyle(e, includeOffset) {\r\n    if (includeOffset === void 0) { includeOffset = false; }\r\n    if (Array.isArray(e)) {\r\n        if (includeOffset)\r\n            return Color.toStyle(e[0]) + \" \" + (100 * e[1]).toFixed(2) + \"%\";\r\n        return Color.toStyle(e[0]);\r\n    }\r\n    return Color.toStyle(e);\r\n}\r\nvar colorGradientInterpolated = memoize1(function (colors) {\r\n    var styles = colors.map(function (c) { return colorEntryToStyle(c, true); });\r\n    return \"linear-gradient(to right, \" + styles.join(', ') + \")\";\r\n});\r\nvar colorGradientBanded = memoize1(function (colors) {\r\n    var n = colors.length;\r\n    var styles = [colorEntryToStyle(colors[0]) + \" \" + 100 * (1 / n) + \"%\"];\r\n    // TODO: does this need to support offsets?\r\n    for (var i = 1, il = n - 1; i < il; ++i) {\r\n        styles.push(colorEntryToStyle(colors[i]) + \" \" + 100 * (i / n) + \"%\", colorEntryToStyle(colors[i]) + \" \" + 100 * ((i + 1) / n) + \"%\");\r\n    }\r\n    styles.push(colorEntryToStyle(colors[n - 1]) + \" \" + 100 * ((n - 1) / n) + \"%\");\r\n    return \"linear-gradient(to right, \" + styles.join(', ') + \")\";\r\n});\r\nfunction colorStripStyle(list, right) {\r\n    if (right === void 0) { right = '0'; }\r\n    return {\r\n        background: colorGradient(list.colors, list.kind === 'set'),\r\n        position: 'absolute',\r\n        bottom: '0',\r\n        height: '4px',\r\n        right: right,\r\n        left: '0'\r\n    };\r\n}\r\nfunction colorGradient(colors, banded) {\r\n    return banded ? colorGradientBanded(colors) : colorGradientInterpolated(colors);\r\n}\r\nfunction createColorListHelpers() {\r\n    var addOn = function (l) {\r\n        var preset = getColorListFromName(l[0]);\r\n        return _jsx(\"div\", { style: colorStripStyle({ kind: preset.type !== 'qualitative' ? 'interpolate' : 'set', colors: preset.list }) }, void 0);\r\n    };\r\n    return {\r\n        ColorPresets: {\r\n            all: ActionMenu.createItemsFromSelectOptions(ColorListOptions, { addOn: addOn }),\r\n            scale: ActionMenu.createItemsFromSelectOptions(ColorListOptionsScale, { addOn: addOn }),\r\n            set: ActionMenu.createItemsFromSelectOptions(ColorListOptionsSet, { addOn: addOn })\r\n        },\r\n        ColorsParam: PD.ObjectList({ color: PD.Color(0x0) }, function (_a) {\r\n            var color = _a.color;\r\n            return Color.toHexString(color).toUpperCase();\r\n        }),\r\n        OffsetColorsParam: PD.ObjectList({ color: PD.Color(0x0), offset: PD.Numeric(0, { min: 0, max: 1, step: 0.01 }) }, function (_a) {\r\n            var color = _a.color, offset = _a.offset;\r\n            return Color.toHexString(color).toUpperCase() + \" [\" + offset.toFixed(2) + \"]\";\r\n        }),\r\n        IsInterpolatedParam: PD.Boolean(false, { label: 'Interpolated' })\r\n    };\r\n}\r\nvar _colorListHelpers;\r\nfunction ColorListHelpers() {\r\n    if (_colorListHelpers)\r\n        return _colorListHelpers;\r\n    _colorListHelpers = createColorListHelpers();\r\n    return _colorListHelpers;\r\n}\r\nvar ColorListControl = /** @class */ (function (_super) {\r\n    __extends(ColorListControl, _super);\r\n    function ColorListControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { showHelp: false, show: void 0 };\r\n        _this.toggleEdit = function () { return _this.setState({ show: _this.state.show === 'edit' ? void 0 : 'edit' }); };\r\n        _this.togglePresets = function () { return _this.setState({ show: _this.state.show === 'presets' ? void 0 : 'presets' }); };\r\n        _this.selectPreset = function (item) {\r\n            if (!item)\r\n                return;\r\n            _this.setState({ show: void 0 });\r\n            var preset = getColorListFromName(item.value);\r\n            _this.update({ kind: preset.type !== 'qualitative' ? 'interpolate' : 'set', colors: preset.list });\r\n        };\r\n        _this.colorsChanged = function (_a) {\r\n            var value = _a.value;\r\n            _this.update({\r\n                kind: _this.props.value.kind,\r\n                colors: value.map(function (c) { return c.color; })\r\n            });\r\n        };\r\n        _this.isInterpolatedChanged = function (_a) {\r\n            var value = _a.value;\r\n            _this.update({ kind: value ? 'interpolate' : 'set', colors: _this.props.value.colors });\r\n        };\r\n        _this.toggleHelp = function () { return _this.setState({ showHelp: !_this.state.showHelp }); };\r\n        return _this;\r\n    }\r\n    ColorListControl.prototype.update = function (value) {\r\n        this.props.onChange({ param: this.props.param, name: this.props.name, value: value });\r\n    };\r\n    ColorListControl.prototype.renderControl = function () {\r\n        var value = this.props.value;\r\n        // TODO: fix the button right offset\r\n        return _jsxs(_Fragment, { children: [_jsxs(\"button\", __assign({ onClick: this.toggleEdit, style: { position: 'relative', paddingRight: '33px' } }, { children: [value.colors.length === 1 ? '1 color' : value.colors.length + \" colors\", _jsx(\"div\", { style: colorStripStyle(value, '33px') }, void 0)] }), void 0), _jsx(IconButton, { svg: BookmarksOutlinedSvg, onClick: this.togglePresets, toggleState: this.state.show === 'presets', title: 'Color Presets', style: { padding: 0, position: 'absolute', right: 0, top: 0, width: '32px' } }, void 0)] }, void 0);\r\n    };\r\n    ColorListControl.prototype.renderColors = function () {\r\n        if (!this.state.show)\r\n            return null;\r\n        var _a = ColorListHelpers(), ColorPresets = _a.ColorPresets, ColorsParam = _a.ColorsParam, IsInterpolatedParam = _a.IsInterpolatedParam;\r\n        var preset = ColorPresets[this.props.param.presetKind];\r\n        if (this.state.show === 'presets')\r\n            return _jsx(ActionMenu, { items: preset, onSelect: this.selectPreset }, void 0);\r\n        var values = this.props.value.colors.map(function (color) { return ({ color: color }); });\r\n        return _jsxs(\"div\", __assign({ className: 'msp-control-offset' }, { children: [_jsx(ObjectListControl, { name: 'colors', param: ColorsParam, value: values, onChange: this.colorsChanged, isDisabled: this.props.isDisabled, onEnter: this.props.onEnter }, void 0), _jsx(BoolControl, { name: 'isInterpolated', param: IsInterpolatedParam, value: this.props.value.kind === 'interpolate', onChange: this.isInterpolatedChanged, isDisabled: this.props.isDisabled, onEnter: this.props.onEnter }, void 0)] }), void 0);\r\n    };\r\n    ColorListControl.prototype.render = function () {\r\n        return renderSimple({\r\n            props: this.props,\r\n            state: this.state,\r\n            control: this.renderControl(),\r\n            toggleHelp: this.toggleHelp,\r\n            addOn: this.renderColors()\r\n        });\r\n    };\r\n    return ColorListControl;\r\n}(React.PureComponent));\r\nexport { ColorListControl };\r\nvar OffsetColorListControl = /** @class */ (function (_super) {\r\n    __extends(OffsetColorListControl, _super);\r\n    function OffsetColorListControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { showHelp: false, show: void 0 };\r\n        _this.toggleEdit = function () { return _this.setState({ show: _this.state.show === 'edit' ? void 0 : 'edit' }); };\r\n        _this.togglePresets = function () { return _this.setState({ show: _this.state.show === 'presets' ? void 0 : 'presets' }); };\r\n        _this.selectPreset = function (item) {\r\n            if (!item)\r\n                return;\r\n            _this.setState({ show: void 0 });\r\n            var preset = getColorListFromName(item.value);\r\n            _this.update({ kind: preset.type !== 'qualitative' ? 'interpolate' : 'set', colors: preset.list });\r\n        };\r\n        _this.colorsChanged = function (_a) {\r\n            var value = _a.value;\r\n            var colors = value.map(function (c) { return [c.color, c.offset]; });\r\n            colors.sort(function (a, b) { return a[1] - b[1]; });\r\n            _this.update({ kind: _this.props.value.kind, colors: colors });\r\n        };\r\n        _this.isInterpolatedChanged = function (_a) {\r\n            var value = _a.value;\r\n            _this.update({ kind: value ? 'interpolate' : 'set', colors: _this.props.value.colors });\r\n        };\r\n        _this.toggleHelp = function () { return _this.setState({ showHelp: !_this.state.showHelp }); };\r\n        return _this;\r\n    }\r\n    OffsetColorListControl.prototype.update = function (value) {\r\n        this.props.onChange({ param: this.props.param, name: this.props.name, value: value });\r\n    };\r\n    OffsetColorListControl.prototype.renderControl = function () {\r\n        var value = this.props.value;\r\n        // TODO: fix the button right offset\r\n        return _jsxs(_Fragment, { children: [_jsxs(\"button\", __assign({ onClick: this.toggleEdit, style: { position: 'relative', paddingRight: '33px' } }, { children: [value.colors.length === 1 ? '1 color' : value.colors.length + \" colors\", _jsx(\"div\", { style: colorStripStyle(value, '33px') }, void 0)] }), void 0), _jsx(IconButton, { svg: BookmarksOutlinedSvg, onClick: this.togglePresets, toggleState: this.state.show === 'presets', title: 'Color Presets', style: { padding: 0, position: 'absolute', right: 0, top: 0, width: '32px' } }, void 0)] }, void 0);\r\n    };\r\n    OffsetColorListControl.prototype.renderColors = function () {\r\n        if (!this.state.show)\r\n            return null;\r\n        var _a = ColorListHelpers(), ColorPresets = _a.ColorPresets, OffsetColorsParam = _a.OffsetColorsParam, IsInterpolatedParam = _a.IsInterpolatedParam;\r\n        var preset = ColorPresets[this.props.param.presetKind];\r\n        if (this.state.show === 'presets')\r\n            return _jsx(ActionMenu, { items: preset, onSelect: this.selectPreset }, void 0);\r\n        var colors = this.props.value.colors;\r\n        var values = colors.map(function (color, i) {\r\n            if (Array.isArray(color))\r\n                return { color: color[0], offset: color[1] };\r\n            return { color: color, offset: i / colors.length };\r\n        });\r\n        values.sort(function (a, b) { return a.offset - b.offset; });\r\n        return _jsxs(\"div\", __assign({ className: 'msp-control-offset' }, { children: [_jsx(ObjectListControl, { name: 'colors', param: OffsetColorsParam, value: values, onChange: this.colorsChanged, isDisabled: this.props.isDisabled, onEnter: this.props.onEnter }, void 0), _jsx(BoolControl, { name: 'isInterpolated', param: IsInterpolatedParam, value: this.props.value.kind === 'interpolate', onChange: this.isInterpolatedChanged, isDisabled: this.props.isDisabled, onEnter: this.props.onEnter }, void 0)] }), void 0);\r\n    };\r\n    OffsetColorListControl.prototype.render = function () {\r\n        return renderSimple({\r\n            props: this.props,\r\n            state: this.state,\r\n            control: this.renderControl(),\r\n            toggleHelp: this.toggleHelp,\r\n            addOn: this.renderColors()\r\n        });\r\n    };\r\n    return OffsetColorListControl;\r\n}(React.PureComponent));\r\nexport { OffsetColorListControl };\r\nvar Vec3Control = /** @class */ (function (_super) {\r\n    __extends(Vec3Control, _super);\r\n    function Vec3Control() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isExpanded: false };\r\n        _this.components = {\r\n            0: PD.Numeric(0, { step: _this.props.param.step }, { label: (_this.props.param.fieldLabels && _this.props.param.fieldLabels.x) || 'X' }),\r\n            1: PD.Numeric(0, { step: _this.props.param.step }, { label: (_this.props.param.fieldLabels && _this.props.param.fieldLabels.y) || 'Y' }),\r\n            2: PD.Numeric(0, { step: _this.props.param.step }, { label: (_this.props.param.fieldLabels && _this.props.param.fieldLabels.z) || 'Z' })\r\n        };\r\n        _this.componentChange = function (_a) {\r\n            var name = _a.name, value = _a.value;\r\n            var v = Vec3.copy(Vec3.zero(), _this.props.value);\r\n            v[+name] = value;\r\n            _this.change(v);\r\n        };\r\n        _this.toggleExpanded = function (e) {\r\n            _this.setState({ isExpanded: !_this.state.isExpanded });\r\n            e.currentTarget.blur();\r\n        };\r\n        return _this;\r\n    }\r\n    Vec3Control.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: value });\r\n    };\r\n    Vec3Control.prototype.render = function () {\r\n        var v = this.props.value;\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        var p = getPrecision(this.props.param.step || 0.01);\r\n        var value = \"[\" + v[0].toFixed(p) + \", \" + v[1].toFixed(p) + \", \" + v[2].toFixed(p) + \"]\";\r\n        return _jsxs(_Fragment, { children: [_jsx(ControlRow, { label: label, control: _jsx(\"button\", __assign({ onClick: this.toggleExpanded, disabled: this.props.isDisabled }, { children: value }), void 0) }, void 0), this.state.isExpanded && _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: _jsx(ParameterControls, { params: this.components, values: v, onChange: this.componentChange, onEnter: this.props.onEnter }, void 0) }), void 0)] }, void 0);\r\n    };\r\n    return Vec3Control;\r\n}(React.PureComponent));\r\nexport { Vec3Control };\r\nvar Mat4Control = /** @class */ (function (_super) {\r\n    __extends(Mat4Control, _super);\r\n    function Mat4Control() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isExpanded: false };\r\n        _this.components = {\r\n            json: PD.Text(JSON.stringify(Mat4()), { description: 'JSON array with 4x4 matrix in a column major (j * 4 + i indexing) format' })\r\n        };\r\n        _this.componentChange = function (_a) {\r\n            var name = _a.name, value = _a.value;\r\n            var v = Mat4.copy(Mat4(), _this.props.value);\r\n            if (name === 'json') {\r\n                Mat4.copy(v, JSON.parse(value));\r\n            }\r\n            else {\r\n                v[+name] = value;\r\n            }\r\n            _this.change(v);\r\n        };\r\n        _this.toggleExpanded = function (e) {\r\n            _this.setState({ isExpanded: !_this.state.isExpanded });\r\n            e.currentTarget.blur();\r\n        };\r\n        return _this;\r\n    }\r\n    Mat4Control.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: value });\r\n    };\r\n    Mat4Control.prototype.changeValue = function (idx) {\r\n        var _this = this;\r\n        return function (v) {\r\n            var m = Mat4.copy(Mat4(), _this.props.value);\r\n            m[idx] = v;\r\n            _this.change(m);\r\n        };\r\n    };\r\n    Object.defineProperty(Mat4Control.prototype, \"grid\", {\r\n        get: function () {\r\n            var v = this.props.value;\r\n            var rows = [];\r\n            for (var i = 0; i < 4; i++) {\r\n                var row = [];\r\n                for (var j = 0; j < 4; j++) {\r\n                    row.push(_jsx(TextInput, { numeric: true, delayMs: 50, value: Mat4.getValue(v, i, j), onChange: this.changeValue(4 * j + i), className: 'msp-form-control', blurOnEnter: true, isDisabled: this.props.isDisabled }, j));\r\n                }\r\n                rows.push(_jsx(\"div\", __assign({ className: 'msp-flex-row' }, { children: row }), i));\r\n            }\r\n            return _jsx(\"div\", __assign({ className: 'msp-parameter-matrix' }, { children: rows }), void 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Mat4Control.prototype.render = function () {\r\n        var v = {\r\n            json: JSON.stringify(this.props.value)\r\n        };\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        return _jsxs(_Fragment, { children: [_jsx(ControlRow, { label: label, control: _jsx(\"button\", __assign({ onClick: this.toggleExpanded, disabled: this.props.isDisabled }, { children: '4\\u00D74 Matrix' }), void 0) }, void 0), this.state.isExpanded && _jsxs(\"div\", __assign({ className: 'msp-control-offset' }, { children: [this.grid, _jsx(ParameterControls, { params: this.components, values: v, onChange: this.componentChange, onEnter: this.props.onEnter }, void 0)] }), void 0)] }, void 0);\r\n    };\r\n    return Mat4Control;\r\n}(React.PureComponent));\r\nexport { Mat4Control };\r\nvar UrlControl = /** @class */ (function (_super) {\r\n    __extends(UrlControl, _super);\r\n    function UrlControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (e) {\r\n            var value = e.target.value;\r\n            if (value !== Asset.getUrl(_this.props.value || '')) {\r\n                _this.update(Asset.Url(value));\r\n            }\r\n        };\r\n        _this.onKeyPress = function (e) {\r\n            if ((e.keyCode === 13 || e.charCode === 13 || e.key === 'Enter')) {\r\n                if (_this.props.onEnter)\r\n                    _this.props.onEnter();\r\n            }\r\n            e.stopPropagation();\r\n        };\r\n        return _this;\r\n    }\r\n    UrlControl.prototype.renderControl = function () {\r\n        var placeholder = this.props.param.label || camelCaseToWords(this.props.name);\r\n        return _jsx(\"input\", { type: 'text', value: Asset.getUrl(this.props.value || ''), placeholder: placeholder, onChange: this.onChange, onKeyPress: this.props.onEnter ? this.onKeyPress : void 0, disabled: this.props.isDisabled }, void 0);\r\n    };\r\n    return UrlControl;\r\n}(SimpleParam));\r\nexport { UrlControl };\r\nvar FileControl = /** @class */ (function (_super) {\r\n    __extends(FileControl, _super);\r\n    function FileControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { showHelp: false };\r\n        _this.onChangeFile = function (e) {\r\n            _this.change(e.target.files[0]);\r\n        };\r\n        _this.toggleHelp = function () { return _this.setState({ showHelp: !_this.state.showHelp }); };\r\n        return _this;\r\n    }\r\n    FileControl.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: Asset.File(value) });\r\n    };\r\n    FileControl.prototype.renderControl = function () {\r\n        var value = this.props.value;\r\n        return _jsxs(\"div\", __assign({ className: 'msp-btn msp-btn-block msp-btn-action msp-loader-msp-btn-file', style: { marginTop: '1px' } }, { children: [value ? value.name : 'Select a file...', \" \", _jsx(\"input\", { disabled: this.props.isDisabled, onChange: this.onChangeFile, type: 'file', multiple: false, accept: this.props.param.accept }, void 0)] }), void 0);\r\n    };\r\n    FileControl.prototype.render = function () {\r\n        if (this.props.param.label) {\r\n            return renderSimple({\r\n                props: this.props,\r\n                state: this.state,\r\n                control: this.renderControl(),\r\n                toggleHelp: this.toggleHelp,\r\n                addOn: null\r\n            });\r\n        }\r\n        else {\r\n            return this.renderControl();\r\n        }\r\n    };\r\n    return FileControl;\r\n}(React.PureComponent));\r\nexport { FileControl };\r\nvar FileListControl = /** @class */ (function (_super) {\r\n    __extends(FileListControl, _super);\r\n    function FileListControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { showHelp: false };\r\n        _this.onChangeFileList = function (e) {\r\n            _this.change(e.target.files);\r\n        };\r\n        _this.toggleHelp = function () { return _this.setState({ showHelp: !_this.state.showHelp }); };\r\n        return _this;\r\n    }\r\n    FileListControl.prototype.change = function (value) {\r\n        var files = [];\r\n        if (value) {\r\n            for (var i = 0, il = value.length; i < il; ++i) {\r\n                files.push(Asset.File(value[i]));\r\n            }\r\n        }\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: files });\r\n    };\r\n    FileListControl.prototype.renderControl = function () {\r\n        var value = this.props.value;\r\n        var names = [];\r\n        if (value) {\r\n            for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\r\n                var file = value_1[_i];\r\n                names.push(file.name);\r\n            }\r\n        }\r\n        var label = names.length === 0\r\n            ? 'Select files...' : names.length === 1\r\n            ? names[0] : names.length + \" files selected\";\r\n        return _jsxs(\"div\", __assign({ className: 'msp-btn msp-btn-block msp-btn-action msp-loader-msp-btn-file', style: { marginTop: '1px' } }, { children: [label, \" \", _jsx(\"input\", { disabled: this.props.isDisabled, onChange: this.onChangeFileList, type: 'file', multiple: true, accept: this.props.param.accept }, void 0)] }), void 0);\r\n    };\r\n    FileListControl.prototype.render = function () {\r\n        if (this.props.param.label) {\r\n            return renderSimple({\r\n                props: this.props,\r\n                state: this.state,\r\n                control: this.renderControl(),\r\n                toggleHelp: this.toggleHelp,\r\n                addOn: null\r\n            });\r\n        }\r\n        else {\r\n            return this.renderControl();\r\n        }\r\n    };\r\n    return FileListControl;\r\n}(React.PureComponent));\r\nexport { FileListControl };\r\nvar MultiSelectControl = /** @class */ (function (_super) {\r\n    __extends(MultiSelectControl, _super);\r\n    function MultiSelectControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isExpanded: false };\r\n        _this.toggleExpanded = function (e) {\r\n            _this.setState({ isExpanded: !_this.state.isExpanded });\r\n            e.currentTarget.blur();\r\n        };\r\n        return _this;\r\n    }\r\n    MultiSelectControl.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: value });\r\n    };\r\n    MultiSelectControl.prototype.toggle = function (key) {\r\n        var _this = this;\r\n        return function (e) {\r\n            if (_this.props.value.indexOf(key) < 0)\r\n                _this.change(_this.props.value.concat(key));\r\n            else\r\n                _this.change(_this.props.value.filter(function (v) { return v !== key; }));\r\n            e.currentTarget.blur();\r\n        };\r\n    };\r\n    MultiSelectControl.prototype.render = function () {\r\n        var _this = this;\r\n        var current = this.props.value;\r\n        var emptyLabel = this.props.param.emptyValue;\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        return _jsxs(_Fragment, { children: [_jsx(ControlRow, { label: label, control: _jsx(\"button\", __assign({ onClick: this.toggleExpanded, disabled: this.props.isDisabled }, { children: current.length === 0 && emptyLabel ? emptyLabel : current.length + \" of \" + this.props.param.options.length }), void 0) }, void 0), this.state.isExpanded && _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: this.props.param.options.map(function (_a) {\r\n                        var value = _a[0], label = _a[1];\r\n                        var sel = current.indexOf(value) >= 0;\r\n                        return _jsx(Button, __assign({ onClick: _this.toggle(value), disabled: _this.props.isDisabled, style: { marginTop: '1px' } }, { children: _jsx(\"span\", __assign({ style: { float: sel ? 'left' : 'right' } }, { children: sel ? \"\\u2713 \" + label : label + \" \\u2717\" }), void 0) }), value);\r\n                    }) }), void 0)] }, void 0);\r\n    };\r\n    return MultiSelectControl;\r\n}(React.PureComponent));\r\nexport { MultiSelectControl };\r\nvar GroupControl = /** @class */ (function (_super) {\r\n    __extends(GroupControl, _super);\r\n    function GroupControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isExpanded: !!_this.props.param.isExpanded, showHelp: false };\r\n        _this.onChangeParam = function (e) {\r\n            var _a;\r\n            _this.change(__assign(__assign({}, _this.props.value), (_a = {}, _a[e.name] = e.value, _a)));\r\n        };\r\n        _this.toggleExpanded = function () { return _this.setState({ isExpanded: !_this.state.isExpanded }); };\r\n        return _this;\r\n    }\r\n    GroupControl.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: value });\r\n    };\r\n    GroupControl.prototype.pivoted = function () {\r\n        var key = this.props.param.pivot;\r\n        var params = this.props.param.params;\r\n        var pivot = params[key];\r\n        var Control = controlFor(pivot);\r\n        var ctrl = _jsx(Control, { name: key, param: pivot, value: this.props.value[key], onChange: this.onChangeParam, onEnter: this.props.onEnter, isDisabled: this.props.isDisabled }, void 0);\r\n        if (!this.state.isExpanded) {\r\n            return _jsxs(\"div\", __assign({ className: 'msp-mapped-parameter-group' }, { children: [ctrl, _jsx(IconButton, { svg: MoreHorizSvg, onClick: this.toggleExpanded, toggleState: this.state.isExpanded, title: \"More Options\" }, void 0)] }), void 0);\r\n        }\r\n        var filtered = Object.create(null);\r\n        for (var _i = 0, _a = Object.keys(params); _i < _a.length; _i++) {\r\n            var k = _a[_i];\r\n            if (k !== key)\r\n                filtered[k] = params[k];\r\n        }\r\n        return _jsxs(\"div\", __assign({ className: 'msp-mapped-parameter-group' }, { children: [ctrl, _jsx(IconButton, { svg: MoreHorizSvg, onClick: this.toggleExpanded, toggleState: this.state.isExpanded, title: \"More Options\" }, void 0), _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: _jsx(ParameterControls, { params: filtered, onEnter: this.props.onEnter, values: this.props.value, onChange: this.onChangeParam, isDisabled: this.props.isDisabled }, void 0) }), void 0)] }), void 0);\r\n    };\r\n    GroupControl.prototype.render = function () {\r\n        var params = this.props.param.params;\r\n        // Do not show if there are no params.\r\n        if (Object.keys(params).length === 0)\r\n            return null;\r\n        if (this.props.param.pivot)\r\n            return this.pivoted();\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        var controls = _jsx(ParameterControls, { params: params, onChange: this.onChangeParam, values: this.props.value, onEnter: this.props.onEnter, isDisabled: this.props.isDisabled }, void 0);\r\n        if (this.props.inMapped) {\r\n            return _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: controls }), void 0);\r\n        }\r\n        if (this.props.param.isFlat) {\r\n            return controls;\r\n        }\r\n        return _jsxs(\"div\", __assign({ className: 'msp-control-group-wrapper' }, { children: [_jsx(\"div\", __assign({ className: 'msp-control-group-header' }, { children: _jsxs(\"button\", __assign({ className: 'msp-btn msp-form-control msp-btn-block', onClick: this.toggleExpanded }, { children: [_jsx(Icon, { svg: this.state.isExpanded ? ArrowDropDownSvg : ArrowRightSvg }, void 0), label] }), void 0) }), void 0), this.state.isExpanded && _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: controls }), void 0)] }), void 0);\r\n    };\r\n    return GroupControl;\r\n}(React.PureComponent));\r\nexport { GroupControl };\r\nvar MappedControl = /** @class */ (function (_super) {\r\n    __extends(MappedControl, _super);\r\n    function MappedControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isExpanded: false };\r\n        // TODO: this could lead to a rare bug where the component is reused with different mapped control.\r\n        // I think there are currently no cases where this could happen in the UI, but still need to watch out..\r\n        _this.valuesCache = {};\r\n        _this.onChangeName = function (e) {\r\n            _this.change({ name: e.value, params: _this.getValues(e.value) });\r\n        };\r\n        _this.onChangeParam = function (e) {\r\n            _this.setValues(_this.props.value.name, e.value);\r\n            _this.change({ name: _this.props.value.name, params: e.value });\r\n        };\r\n        _this.toggleExpanded = function () { return _this.setState({ isExpanded: !_this.state.isExpanded }); };\r\n        return _this;\r\n    }\r\n    MappedControl.prototype.setValues = function (name, values) {\r\n        this.valuesCache[name] = values;\r\n    };\r\n    MappedControl.prototype.getValues = function (name) {\r\n        if (name in this.valuesCache) {\r\n            return this.valuesCache[name];\r\n        }\r\n        else {\r\n            return this.props.param.map(name).defaultValue;\r\n        }\r\n    };\r\n    MappedControl.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: value });\r\n    };\r\n    MappedControl.prototype.areParamsEmpty = function (params) {\r\n        for (var _i = 0, _a = Object.keys(params); _i < _a.length; _i++) {\r\n            var k = _a[_i];\r\n            if (!params[k].isHidden)\r\n                return false;\r\n        }\r\n        return true;\r\n    };\r\n    MappedControl.prototype.render = function () {\r\n        var _this = this;\r\n        var value = this.props.value || this.props.param.defaultValue;\r\n        var param = this.props.param.map(value.name);\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        var Mapped = controlFor(param);\r\n        var help = this.props.param.help;\r\n        var select = help\r\n            ? __assign(__assign({}, this.props.param.select), { help: function (name) { return help({ name: name, params: _this.getValues(name) }); } }) : this.props.param.select;\r\n        var Select = _jsx(SelectControl, { param: select, isDisabled: this.props.isDisabled, onChange: this.onChangeName, onEnter: this.props.onEnter, name: label, value: value.name }, void 0);\r\n        if (!Mapped) {\r\n            return Select;\r\n        }\r\n        if (param.type === 'group' && !param.isFlat) {\r\n            if (!this.areParamsEmpty(param.params)) {\r\n                return _jsxs(\"div\", __assign({ className: 'msp-mapped-parameter-group' }, { children: [Select, _jsx(IconButton, { svg: MoreHorizSvg, onClick: this.toggleExpanded, toggleState: this.state.isExpanded, title: label + \" Properties\" }, void 0), this.state.isExpanded && _jsx(GroupControl, { inMapped: true, param: param, value: value.params, name: value.name, onChange: this.onChangeParam, onEnter: this.props.onEnter, isDisabled: this.props.isDisabled }, void 0)] }), void 0);\r\n            }\r\n            return Select;\r\n        }\r\n        return _jsxs(_Fragment, { children: [Select, _jsx(Mapped, { param: param, value: value.params, name: value.name, onChange: this.onChangeParam, onEnter: this.props.onEnter, isDisabled: this.props.isDisabled }, void 0)] }, void 0);\r\n    };\r\n    return MappedControl;\r\n}(React.PureComponent));\r\nexport { MappedControl };\r\nvar ObjectListEditor = /** @class */ (function (_super) {\r\n    __extends(ObjectListEditor, _super);\r\n    function ObjectListEditor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { current: _this.props.value };\r\n        _this.onChangeParam = function (e) {\r\n            var _a;\r\n            _this.setState({ current: __assign(__assign({}, _this.state.current), (_a = {}, _a[e.name] = e.value, _a)) });\r\n        };\r\n        _this.apply = function () {\r\n            _this.props.apply(_this.state.current);\r\n        };\r\n        return _this;\r\n    }\r\n    ObjectListEditor.prototype.componentDidUpdate = function (prevProps) {\r\n        if (this.props.params !== prevProps.params || this.props.value !== prevProps.value) {\r\n            this.setState({ current: this.props.value });\r\n        }\r\n    };\r\n    ObjectListEditor.prototype.render = function () {\r\n        return _jsxs(_Fragment, { children: [_jsx(ParameterControls, { params: this.props.params, onChange: this.onChangeParam, values: this.state.current, onEnter: this.apply, isDisabled: this.props.isDisabled }, void 0), _jsx(\"button\", __assign({ className: \"msp-btn msp-btn-block msp-form-control msp-control-top-offset\", onClick: this.apply, disabled: this.props.isDisabled }, { children: this.props.isUpdate ? 'Update' : 'Add' }), void 0)] }, void 0);\r\n    };\r\n    return ObjectListEditor;\r\n}(React.PureComponent));\r\nvar ObjectListItem = /** @class */ (function (_super) {\r\n    __extends(ObjectListItem, _super);\r\n    function ObjectListItem() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isExpanded: false };\r\n        _this.update = function (v) {\r\n            // this.setState({ isExpanded: false }); // TODO auto update? mark changed state?\r\n            _this.props.actions.update(v, _this.props.index);\r\n        };\r\n        _this.moveUp = function () {\r\n            _this.props.actions.move(_this.props.index, -1);\r\n        };\r\n        _this.moveDown = function () {\r\n            _this.props.actions.move(_this.props.index, 1);\r\n        };\r\n        _this.remove = function () {\r\n            _this.setState({ isExpanded: false });\r\n            _this.props.actions.remove(_this.props.index);\r\n        };\r\n        _this.toggleExpanded = function (e) {\r\n            _this.setState({ isExpanded: !_this.state.isExpanded });\r\n            e.currentTarget.blur();\r\n        };\r\n        return _this;\r\n    }\r\n    ObjectListItem.prototype.render = function () {\r\n        return _jsxs(_Fragment, { children: [_jsxs(\"div\", __assign({ className: 'msp-param-object-list-item' }, { children: [_jsxs(\"button\", __assign({ className: 'msp-btn msp-btn-block msp-form-control', onClick: this.toggleExpanded }, { children: [_jsx(\"span\", { children: this.props.index + 1 + \": \" }, void 0), this.props.param.getLabel(this.props.value)] }), void 0), _jsxs(\"div\", { children: [_jsx(IconButton, { svg: ArrowDownwardSvg, title: 'Move Up', onClick: this.moveUp, small: true }, void 0), _jsx(IconButton, { svg: ArrowUpwardSvg, title: 'Move Down', onClick: this.moveDown, small: true }, void 0), _jsx(IconButton, { svg: DeleteOutlinedSvg, title: 'Remove', onClick: this.remove, small: true }, void 0)] }, void 0)] }), void 0), this.state.isExpanded && _jsx(\"div\", __assign({ className: 'msp-control-offset' }, { children: _jsx(ObjectListEditor, { params: this.props.param.element, apply: this.update, value: this.props.value, isUpdate: true, isDisabled: this.props.isDisabled }, void 0) }), void 0)] }, void 0);\r\n    };\r\n    return ObjectListItem;\r\n}(React.PureComponent));\r\nvar ObjectListControl = /** @class */ (function (_super) {\r\n    __extends(ObjectListControl, _super);\r\n    function ObjectListControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = { isExpanded: false };\r\n        _this.add = function (v) {\r\n            _this.change(__spreadArray(__spreadArray([], _this.props.value, true), [v], false));\r\n        };\r\n        _this.actions = {\r\n            update: function (v, i) {\r\n                var value = _this.props.value.slice(0);\r\n                value[i] = v;\r\n                _this.change(value);\r\n            },\r\n            move: function (i, dir) {\r\n                var xs = _this.props.value;\r\n                if (xs.length === 1)\r\n                    return;\r\n                var j = (i + dir) % xs.length;\r\n                if (j < 0)\r\n                    j += xs.length;\r\n                xs = xs.slice(0);\r\n                var t = xs[i];\r\n                xs[i] = xs[j];\r\n                xs[j] = t;\r\n                _this.change(xs);\r\n            },\r\n            remove: function (i) {\r\n                var xs = _this.props.value;\r\n                var update = [];\r\n                for (var j = 0; j < xs.length; j++) {\r\n                    if (i !== j)\r\n                        update.push(xs[j]);\r\n                }\r\n                _this.change(update);\r\n            }\r\n        };\r\n        _this.toggleExpanded = function (e) {\r\n            _this.setState({ isExpanded: !_this.state.isExpanded });\r\n            e.currentTarget.blur();\r\n        };\r\n        return _this;\r\n    }\r\n    ObjectListControl.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: value });\r\n    };\r\n    ObjectListControl.prototype.render = function () {\r\n        var _this = this;\r\n        var v = this.props.value;\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        var value = v.length + \" item\" + (v.length !== 1 ? 's' : '');\r\n        return _jsxs(_Fragment, { children: [_jsx(ControlRow, { label: label, control: _jsx(\"button\", __assign({ onClick: this.toggleExpanded, disabled: this.props.isDisabled }, { children: value }), void 0) }, void 0), this.state.isExpanded && _jsxs(\"div\", __assign({ className: 'msp-control-offset' }, { children: [this.props.value.map(function (v, i) { return _jsx(ObjectListItem, { param: _this.props.param, value: v, index: i, actions: _this.actions, isDisabled: _this.props.isDisabled }, i); }), _jsx(ControlGroup, __assign({ header: 'New Item' }, { children: _jsx(ObjectListEditor, { params: this.props.param.element, apply: this.add, value: this.props.param.ctor(), isDisabled: this.props.isDisabled }, void 0) }), void 0)] }), void 0)] }, void 0);\r\n    };\r\n    return ObjectListControl;\r\n}(React.PureComponent));\r\nexport { ObjectListControl };\r\nvar ConditionedControl = /** @class */ (function (_super) {\r\n    __extends(ConditionedControl, _super);\r\n    function ConditionedControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChangeCondition = function (e) {\r\n            _this.change(_this.props.param.conditionedValue(_this.props.value, e.value));\r\n        };\r\n        _this.onChangeParam = function (e) {\r\n            _this.change(e.value);\r\n        };\r\n        return _this;\r\n    }\r\n    ConditionedControl.prototype.change = function (value) {\r\n        this.props.onChange({ name: this.props.name, param: this.props.param, value: value });\r\n    };\r\n    ConditionedControl.prototype.render = function () {\r\n        var value = this.props.value;\r\n        var condition = this.props.param.conditionForValue(value);\r\n        var param = this.props.param.conditionParams[condition];\r\n        var label = this.props.param.label || camelCaseToWords(this.props.name);\r\n        var Conditioned = controlFor(param);\r\n        var select = _jsx(SelectControl, { param: this.props.param.select, isDisabled: this.props.isDisabled, onChange: this.onChangeCondition, onEnter: this.props.onEnter, name: label + \" Kind\", value: condition }, void 0);\r\n        if (!Conditioned) {\r\n            return select;\r\n        }\r\n        return _jsxs(_Fragment, { children: [select, _jsx(Conditioned, { param: param, value: value, name: label, onChange: this.onChangeParam, onEnter: this.props.onEnter, isDisabled: this.props.isDisabled }, void 0)] }, void 0);\r\n    };\r\n    return ConditionedControl;\r\n}(React.PureComponent));\r\nexport { ConditionedControl };\r\nvar ConvertedControl = /** @class */ (function (_super) {\r\n    __extends(ConvertedControl, _super);\r\n    function ConvertedControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (e) {\r\n            _this.props.onChange({\r\n                name: _this.props.name,\r\n                param: _this.props.param,\r\n                value: _this.props.param.toValue(e.value)\r\n            });\r\n        };\r\n        return _this;\r\n    }\r\n    ConvertedControl.prototype.render = function () {\r\n        var value = this.props.param.fromValue(this.props.value);\r\n        var Converted = controlFor(this.props.param.converted);\r\n        if (!Converted)\r\n            return null;\r\n        return _jsx(Converted, { param: this.props.param.converted, value: value, name: this.props.name, onChange: this.onChange, onEnter: this.props.onEnter, isDisabled: this.props.isDisabled }, void 0);\r\n    };\r\n    return ConvertedControl;\r\n}(React.PureComponent));\r\nexport { ConvertedControl };\r\nvar ScriptControl = /** @class */ (function (_super) {\r\n    __extends(ScriptControl, _super);\r\n    function ScriptControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChange = function (e) {\r\n            var value = e.target.value;\r\n            if (value !== _this.props.value.expression) {\r\n                _this.update({ language: _this.props.value.language, expression: value });\r\n            }\r\n        };\r\n        _this.onKeyPress = function (e) {\r\n            if ((e.keyCode === 13 || e.charCode === 13 || e.key === 'Enter')) {\r\n                if (_this.props.onEnter)\r\n                    _this.props.onEnter();\r\n            }\r\n            e.stopPropagation();\r\n        };\r\n        return _this;\r\n    }\r\n    ScriptControl.prototype.renderControl = function () {\r\n        // TODO: improve!\r\n        var placeholder = this.props.param.label || camelCaseToWords(this.props.name);\r\n        return _jsx(\"input\", { type: 'text', value: this.props.value.expression || '', placeholder: placeholder, onChange: this.onChange, onKeyPress: this.props.onEnter ? this.onKeyPress : void 0, disabled: this.props.isDisabled }, void 0);\r\n    };\r\n    return ScriptControl;\r\n}(SimpleParam));\r\nexport { ScriptControl };\r\n//# sourceMappingURL=parameters.js.map"]},"metadata":{},"sourceType":"module"}