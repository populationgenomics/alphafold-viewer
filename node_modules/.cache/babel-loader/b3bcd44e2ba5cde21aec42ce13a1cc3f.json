{"ast":null,"code":"/**\r\n * Copyright (c) 2018 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\nimport { __extends } from \"tslib\";\nimport { PluginCommands } from '../../mol-plugin/commands';\nimport { memoizeLatest } from '../../mol-util/memoize';\nimport { StateTransformParameters, TransformControlBase } from './common';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nexport { ApplyActionControl };\n\nvar ApplyActionControl =\n/** @class */\nfunction (_super) {\n  __extends(ApplyActionControl, _super);\n\n  function ApplyActionControl() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._getInfo = memoizeLatest(function (t, v) {\n      return StateTransformParameters.infoFromAction(_this.plugin, _this.props.state, _this.props.action, _this.props.nodeRef);\n    });\n    _this.state = {\n      plugin: _this.plugin,\n      ref: _this.props.nodeRef,\n      version: _this.props.state.transforms.get(_this.props.nodeRef).version,\n      error: void 0,\n      isInitial: true,\n      params: _this.getInfo().initialValues,\n      busy: false,\n      isCollapsed: _this.props.initiallyCollapsed\n    };\n    return _this;\n  }\n\n  ApplyActionControl.prototype.applyAction = function () {\n    return PluginCommands.State.ApplyAction(this.plugin, {\n      state: this.props.state,\n      action: this.props.action.create(this.state.params),\n      ref: this.props.nodeRef\n    });\n  };\n\n  ApplyActionControl.prototype.getInfo = function () {\n    return this._getInfo(this.props.nodeRef, this.props.state.transforms.get(this.props.nodeRef).version);\n  };\n\n  ApplyActionControl.prototype.getTransformerId = function () {\n    return this.props.state.transforms.get(this.props.nodeRef).transformer.id;\n  };\n\n  ApplyActionControl.prototype.getHeader = function () {\n    return this.props.hideHeader ? 'none' : this.props.action.definition.display;\n  };\n\n  ApplyActionControl.prototype.canApply = function () {\n    return !this.state.error && !this.state.busy;\n  };\n\n  ApplyActionControl.prototype.canAutoApply = function () {\n    return false;\n  };\n\n  ApplyActionControl.prototype.applyText = function () {\n    return 'Apply';\n  };\n\n  ApplyActionControl.prototype.isUpdate = function () {\n    return false;\n  };\n\n  ApplyActionControl.prototype.getSourceAndTarget = function () {\n    return {\n      a: this.props.state.cells.get(this.props.nodeRef).obj\n    };\n  };\n\n  ApplyActionControl.getDerivedStateFromProps = function (props, state) {\n    var version = props.state.transforms.get(props.nodeRef).version;\n\n    if (props.nodeRef === state.ref && version === state.version) {\n      return null;\n    }\n\n    var source = props.state.cells.get(props.nodeRef).obj;\n    var params = props.action.definition.params ? PD.getDefaultValues(props.action.definition.params(source, state.plugin)) : {};\n    var newState = {\n      plugin: state.plugin,\n      ref: props.nodeRef,\n      version: version,\n      params: params,\n      isInitial: true,\n      error: void 0\n    };\n    return newState;\n  };\n\n  return ApplyActionControl;\n}(TransformControlBase);","map":{"version":3,"sources":["../../../src/mol-plugin-ui/state/apply-action.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2018 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author David Sehnal <david.sehnal@gmail.com>\r\n */\r\nimport { __extends } from \"tslib\";\r\nimport { PluginCommands } from '../../mol-plugin/commands';\r\nimport { memoizeLatest } from '../../mol-util/memoize';\r\nimport { StateTransformParameters, TransformControlBase } from './common';\r\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\r\nexport { ApplyActionControl };\r\nvar ApplyActionControl = /** @class */ (function (_super) {\r\n    __extends(ApplyActionControl, _super);\r\n    function ApplyActionControl() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._getInfo = memoizeLatest(function (t, v) { return StateTransformParameters.infoFromAction(_this.plugin, _this.props.state, _this.props.action, _this.props.nodeRef); });\r\n        _this.state = { plugin: _this.plugin, ref: _this.props.nodeRef, version: _this.props.state.transforms.get(_this.props.nodeRef).version, error: void 0, isInitial: true, params: _this.getInfo().initialValues, busy: false, isCollapsed: _this.props.initiallyCollapsed };\r\n        return _this;\r\n    }\r\n    ApplyActionControl.prototype.applyAction = function () {\r\n        return PluginCommands.State.ApplyAction(this.plugin, {\r\n            state: this.props.state,\r\n            action: this.props.action.create(this.state.params),\r\n            ref: this.props.nodeRef\r\n        });\r\n    };\r\n    ApplyActionControl.prototype.getInfo = function () { return this._getInfo(this.props.nodeRef, this.props.state.transforms.get(this.props.nodeRef).version); };\r\n    ApplyActionControl.prototype.getTransformerId = function () { return this.props.state.transforms.get(this.props.nodeRef).transformer.id; };\r\n    ApplyActionControl.prototype.getHeader = function () { return this.props.hideHeader ? 'none' : this.props.action.definition.display; };\r\n    ApplyActionControl.prototype.canApply = function () { return !this.state.error && !this.state.busy; };\r\n    ApplyActionControl.prototype.canAutoApply = function () { return false; };\r\n    ApplyActionControl.prototype.applyText = function () { return 'Apply'; };\r\n    ApplyActionControl.prototype.isUpdate = function () { return false; };\r\n    ApplyActionControl.prototype.getSourceAndTarget = function () { return { a: this.props.state.cells.get(this.props.nodeRef).obj }; };\r\n    ApplyActionControl.getDerivedStateFromProps = function (props, state) {\r\n        var version = props.state.transforms.get(props.nodeRef).version;\r\n        if (props.nodeRef === state.ref && version === state.version) {\r\n            return null;\r\n        }\r\n        var source = props.state.cells.get(props.nodeRef).obj;\r\n        var params = props.action.definition.params\r\n            ? PD.getDefaultValues(props.action.definition.params(source, state.plugin))\r\n            : {};\r\n        var newState = {\r\n            plugin: state.plugin,\r\n            ref: props.nodeRef,\r\n            version: version,\r\n            params: params,\r\n            isInitial: true,\r\n            error: void 0\r\n        };\r\n        return newState;\r\n    };\r\n    return ApplyActionControl;\r\n}(TransformControlBase));\r\n//# sourceMappingURL=apply-action.js.map"]},"metadata":{},"sourceType":"module"}