{"ast":null,"code":"/**\r\n * Copyright (c) 2018-2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\nfunction openUrl(url) {\n  var opened = window.open(url, '_blank');\n\n  if (!opened) {\n    window.location.href = url;\n  }\n}\n\nfunction click(node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'));\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents');\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null);\n    node.dispatchEvent(evt);\n  }\n}\n\nexport function download(data, downloadName) {\n  // using ideas from https://github.com/eligrey/FileSaver.js/blob/master/FileSaver.js\n  if (downloadName === void 0) {\n    downloadName = 'download';\n  }\n\n  if (!data) return;\n\n  if ('download' in HTMLAnchorElement.prototype) {\n    var a_1 = document.createElement('a');\n    a_1.download = downloadName;\n    a_1.rel = 'noopener';\n\n    if (typeof data === 'string') {\n      a_1.href = data;\n      click(a_1);\n    } else {\n      a_1.href = URL.createObjectURL(data);\n      setTimeout(function () {\n        return URL.revokeObjectURL(a_1.href);\n      }, 4E4); // 40s\n\n      setTimeout(function () {\n        return click(a_1);\n      });\n    }\n  } else if (typeof navigator !== 'undefined' && navigator.msSaveOrOpenBlob) {\n    // native saveAs in IE 10+\n    navigator.msSaveOrOpenBlob(data, downloadName);\n  } else {\n    var ua = window.navigator.userAgent;\n    var isSafari = /Safari/i.test(ua);\n    var isChromeIos_1 = /CriOS\\/[\\d]+/.test(ua);\n\n    var open_1 = function (str) {\n      openUrl(isChromeIos_1 ? str : str.replace(/^data:[^;]*;/, 'data:attachment/file;'));\n    };\n\n    if ((isSafari || isChromeIos_1) && FileReader) {\n      if (data instanceof Blob) {\n        // no downloading of blob urls in Safari\n        var reader_1 = new FileReader();\n\n        reader_1.onloadend = function () {\n          return open_1(reader_1.result);\n        };\n\n        reader_1.readAsDataURL(data);\n      } else {\n        open_1(data);\n      }\n    } else {\n      var url_1 = URL.createObjectURL(data);\n      location.href = url_1;\n      setTimeout(function () {\n        return URL.revokeObjectURL(url_1);\n      }, 4E4); // 40s\n    }\n  }\n}","map":{"version":3,"sources":["../../src/mol-util/download.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\r\n * Copyright (c) 2018-2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\r\n *\r\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\r\n */\r\nfunction openUrl(url) {\r\n    var opened = window.open(url, '_blank');\r\n    if (!opened) {\r\n        window.location.href = url;\r\n    }\r\n}\r\nfunction click(node) {\r\n    try {\r\n        node.dispatchEvent(new MouseEvent('click'));\r\n    }\r\n    catch (e) {\r\n        var evt = document.createEvent('MouseEvents');\r\n        evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null);\r\n        node.dispatchEvent(evt);\r\n    }\r\n}\r\nexport function download(data, downloadName) {\r\n    // using ideas from https://github.com/eligrey/FileSaver.js/blob/master/FileSaver.js\r\n    if (downloadName === void 0) { downloadName = 'download'; }\r\n    if (!data)\r\n        return;\r\n    if ('download' in HTMLAnchorElement.prototype) {\r\n        var a_1 = document.createElement('a');\r\n        a_1.download = downloadName;\r\n        a_1.rel = 'noopener';\r\n        if (typeof data === 'string') {\r\n            a_1.href = data;\r\n            click(a_1);\r\n        }\r\n        else {\r\n            a_1.href = URL.createObjectURL(data);\r\n            setTimeout(function () { return URL.revokeObjectURL(a_1.href); }, 4E4); // 40s\r\n            setTimeout(function () { return click(a_1); });\r\n        }\r\n    }\r\n    else if (typeof navigator !== 'undefined' && navigator.msSaveOrOpenBlob) {\r\n        // native saveAs in IE 10+\r\n        navigator.msSaveOrOpenBlob(data, downloadName);\r\n    }\r\n    else {\r\n        var ua = window.navigator.userAgent;\r\n        var isSafari = /Safari/i.test(ua);\r\n        var isChromeIos_1 = /CriOS\\/[\\d]+/.test(ua);\r\n        var open_1 = function (str) {\r\n            openUrl(isChromeIos_1 ? str : str.replace(/^data:[^;]*;/, 'data:attachment/file;'));\r\n        };\r\n        if ((isSafari || isChromeIos_1) && FileReader) {\r\n            if (data instanceof Blob) {\r\n                // no downloading of blob urls in Safari\r\n                var reader_1 = new FileReader();\r\n                reader_1.onloadend = function () { return open_1(reader_1.result); };\r\n                reader_1.readAsDataURL(data);\r\n            }\r\n            else {\r\n                open_1(data);\r\n            }\r\n        }\r\n        else {\r\n            var url_1 = URL.createObjectURL(data);\r\n            location.href = url_1;\r\n            setTimeout(function () { return URL.revokeObjectURL(url_1); }, 4E4); // 40s\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=download.js.map"]},"metadata":{},"sourceType":"module"}